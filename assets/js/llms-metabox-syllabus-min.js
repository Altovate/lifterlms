jQuery(document).ready(function($){var e={".chosen-select":{},".chosen-select-deselect":{allow_single_deselect:!0},".chosen-select-no-single":{disable_search_threshold:10},".chosen-select-no-results":{no_results_text:"Oops, nothing found!"},".chosen-select-width":{width:"95%"}};for(var t in e)$(t).chosen(e[t]);$("select").each(function(){reverse_selection(this)}),$(".section-select").click(function(){reverse_selection(this)}),$(".section-select").change(function(){catch_duplicates(this)}),$(".lesson-select").change(function(){catch_blanks()}),$("#addNewSection").click(function(e){return add_new_section(),!1}),$(".addNewLesson").click(function(e){return add_new_lesson(e),!1}),$(".deleteBtn").click(function(){return delete_this(this),!1}),$(".section-dismiss").click(function(){return delete_this(this),!1}),lessons_sortable(),load_ajax_animation()}),reverse_selection=function(e){jQuery(e).data("last_selected",jQuery(e).val())},catch_blanks=function(){jQuery(".section-select").each(function(){null==jQuery(this).val()||""==jQuery(this).val()?alert("Unable to save. Please make sure all of your sections are assigned."):update_syllabus()})},catch_duplicates=function(e){var t=jQuery(this),s=[],a=jQuery(e).val(),n=jQuery(e).data("last_selected");jQuery(".section-select").each(function(){return a==jQuery(this).val()&&s.push(jQuery(this).val()),s.length>1?(alert("So sorry. Unfortunately you selected a section that already exists in this course. That is FORBIDDEN!!!mwahahahahah!"),jQuery(e).val(n).attr("selected",!0),!1):void update_syllabus()})},lessons_sortable=function(){jQuery(".dad-list").sortable({items:".list_item",axis:"y",start:function(e,t){var s=t.item.index();t.item.data("start_pos",s)},update:function(e,t){var s=t.item.data("start_pos"),a=jQuery(t.item).index();jQuery(t.item).attr("data-order",a),update_syllabus()}})},get_sections=function(){var e=[],t=0;return jQuery("#syllabus .section-select").each(function(){t++;var s={},a=jQuery(this).val();s.section_id=jQuery(this).val(),s.position=t;var n=jQuery(this).parent().parent().attr("id");jQuery("#"+n).find("a").attr("data-section_id",a),jQuery("#"+n).find("tr").attr("data-section_id",a),s.lessons=parse_lessons(a),e.push(s)}),e},parse_lessons=function(e){var e=e,t=[];return jQuery(".course-section tbody select").each(function(){var s=jQuery(this).parent().parent().parent().parent().parent().attr("id"),a=jQuery("#"+s+" .list_item").length+1,n={};n.lesson_id=jQuery(this).val();var o=jQuery(this).parent().parent().attr("data-order");o=o.substr(o.lastIndexOf("_")+1),n.position=o,jQuery(this).parent().parent().attr("data-section_id")==e&&t.push(n)}),t},update_syllabus=function(){var e=get_sections(),t={action:"update_syllabus",post_id:jQuery("#syllabus").data("post_id"),sections:e},s=new Ajax("post",t,!1);s.update_syllabus()},get_lessons=function(e,t){var s=new Ajax("post",{action:"get_lessons"},!0);s.get_lessons(e,t)},add_new_lesson=function(e){console.log("add new lesson called"),console.log(e.target);var t=jQuery(e.target).attr("data-section_id");if(console.log(e.target.id),console.log("section_id of button clicked: "+t),void 0===typeof jQuery(e.target).attr("data-section"))var s=1;else var s=jQuery(e.target).attr("data-section");console.log("section_position of button clicked: "+s),get_lessons(t,s)},lesson_template=function(e,t,s){console.log(e),console.log(t),console.log(s),console.log("made it to template fucntion");var a=jQuery("#"+s+" .list_item").length+1,n="list_item_"+a,o="row_"+a,i=jQuery("#"+s+" .dad-list").length;jQuery('<tr class="list_item" id="'+o+'" data-section_id="'+t+'" data-order="'+a+'"> 			<td><select id="'+n+'" data-placeholder="Choose a Section" class="chosen-select lesson-select" 			></select></td><td><i data-code="f153" class="dashicons dashicons-dismiss deleteBtn"></i></td></tr>').appendTo("#"+s+" .dad-list tbody").hide().fadeIn(300),jQuery(c).change(function(){update_syllabus($(c).val())}),jQuery("#"+s+" .dad-list tbody .lesson-select").change(function(){update_syllabus()}),jQuery(".deleteBtn").click(function(){var e=jQuery(this).attr("class");jQuery(this).parent().parent().remove()});for(var l in e)if(e.hasOwnProperty(l)){var c=jQuery("#"+s+" #"+n),r='<option value="'+e[l].ID+'">'+e[l].post_title+"</option>";jQuery(c).append(r)}jQuery(c).prepend('<option value="" selected disabled>Please select a lesson...</option>')},delete_this=function(e){jQuery(e).parent().parent().remove(),jQuery(".course-section").each(function(e){jQuery(this).attr("id",e+1),jQuery(this).find("label").text("Section "+(e+1)+":"),jQuery(this).find("a.add-lesson").attr("data-section",e+1)}),update_syllabus()},function($){add_new_section=function(){var e=new Ajax("post",{action:"get_sections"},!1);e.get_sections()},section_template=function(e){var t=e;console.log(t);var s=$(".course-section").length+1,a="section_"+s,n=document.createElement("div");n.setAttribute("class","course-section"),n.setAttribute("id",s);var o=document.createElement("p");o.setAttribute("class","title");var i=document.createElement("label");i.setAttribute("class","order"),$(i).text("Section "+s+":");var l=document.createElement("select");l.setAttribute("class","chosen-select chosen select section-select"),l.setAttribute("data-placeholder","Select a Section"),$(l).click(function(){reverse_selection($(l))}),$(l).change(function(){catch_duplicates($(l))}),$(l).attr("selectedIndex",-1);var c=document.createElement("i");c.setAttribute("data-code","f153"),c.setAttribute("class","dashicons dashicons-dismiss section-dismiss"),$(c).click(function(){delete_this($(l))});var r=document.createElement("a");r.setAttribute("class","button button-primary add-lesson"),$("#"+a).data("section",{ID:s}),$(r).attr("data-section",s),$(r).text("Add Lesson"),$(r).on("click",function(e){add_new_lesson(e)});var d='<table class="wp-list-table widefat fixed posts dad-list"> 		<thead><tr><th>Name</th><th></th></tr></thead> 		<tfoot><tr><th>Name</th><th></th></tr> 		</tfoot><tbody></tbody></table>';$(l).append('<option value="" selected disabled>Please select a section...</option>');for(var u in t)if(t.hasOwnProperty(u)){var h=$("<option />").val(t[u].ID).text(t[u].post_title);$(l).append(h)}o.appendChild(i),o.appendChild(l),o.appendChild(c),n.appendChild(o),$(n).append(d),$(n).append(r),$("#syllabus").hide().append(n).fadeIn(1e3),$(l).trigger("chosen:updated"),lessons_sortable()}}(jQuery);