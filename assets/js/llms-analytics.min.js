!function(t){window.llms=window.llms||{},window.llms.analytics=function(){return this.charts_ready=!1,this.data=t.parseJSON(t("#llms-analytics-json").text()),this.timeout=5e3,this.$widgets=t(".llms-widget"),this.init=function(){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(this.charts_ready),this.bind(),this.load_widgets()},this.bind=function(){t(".llms-datepicker").datepicker({dateFormat:"yy-mm-dd",maxDate:0}),t("#llms-students-ids-filter").llmsStudentsSelect2({multiple:!0,placeholder:LLMS.l10n.translate("Filter by Student(s)"),width:"90%"})},this.charts_ready=function(){console.log("ready")},this.load_widgets=function(){var e=this;this.$widgets.each(function(){e.load_widget(t(this))})},this.load_widget=function(e){var s,a=this,i=e.attr("data-method"),l=e.find("h1"),n=e.find(".llms-reload-widget"),d=LLMS.l10n.translate("Error");e.addClass("is-loading"),t.ajax({data:{action:"llms_widget_"+i,dates:a.data.dates,courses:a.data.courses,memberships:a.data.memberships,students:a.data.students},method:"POST",timeout:a.timeout,url:window.ajaxurl,success:function(t){s="success","undefined"!=typeof t.response&&(d=t.response)},error:function(t){s="error"},complete:function(i){console.log(i),"error"===s&&(d="timeout"===i.statusText?LLMS.l10n.translate("Request timed out"):LLMS.l10n.translate("Error"),n.length||(n=t('<a class="llms-reload-widget" href="#">'+LLMS.l10n.translate("Retry")+"</a>"),n.on("click",function(t){t.preventDefault(),a.load_widget(e)}),e.append(n))),e.removeClass("is-loading"),l.text(d)}})},this.init(),this},new window.llms.analytics}(jQuery);