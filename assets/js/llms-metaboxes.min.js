!function(t){t.fn.llmsCollapsible=function(){return this.on("click",".llms-collapsible-header",function(){var e=t(this).closest(".llms-collapsible"),l=e.siblings(".llms-collapsible");e.toggleClass("opened"),e.find(".llms-collapsible-body").slideToggle(400),l.each(function(){t(this).removeClass("opened"),t(this).find(".llms-collapsible-body").slideUp(400)})}),this},window.llms=window.llms||{};var e=function(){this.init=function(){var e=this;if(t(".llms-select2").llmsSelect2({width:"100%"}),t(".llms-select2-post").each(function(){e.post_select(t(this))}),t(".llms-collapsible-group").llmsCollapsible(),t(".llms-datepicker").length&&this.bind_datepickers(),t('input[type="checkbox"][data-controls]').length&&this.bind_cb_controllers(),t("[data-is-controller]").length&&this.bind_controllers(),t(".llms-table").length&&this.bind_tables(),window.llms.post.post_type){var l="bind_"+window.llms.post.post_type;"function"==typeof this[l]&&this[l]()}},this.bind_cb_controllers=function(){t('input[type="checkbox"][data-controls]').each(function(){var e=t(this),l=t(e.attr("data-controls")).closest(".llms-mb-list");e.on("change",function(){t(this).is(":checked")?l.slideDown(200):l.slideUp(200)}),e.trigger("change")})},this.bind_controllers=function(){t("[data-is-controller]").each(function(){var e,l=t(this),a=t('[data-controller="#'+l.attr("id")+'"]');l.on("change",function(){e="checkbox"===l.attr("type")?l.is(":checked")?l.val():"false":l.val(),a.each(function(){var l=t(this).attr("data-controller-value"),a=[];-1!==l.indexOf(",")?a=l.split(","):a.push(l),-1!==a.indexOf(e)?t(this).slideDown(200):t(this).slideUp(200)})}),l.trigger("change")})},this.bind_datepickers=function(){t(".llms-datepicker").datepicker({dateFormat:"mm/dd/yy"})},this.bind_llms_order=function(){t('button[name="llms-refund-toggle"]').on("click",function(){var e=t(this),l=e.closest("tr"),a=l.attr("data-transaction-id"),n=e.attr("data-refundable"),s="1"===e.attr("data-gateway-supports"),i=e.attr("data-gateway"),o=t("#llms-txn-refund-model .llms-txn-refund-form").clone(),c=o.find(".gateway-btn");"remove"!==e.attr("data-action")?(e.text(LLMS.l10n.translate("Cancel")),e.attr("data-action","remove"),o.find("input").removeAttr("disabled"),o.find('input[name="llms_refund_amount"]').attr("max",n),o.find('input[name="llms_refund_txn_id"]').val(a),s&&(c.find(".llms-gateway-title").text(i),c.show()),l.after(o)):(e.text(LLMS.l10n.translate("Refund")),e.attr("data-action",""),l.next("tr").remove())})},this.post_select=function(e){var l=e.attr("data-post-type")||post;e.llmsSelect2({allowClear:!1,ajax:{dataType:"JSON",delay:250,method:"POST",url:window.ajaxurl,data:function(t){return{action:"select2_query_posts",page:t.page?t.page-1:0,post_type:l,term:t.term,_ajax_nonce:wp_ajax_data.nonce}},processResults:function(e,l){return{results:t.map(e.items,function(t){return{text:t.name,id:t.id}}),pagination:{more:e.more}}}},cache:!0,width:"100%"})},this.bind_tables=function(){t('.llms-table button[name="llms-expand-table"]').on("click",function(){var e=t(this),l=e.closest(".llms-table");if(e.attr("data-text")){var a=e.text();e.text(e.attr("data-text")),e.attr("data-text",a)}l.find(".expandable").each(function(){t(this).hasClass("closed")?t(this).addClass("opened").removeClass("closed"):t(this).addClass("closed").removeClass("opened")})})},this.init()};window.llms.metaboxes=new e}(jQuery);