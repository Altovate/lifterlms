!function(i){window.llms=window.llms||{},window.llms.checkout=new function(){var m=[],s=[];return this.$checkout_form=i("#llms-product-purchase-form"),this.$confirm_form=i("#llms-product-purchase-confirm-form"),this.$form_sections=!1,this.form_action=!1,this.init=function(){var e=this;i(".llms-checkout-wrapper").length&&this.bind_login(),this.$checkout_form.length?(this.form_action="checkout",this.$form_sections=this.$checkout_form.find(".llms-checkout-section"),this.$checkout_form.on("submit",this,this.submit),i(".llms-password-strength-meter").length&&this.add_before_submit_event({data:LLMS.PasswordStrength,handler:LLMS.PasswordStrength.checkout}),this.bind_coupon(),this.bind_gateways()):this.$confirm_form.length&&(this.form_action="confirm",this.$form_sections=this.$confirm_form.find(".llms-checkout-section"),this.$confirm_form.on("submit",function(){e.processing("start")}))},this.add_before_submit_event=function(e){e.handler&&"function"==typeof e.handler&&(e.data||(e.data=null),m.push(e))},this.add_error=function(e,t){var s="llms-checkout-errors";$err=i("#"+s),$err.length||($err=i('<ul class="llms-notice llms-error" id="'+s+'" />'),i(".llms-checkout-wrapper").prepend($err)),$err.append("<li>"+e+"</li>"),t&&console.error(t)},this.add_gateway=function(e){s.push(e)},this.bind_coupon=function(){var t=this;i('a[href="#llms-coupon-toggle"]').on("click",function(e){e.preventDefault(),i(".llms-coupon-entry").slideToggle(400)}),i("#llms-apply-coupon").on("click",function(e){e.preventDefault(),t.coupon_apply(i(this))}),i("#llms-remove-coupon").on("click",function(e){e.preventDefault(),t.coupon_remove(i(this))})},this.bind_gateways=function(){this.load_gateways(),i('input[name="llms_payment_gateway"]').length||i("#llms_create_pending_order").removeAttr("disabled"),i('input[name="llms_payment_gateway"]').on("change",function(){i('input[name="llms_payment_gateway"]').each(function(){var e=i(this),t=e.closest(".llms-payment-gateway"),s=t.find(".llms-gateway-fields").find("input, textarea, select"),o=e.is(":checked");t[o?"addClass":"removeClass"]("is-selected"),o?(s.removeAttr("disabled"),i(".llms-payment-gateways").trigger("llms-gateway-selected",{id:e.val(),$selector:t})):s.attr("disabled","disabled")})}),i(".llms-payment-gateways").on("llms-gateway-selected",function(e,t){var s=i("#llms_create_pending_order");t.$selector&&t.$selector.find(".llms-gateway-fields .invalid").length?s.attr("disabled","disabled"):s.removeAttr("disabled")})},this.bind_login=function(){i('a[href="#llms-show-login"]').on("click",function(e){e.preventDefault(),i(this).closest(".llms-info,.llms-notice").slideUp(400),i("form.llms-login").slideDown(400)})},this.clear_errors=function(){i("#llms-checkout-errors").remove()},this.coupon_apply=function(e){var s=this,t=i("#llms_coupon_code").val(),o=i(".llms-coupon-messages"),n=o.find(".llms-error"),l=i("form.llms-checkout");LLMS.Spinner.start(l),window.LLMS.Ajax.call({data:{action:"validate_coupon_code",code:t,plan_id:i("#llms-plan-id").val()},beforeSend:function(){n.hide()},success:function(e){if(LLMS.Spinner.stop(l),"error"===e.code){var t=i("<li>"+e.message+"</li>");n.length?n.empty():(n=i('<ul class="llms-notice llms-error" />'),o.append(n)),t.appendTo(n),n.show()}else e.success&&(i(".llms-coupon-wrapper").replaceWith(e.data.coupon_html),s.bind_coupon(),i(".llms-payment-gateways").replaceWith(e.data.gateways_html),s.bind_gateways(),i(".llms-order-summary").replaceWith(e.data.summary_html))}})},this.coupon_remove=function(e){var t=this,s=i("form.llms-checkout");LLMS.Spinner.start(s),window.LLMS.Ajax.call({data:{action:"remove_coupon_code",plan_id:i("#llms-plan-id").val()},success:function(e){LLMS.Spinner.stop(s),e.success&&(i(".llms-coupon-wrapper").replaceWith(e.data.coupon_html),t.bind_coupon(),i(".llms-order-summary").replaceWith(e.data.summary_html),i(".llms-payment-gateways").replaceWith(e.data.gateways_html),t.bind_gateways())}})},this.focus_errors=function(){i("html, body").animate({scrollTop:i("#llms-checkout-errors").offset().top-50},200)},this.load_gateways=function(){for(var e=0;e<=s.length;e++){var t=s[e];"object"==typeof t&&null!==t&&void 0!==t.bind&&"function"==typeof t.bind&&t.bind()}},this.processing=function(e){var t,s;switch(e){case"stop":t="removeClass";break;case"start":default:t="addClass"}"checkout"===this.form_action?s=this.$checkout_form:"confirm"===this.form_action&&(s=this.$confirm_form),s[t]("llms-is-processing"),LLMS.Spinner[e](this.$form_sections)},this.submit=function(e){var o,n=e.data,l=m.length,i=0,r=[],a=0,c=0;e.preventDefault(),n.processing("start"),n.clear_errors();for(var t=0;t<m.length;t++){var s=m[t];s.handler(s.data,function(e){a++,!0===e?c++:"string"==typeof e&&r.push(e)})}o=setInterval(function(){var e=!1,t=!1;if(6e4<=i)t=e=!0;else if(l===a)if(l===c)e=!0,n.$checkout_form.off("submit",n.submit),n.$checkout_form.trigger("submit");else if(r.length){t=e=!0;for(var s=0;s<r.length;s++)n.add_error(r[s]);n.focus_errors()}e&&clearInterval(o),t&&n.processing("stop"),i++},100)},this.init(),this}}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtZm9ybS1jaGVja291dC5qcyJdLCJuYW1lcyI6WyIkIiwid2luZG93IiwibGxtcyIsImNoZWNrb3V0IiwiYmVmb3JlX3N1Ym1pdCIsImdhdGV3YXlzIiwidGhpcyIsIiRjaGVja291dF9mb3JtIiwiJGNvbmZpcm1fZm9ybSIsIiRmb3JtX3NlY3Rpb25zIiwiZm9ybV9hY3Rpb24iLCJpbml0Iiwic2VsZiIsImxlbmd0aCIsImJpbmRfbG9naW4iLCJmaW5kIiwib24iLCJzdWJtaXQiLCJhZGRfYmVmb3JlX3N1Ym1pdF9ldmVudCIsImRhdGEiLCJMTE1TIiwiUGFzc3dvcmRTdHJlbmd0aCIsImhhbmRsZXIiLCJiaW5kX2NvdXBvbiIsImJpbmRfZ2F0ZXdheXMiLCJwcm9jZXNzaW5nIiwib2JqIiwicHVzaCIsImFkZF9lcnJvciIsIm1lc3NhZ2UiLCJpZCIsIiRlcnIiLCJwcmVwZW5kIiwiYXBwZW5kIiwiY29uc29sZSIsImVycm9yIiwiYWRkX2dhdGV3YXkiLCJnYXRld2F5X2NsYXNzIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2xpZGVUb2dnbGUiLCJjb3Vwb25fYXBwbHkiLCJjb3Vwb25fcmVtb3ZlIiwibG9hZF9nYXRld2F5cyIsInJlbW92ZUF0dHIiLCJlYWNoIiwiJGVsIiwiJHBhcmVudCIsImNsb3Nlc3QiLCIkZmllbGRzIiwiY2hlY2tlZCIsImlzIiwidHJpZ2dlciIsInZhbCIsIiRzZWxlY3RvciIsImF0dHIiLCIkc3VibWl0Iiwic2xpZGVVcCIsInNsaWRlRG93biIsImNsZWFyX2Vycm9ycyIsInJlbW92ZSIsIiRidG4iLCJjb2RlIiwiJG1lc3NhZ2VzIiwiJGVycm9ycyIsIiRjb250YWluZXIiLCJTcGlubmVyIiwic3RhcnQiLCJBamF4IiwiY2FsbCIsImFjdGlvbiIsInBsYW5faWQiLCJiZWZvcmVTZW5kIiwiaGlkZSIsInN1Y2Nlc3MiLCJyIiwic3RvcCIsIiRtZXNzYWdlIiwiZW1wdHkiLCJhcHBlbmRUbyIsInNob3ciLCJyZXBsYWNlV2l0aCIsImNvdXBvbl9odG1sIiwiZ2F0ZXdheXNfaHRtbCIsInN1bW1hcnlfaHRtbCIsImZvY3VzX2Vycm9ycyIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJ0b3AiLCJpIiwiZyIsInVuZGVmaW5lZCIsImJpbmQiLCJmdW5jIiwiJGZvcm0iLCJpbnRlcnZhbCIsIm51bSIsImNoZWNrcyIsImVycm9ycyIsImZpbmlzaGVzIiwic3VjY2Vzc2VzIiwic2V0SW50ZXJ2YWwiLCJjbGVhciIsIm9mZiIsImNsZWFySW50ZXJ2YWwiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQU1DLFNBQVlBLEdBd2lCWkMsT0FBT0MsS0FBT0QsT0FBT0MsTUFBUSxHQUM3QkQsT0FBT0MsS0FBS0MsU0FBVyxJQXZpQkgsV0FRbkIsSUFBSUMsRUFBZ0IsR0FRaEJDLEVBQVcsR0FraEJmLE9BaGhCQUMsS0FBS0MsZUFBaUJQLEVBQUcsK0JBQ3pCTSxLQUFLRSxjQUFnQlIsRUFBRyx1Q0FDeEJNLEtBQUtHLGdCQUFpQixFQUN0QkgsS0FBS0ksYUFBYyxFQVduQkosS0FBS0ssS0FBTyxXQUVYLElBQUlDLEVBQU9OLEtBRU5OLEVBQUcsMEJBQTJCYSxRQUNsQ1AsS0FBS1EsYUFHRFIsS0FBS0MsZUFBZU0sUUFFeEJQLEtBQUtJLFlBQWMsV0FDbkJKLEtBQUtHLGVBQWlCSCxLQUFLQyxlQUFlUSxLQUFNLDBCQUVoRFQsS0FBS0MsZUFBZVMsR0FBSSxTQUFVVixLQUFNQSxLQUFLVyxRQUd4Q2pCLEVBQUcsaUNBQWtDYSxRQUN6Q1AsS0FBS1ksd0JBQXlCLENBQzdCQyxLQUFNQyxLQUFLQyxpQkFDWEMsUUFBU0YsS0FBS0MsaUJBQWlCbEIsV0FJakNHLEtBQUtpQixjQUVMakIsS0FBS2tCLGlCQUVNbEIsS0FBS0UsY0FBY0ssU0FFOUJQLEtBQUtJLFlBQWMsVUFDbkJKLEtBQUtHLGVBQWlCSCxLQUFLRSxjQUFjTyxLQUFNLDBCQUUvQ1QsS0FBS0UsY0FBY1EsR0FBSSxTQUFVLFdBQ2hDSixFQUFLYSxXQUFZLGFBZ0JwQm5CLEtBQUtZLHdCQUEwQixTQUFVUSxHQUVsQ0EsRUFBSUosU0FBVyxtQkFBc0JJLEVBQUlKLFVBSXpDSSxFQUFJUCxPQUNUTyxFQUFJUCxLQUFPLE1BR1pmLEVBQWN1QixLQUFNRCxLQVlyQnBCLEtBQUtzQixVQUFZLFNBQVVDLEVBQVNWLEdBRW5DLElBQUlXLEVBQUssdUJBQ1JDLEtBQU8vQixFQUFHLElBQU04QixHQUVWQyxLQUFLbEIsU0FDWGtCLEtBQU8vQixFQUFHLDBDQUE0QzhCLEVBQUssUUFDM0Q5QixFQUFHLDBCQUEyQmdDLFFBQVNELE9BR3hDQSxLQUFLRSxPQUFRLE9BQVNKLEVBQVUsU0FFM0JWLEdBQ0plLFFBQVFDLE1BQU9oQixJQVlqQmIsS0FBSzhCLFlBQWMsU0FBVUMsR0FFNUJoQyxFQUFTc0IsS0FBTVUsSUFVaEIvQixLQUFLaUIsWUFBYyxXQUVsQixJQUFJWCxFQUFPTixLQUdYTixFQUFHLGlDQUFrQ2dCLEdBQUksUUFBUyxTQUFVc0IsR0FFM0RBLEVBQUVDLGlCQUNGdkMsRUFBRyxzQkFBdUJ3QyxZQUFhLE9BS3hDeEMsRUFBRyxzQkFBdUJnQixHQUFJLFFBQVMsU0FBVXNCLEdBRWhEQSxFQUFFQyxpQkFDRjNCLEVBQUs2QixhQUFjekMsRUFBR00sU0FLdkJOLEVBQUcsdUJBQXdCZ0IsR0FBSSxRQUFTLFNBQVVzQixHQUVqREEsRUFBRUMsaUJBQ0YzQixFQUFLOEIsY0FBZTFDLEVBQUdNLFVBWXpCQSxLQUFLa0IsY0FBZ0IsV0FFcEJsQixLQUFLcUMsZ0JBRUUzQyxFQUFHLHNDQUFzQ2EsUUFDL0NiLEVBQUcsOEJBQStCNEMsV0FBWSxZQUkvQzVDLEVBQUcsc0NBQXVDZ0IsR0FBSSxTQUFVLFdBRXREaEIsRUFBRyxzQ0FBdUM2QyxLQUFNLFdBRWhELElBQUlDLEVBQU05QyxFQUFHTSxNQUNaeUMsRUFBVUQsRUFBSUUsUUFBUyx5QkFDdkJDLEVBQVVGLEVBQVFoQyxLQUFNLHdCQUF5QkEsS0FBTSwyQkFDdkRtQyxFQUFVSixFQUFJSyxHQUFJLFlBR25CSixFQUZnQixFQUFjLFdBQWEsZUFFbEIsZUFFcEJHLEdBR0pELEVBQVFMLFdBQVksWUFHcEI1QyxFQUFHLDBCQUEyQm9ELFFBQVMsd0JBQXlCLENBQy9EdEIsR0FBSWdCLEVBQUlPLE1BQ1JDLFVBQVdQLEtBTVpFLEVBQVFNLEtBQU0sV0FBWSxnQkFTN0J2RCxFQUFHLDBCQUEyQmdCLEdBQUksd0JBQXlCLFNBQVVzQixFQUFHbkIsR0FFdkUsSUFBSXFDLEVBQVV4RCxFQUFHLDhCQUVabUIsRUFBS21DLFdBQWFuQyxFQUFLbUMsVUFBVXZDLEtBQU0saUNBQWtDRixPQUM3RTJDLEVBQVFELEtBQU0sV0FBWSxZQUUxQkMsRUFBUVosV0FBWSxlQWV2QnRDLEtBQUtRLFdBQWEsV0FFakJkLEVBQUcsOEJBQStCZ0IsR0FBSSxRQUFTLFNBQVVzQixHQUV4REEsRUFBRUMsaUJBQ0Z2QyxFQUFHTSxNQUFPMEMsUUFBUywyQkFBNEJTLFFBQVMsS0FDeER6RCxFQUFHLG1CQUFvQjBELFVBQVcsUUFXcENwRCxLQUFLcUQsYUFBZSxXQUNuQjNELEVBQUcseUJBQTBCNEQsVUFhOUJ0RCxLQUFLbUMsYUFBZSxTQUFXb0IsR0FFOUIsSUFBSWpELEVBQU9OLEtBRVZ3RCxFQURROUQsRUFBRyxxQkFDRXFELE1BQ2JVLEVBQVkvRCxFQUFHLHlCQUNmZ0UsRUFBVUQsRUFBVWhELEtBQU0sZUFDMUJrRCxFQUFhakUsRUFBRyxzQkFFakJvQixLQUFLOEMsUUFBUUMsTUFBT0YsR0FFcEJoRSxPQUFPbUIsS0FBS2dELEtBQUtDLEtBQU0sQ0FDdEJsRCxLQUFNLENBQ0xtRCxPQUFRLHVCQUNSUixLQUFNQSxFQUNOUyxRQUFTdkUsRUFBRyxpQkFBa0JxRCxPQUUvQm1CLFdBQVksV0FFWFIsRUFBUVMsUUFHVEMsUUFBUyxTQUFVQyxHQUlsQixHQUZBdkQsS0FBSzhDLFFBQVFVLEtBQU1YLEdBRWQsVUFBWVUsRUFBRWIsS0FBTyxDQUV6QixJQUFJZSxFQUFXN0UsRUFBRyxPQUFTMkUsRUFBRTlDLFFBQVUsU0FFaENtQyxFQUFRbkQsT0FPZG1ELEVBQVFjLFNBTFJkLEVBQVVoRSxFQUFHLHlDQUNiK0QsRUFBVTlCLE9BQVErQixJQVFuQmEsRUFBU0UsU0FBVWYsR0FDbkJBLEVBQVFnQixZQUVHTCxFQUFFRCxVQUViMUUsRUFBRyx3QkFBeUJpRixZQUFhTixFQUFFeEQsS0FBSytELGFBQ2hEdEUsRUFBS1csY0FFTHZCLEVBQUcsMEJBQTJCaUYsWUFBYU4sRUFBRXhELEtBQUtnRSxlQUNsRHZFLEVBQUtZLGdCQUVMeEIsRUFBRyx1QkFBd0JpRixZQUFhTixFQUFFeEQsS0FBS2lFLG1CQWtCbkQ5RSxLQUFLb0MsY0FBZ0IsU0FBVW1CLEdBRTlCLElBQUlqRCxFQUFPTixLQUNWMkQsRUFBYWpFLEVBQUcsc0JBRWpCb0IsS0FBSzhDLFFBQVFDLE1BQU9GLEdBRXBCaEUsT0FBT21CLEtBQUtnRCxLQUFLQyxLQUFNLENBQ3RCbEQsS0FBTSxDQUNMbUQsT0FBUSxxQkFDUkMsUUFBU3ZFLEVBQUcsaUJBQWtCcUQsT0FFL0JxQixRQUFTLFNBQVVDLEdBRWxCdkQsS0FBSzhDLFFBQVFVLEtBQU1YLEdBRWRVLEVBQUVELFVBRU4xRSxFQUFHLHdCQUF5QmlGLFlBQWFOLEVBQUV4RCxLQUFLK0QsYUFDaER0RSxFQUFLVyxjQUVMdkIsRUFBRyx1QkFBd0JpRixZQUFhTixFQUFFeEQsS0FBS2lFLGNBRS9DcEYsRUFBRywwQkFBMkJpRixZQUFhTixFQUFFeEQsS0FBS2dFLGVBQ2xEdkUsRUFBS1kscUJBZ0JUbEIsS0FBSytFLGFBQWUsV0FDbkJyRixFQUFHLGNBQWVzRixRQUFTLENBQzFCQyxVQUFXdkYsRUFBRyx5QkFBMEJ3RixTQUFTQyxJQUFNLElBQ3JELE1BU0puRixLQUFLcUMsY0FBZ0IsV0FFcEIsSUFBTSxJQUFJK0MsRUFBSSxFQUFHQSxHQUFLckYsRUFBU1EsT0FBUTZFLElBQU0sQ0FDNUMsSUFBSUMsRUFBSXRGLEVBQVNxRixHQUNDLGlCQUFOQyxHQUF3QixPQUFOQSxRQUNiQyxJQUFYRCxFQUFFRSxNQUFzQixtQkFBc0JGLEVBQUVFLE1BQ3BERixFQUFFRSxTQWFOdkYsS0FBS21CLFdBQWEsU0FBVTZDLEdBRTNCLElBQUl3QixFQUFNQyxFQUVWLE9BQVN6QixHQUVSLElBQUssT0FDSndCLEVBQU8sY0FDUixNQUVBLElBQUssUUFDTCxRQUNDQSxFQUFPLFdBS0osYUFBZXhGLEtBQUtJLFlBQ3hCcUYsRUFBUXpGLEtBQUtDLGVBQ0YsWUFBY0QsS0FBS0ksY0FDOUJxRixFQUFRekYsS0FBS0UsZUFHZHVGLEVBQU9ELEdBQVEsc0JBQ2YxRSxLQUFLOEMsUUFBU0ksR0FBVWhFLEtBQUtHLGlCQWM5QkgsS0FBS1csT0FBUyxTQUFVcUIsR0FFdkIsSUFPQzBELEVBUEdwRixFQUFPMEIsRUFBRW5CLEtBQ1o4RSxFQUFNN0YsRUFBY1MsT0FDcEJxRixFQUFTLEVBRVRDLEVBQVMsR0FDVEMsRUFBVyxFQUNYQyxFQUFZLEVBR2IvRCxFQUFFQyxpQkFHRjNCLEVBQUthLFdBQVksU0FHakJiLEVBQUsrQyxlQUdMLElBQU0sSUFBSStCLEVBQUksRUFBR0EsRUFBSXRGLEVBQWNTLE9BQVE2RSxJQUFNLENBRWhELElBQUloRSxFQUFNdEIsRUFBZXNGLEdBRXpCaEUsRUFBSUosUUFBU0ksRUFBSVAsS0FBTSxTQUFVd0QsR0FFaEN5QixLQUNLLElBQVN6QixFQUNiMEIsSUFDVyxpQkFBb0IxQixHQUMvQndCLEVBQU94RSxLQUFNZ0QsS0FRaEJxQixFQUFXTSxZQUFhLFdBRXZCLElBQUlDLEdBQVEsRUFDWDNCLEdBQU8sRUFHUixHQXZDYSxLQXVDUnNCLEVBR0p0QixFQURBMkIsR0FBUSxPQUtKLEdBQUtOLElBQVFHLEVBR2pCLEdBQUtILElBQVFJLEVBRVpFLEdBQVEsRUFFUjNGLEVBQUtMLGVBQWVpRyxJQUFLLFNBQVU1RixFQUFLSyxRQUN4Q0wsRUFBS0wsZUFBZTZDLFFBQVMsZUFFdkIsR0FBSytDLEVBQU90RixPQUFTLENBRzNCK0QsRUFEQTJCLEdBQVEsRUFHUixJQUFNLElBQUliLEVBQUksRUFBR0EsRUFBSVMsRUFBT3RGLE9BQVE2RSxJQUNuQzlFLEVBQUtnQixVQUFXdUUsRUFBUVQsSUFHekI5RSxFQUFLeUUsZUFNRmtCLEdBQ0pFLGNBQWVULEdBR1hwQixHQUNKaEUsRUFBS2EsV0FBWSxRQUlsQnlFLEtBRUUsTUFLSjVGLEtBQUtLLE9BRUVMLE1BcGlCUixDQTJpQklvRyIsImZpbGUiOiJsbG1zLWZvcm0tY2hlY2tvdXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWZ0ZXJMTVMgQ2hlY2tvdXQgU2NyZWVuIHJlbGF0ZWQgZXZlbnRzIGFuZCBpbnRlcmFjdGlvbnNcbiAqXG4gKiBAc2luY2UgICAzLjAuMFxuICogQHZlcnNpb24gMy4zNC41XG4gKi9cbjsoIGZ1bmN0aW9uKCAkICkge1xuXG5cdHZhciBsbG1zX2NoZWNrb3V0ID0gZnVuY3Rpb24oKSB7XG5cblx0XHQvKipcblx0XHQgKiBBcnJheSBvZiB2YWxpZGF0aW9uIGZ1bmN0aW9ucyB0byBjYWxsIG9uIGZvcm0gc3VibWlzc2lvblxuXHRcdCAqIEB0eXBlICAgIGFycmF5XG5cdFx0ICogQHNpbmNlICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAzLjAuMFxuXHRcdCAqL1xuXHRcdHZhciBiZWZvcmVfc3VibWl0ID0gW107XG5cblx0XHQvKipcblx0XHQgKiBBcnJheSBvZiBnYXRld2F5cyB0byBiZSBhdXRvbWF0aWNhbGx5IGJvdW5kIHdoZW4gbmVlZGVkXG5cdFx0ICogQHR5cGUgICAgYXJyYXlcblx0XHQgKiBAc2luY2UgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMC4wXG5cdFx0ICovXG5cdFx0dmFyIGdhdGV3YXlzID0gW107XG5cblx0XHR0aGlzLiRjaGVja291dF9mb3JtID0gJCggJyNsbG1zLXByb2R1Y3QtcHVyY2hhc2UtZm9ybScgKTtcblx0XHR0aGlzLiRjb25maXJtX2Zvcm0gPSAkKCAnI2xsbXMtcHJvZHVjdC1wdXJjaGFzZS1jb25maXJtLWZvcm0nICk7XG5cdFx0dGhpcy4kZm9ybV9zZWN0aW9ucyA9IGZhbHNlO1xuXHRcdHRoaXMuZm9ybV9hY3Rpb24gPSBmYWxzZTtcblxuXHRcdC8qKlxuXHRcdCAqIEluaXRpYWxpemUgY2hlY2tvdXQgSlMgJiBiaW5kIGlmIG9uIHRoZSBjaGVja291dCBzY3JlZW5cblx0XHQgKlxuXHRcdCAqIEBzaW5jZSAzLjAuMFxuXHRcdCAqIEBzaW5jZSAzLjM0LjUgTWFrZSBzdXJlIHdlIGJpbmQgY2xpY2sgZXZlbnRzIGZvciB0aGUgU2hvdyAvIEhpZGUgbG9naW4gYXJlYSBhdCB0aGUgdG9wIG9mIHRoZSBjaGVja291dCBzY3JlZW5cblx0XHQgKiAgICAgICAgICAgICAgICAgIGV2ZW4gaWYgdGhlcmUncyBubyBsbG1zIHByb2R1Y3QgcHVyY2hhc2UgZm9ybS5cblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqL1xuXHRcdHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdGlmICggJCggJy5sbG1zLWNoZWNrb3V0LXdyYXBwZXInICkubGVuZ3RoICkge1xuXHRcdFx0XHR0aGlzLmJpbmRfbG9naW4oKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCB0aGlzLiRjaGVja291dF9mb3JtLmxlbmd0aCApIHtcblxuXHRcdFx0XHR0aGlzLmZvcm1fYWN0aW9uID0gJ2NoZWNrb3V0Jztcblx0XHRcdFx0dGhpcy4kZm9ybV9zZWN0aW9ucyA9IHRoaXMuJGNoZWNrb3V0X2Zvcm0uZmluZCggJy5sbG1zLWNoZWNrb3V0LXNlY3Rpb24nICk7XG5cblx0XHRcdFx0dGhpcy4kY2hlY2tvdXRfZm9ybS5vbiggJ3N1Ym1pdCcsIHRoaXMsIHRoaXMuc3VibWl0ICk7XG5cblx0XHRcdFx0Ly8gYWRkIGJlZm9yZSBzdWJtaXQgZXZlbnQgZm9yIHBhc3N3b3JkIHN0cmVuZ3RoIG1ldGVyIGlmIG9uZSdzIGZvdW5kXG5cdFx0XHRcdGlmICggJCggJy5sbG1zLXBhc3N3b3JkLXN0cmVuZ3RoLW1ldGVyJyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHR0aGlzLmFkZF9iZWZvcmVfc3VibWl0X2V2ZW50KCB7XG5cdFx0XHRcdFx0XHRkYXRhOiBMTE1TLlBhc3N3b3JkU3RyZW5ndGgsXG5cdFx0XHRcdFx0XHRoYW5kbGVyOiBMTE1TLlBhc3N3b3JkU3RyZW5ndGguY2hlY2tvdXQsXG5cdFx0XHRcdFx0fSApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5iaW5kX2NvdXBvbigpO1xuXG5cdFx0XHRcdHRoaXMuYmluZF9nYXRld2F5cygpO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLiRjb25maXJtX2Zvcm0ubGVuZ3RoICkge1xuXG5cdFx0XHRcdHRoaXMuZm9ybV9hY3Rpb24gPSAnY29uZmlybSc7XG5cdFx0XHRcdHRoaXMuJGZvcm1fc2VjdGlvbnMgPSB0aGlzLiRjb25maXJtX2Zvcm0uZmluZCggJy5sbG1zLWNoZWNrb3V0LXNlY3Rpb24nICk7XG5cblx0XHRcdFx0dGhpcy4kY29uZmlybV9mb3JtLm9uKCAnc3VibWl0JywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0c2VsZi5wcm9jZXNzaW5nKCAnc3RhcnQnICk7XG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFB1YmxpYyBmdW5jdGlvbiB3aGljaCBhbGxvd3Mgb3RoZXIgY2xhc3NlcyBvciBleHRlbnNpb25zIHRvIGFkZFxuXHRcdCAqIGJlZm9yZSBzdWJtaXQgZXZlbnRzIHRvIGxsbXMgY2hlY2tvdXQgcHJpdmF0ZSBcImJlZm9yZV9zdWJtaXRcIiBhcnJheVxuXHRcdCAqIEBwYXJhbSAgICBvYmplY3QgIG9iaiAgb2JqZWN0IG9mIGRhdGEgdG8gcHVzaCB0byB0aGUgYXJyYXlcblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzIGF0IGxlYXN0IGEgXCJoYW5kbGVyXCIga2V5IHdoaWNoIHNob3VsZCBwYXNzIGEgY2FsbGFibGUgZnVuY3Rpb25cblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVwiIGNhbiBiZSBhbnl0aGluZywgd2lsbCBiZSBwYXNzZWQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlciB0byB0aGUgaGFuZGxlciBmdW5jdGlvblxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYWRkX2JlZm9yZV9zdWJtaXRfZXZlbnQgPSBmdW5jdGlvbiggb2JqICkge1xuXG5cdFx0XHRpZiAoICFvYmouaGFuZGxlciB8fCAnZnVuY3Rpb24nICE9PSB0eXBlb2Ygb2JqLmhhbmRsZXIgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhb2JqLmRhdGEgKSB7XG5cdFx0XHRcdG9iai5kYXRhID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0YmVmb3JlX3N1Ym1pdC5wdXNoKCBvYmogKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBBZGQgYW4gZXJyb3IgbWVzc2FnZVxuXHRcdCAqIEBwYXJhbSAgICBzdHJpbmcgICAgIG1lc3NhZ2UgIGVycm9yIG1lc3NhZ2Ugc3RyaW5nXG5cdFx0ICogQHBhcmFtICAgIG1peGVkICAgICAgZGF0YSAgICAgb3B0aW9uYWwgZXJyb3IgZGF0YSB0byBvdXRwdXQgb24gdGhlIGNvbnNvbGVcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjI3LjBcblx0XHQgKiBAdmVyc2lvbiAgMy4yNy4wXG5cdFx0ICovXG5cdFx0dGhpcy5hZGRfZXJyb3IgPSBmdW5jdGlvbiggbWVzc2FnZSwgZGF0YSApIHtcblxuXHRcdFx0dmFyIGlkID0gJ2xsbXMtY2hlY2tvdXQtZXJyb3JzJztcblx0XHRcdFx0JGVyciA9ICQoICcjJyArIGlkICk7XG5cblx0XHRcdGlmICggISAkZXJyLmxlbmd0aCApIHtcblx0XHRcdFx0JGVyciA9ICQoICc8dWwgY2xhc3M9XCJsbG1zLW5vdGljZSBsbG1zLWVycm9yXCIgaWQ9XCInICsgaWQgKyAnXCIgLz4nICk7XG5cdFx0XHRcdCQoICcubGxtcy1jaGVja291dC13cmFwcGVyJyApLnByZXBlbmQoICRlcnIgKTtcblx0XHRcdH1cblxuXHRcdFx0JGVyci5hcHBlbmQoICc8bGk+JyArIG1lc3NhZ2UgKyAnPC9saT4nICk7XG5cblx0XHRcdGlmICggZGF0YSApIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvciggZGF0YSApO1xuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFB1YmxpYyBmdW5jdGlvbiB3aGljaCBhbGxvd3Mgb3RoZXIgY2xhc3NlcyBvciBleHRlbnNpb25zIHRvIGFkZFxuXHRcdCAqIGdhdGV3YXlzIGNsYXNzZXMgdGhhdCBzaG91bGQgYmUgYm91bmQgYnkgdGhpcyBjbGFzc1xuXHRcdCAqIEBwYXJhbSAgICBvYmogICBnYXRld2F5X2NsYXNzICBjYWxsYWJsZSBjbGFzcyBvYmplY3Rcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmFkZF9nYXRld2F5ID0gZnVuY3Rpb24oIGdhdGV3YXlfY2xhc3MgKSB7XG5cblx0XHRcdGdhdGV3YXlzLnB1c2goIGdhdGV3YXlfY2xhc3MgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGNvdXBvbiBhZGQgJiByZW1vdmUgYnV0dG9uIGV2ZW50c1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX2NvdXBvbiA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdC8vIHNob3cgJiBoaWRlIHRoZSBjb3Vwb24gZmllbGQgJiBidXR0b25cblx0XHRcdCQoICdhW2hyZWY9XCIjbGxtcy1jb3Vwb24tdG9nZ2xlXCJdJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCQoICcubGxtcy1jb3Vwb24tZW50cnknICkuc2xpZGVUb2dnbGUoIDQwMCApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIGFwcGx5IGNvdXBvbiBjbGlja1xuXHRcdFx0JCggJyNsbG1zLWFwcGx5LWNvdXBvbicgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRzZWxmLmNvdXBvbl9hcHBseSggJCggdGhpcyApICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGNvdXBvbiBjbGlja1xuXHRcdFx0JCggJyNsbG1zLXJlbW92ZS1jb3Vwb24nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0c2VsZi5jb3Vwb25fcmVtb3ZlKCAkKCB0aGlzICkgKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEJpbmQgZ2F0ZXdheSBzZWN0aW9uIGV2ZW50c1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX2dhdGV3YXlzID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHRoaXMubG9hZF9nYXRld2F5cygpO1xuXG5cdFx0XHRpZiAoICEgJCggJ2lucHV0W25hbWU9XCJsbG1zX3BheW1lbnRfZ2F0ZXdheVwiXScpLmxlbmd0aCApIHtcblx0XHRcdFx0JCggJyNsbG1zX2NyZWF0ZV9wZW5kaW5nX29yZGVyJyApLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gYWRkIGNsYXNzIGFuZCB0cmlnZ2VyIHdhdGNoYWJsZSBldmVudCB3aGVuIGdhdGV3YXkgc2VsZWN0aW9uIGNoYW5nZXNcblx0XHRcdCQoICdpbnB1dFtuYW1lPVwibGxtc19wYXltZW50X2dhdGV3YXlcIl0nICkub24oICdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcblxuIFx0XHRcdFx0JCggJ2lucHV0W25hbWU9XCJsbG1zX3BheW1lbnRfZ2F0ZXdheVwiXScgKS5lYWNoKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRcdHZhciAkZWwgPSAkKCB0aGlzICksXG5cdFx0XHRcdFx0XHQkcGFyZW50ID0gJGVsLmNsb3Nlc3QoICcubGxtcy1wYXltZW50LWdhdGV3YXknICksXG5cdFx0XHRcdFx0XHQkZmllbGRzID0gJHBhcmVudC5maW5kKCAnLmxsbXMtZ2F0ZXdheS1maWVsZHMnICkuZmluZCggJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0JyApLFxuXHRcdFx0XHRcdFx0Y2hlY2tlZCA9ICRlbC5pcyggJzpjaGVja2VkJyApLFxuXHRcdFx0XHRcdFx0ZGlzcGxheV9mdW5jID0gKCBjaGVja2VkICkgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJztcblxuXHRcdFx0XHRcdCRwYXJlbnRbIGRpc3BsYXlfZnVuYyBdKCAnaXMtc2VsZWN0ZWQnICk7XG5cblx0XHRcdFx0XHRpZiAoIGNoZWNrZWQgKSB7XG5cblx0XHRcdFx0XHRcdC8vIGVuYWJsZSBmaWVsZHNcblx0XHRcdFx0XHRcdCRmaWVsZHMucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApO1xuXG5cdFx0XHRcdFx0XHQvLyBlbWl0IGEgd2F0Y2hhYmxlIGV2ZW50IGZvciBleHRlbnNpb25zIHRvIGhvb2sgb250b1xuXHRcdFx0XHRcdFx0JCggJy5sbG1zLXBheW1lbnQtZ2F0ZXdheXMnICkudHJpZ2dlciggJ2xsbXMtZ2F0ZXdheS1zZWxlY3RlZCcsIHtcblx0XHRcdFx0XHRcdFx0aWQ6ICRlbC52YWwoKSxcblx0XHRcdFx0XHRcdFx0JHNlbGVjdG9yOiAkcGFyZW50LFxuXHRcdFx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0Ly8gZGlzYWJsZSBmaWVsZHNcblx0XHRcdFx0XHRcdCRmaWVsZHMuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBlbmFibGUgLyBkaXNhYmxlIGJ1dHRvbnMgZGVwZW5kaW5nIG9uIGZpZWxkIHZhbGlkYXRpb24gc3RhdHVzXG5cdFx0XHQkKCAnLmxsbXMtcGF5bWVudC1nYXRld2F5cycgKS5vbiggJ2xsbXMtZ2F0ZXdheS1zZWxlY3RlZCcsIGZ1bmN0aW9uKCBlLCBkYXRhICkge1xuXG5cdFx0XHRcdHZhciAkc3VibWl0ID0gJCggJyNsbG1zX2NyZWF0ZV9wZW5kaW5nX29yZGVyJyApO1xuXG5cdFx0XHRcdGlmICggZGF0YS4kc2VsZWN0b3IgJiYgZGF0YS4kc2VsZWN0b3IuZmluZCggJy5sbG1zLWdhdGV3YXktZmllbGRzIC5pbnZhbGlkJyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHQkc3VibWl0LmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkc3VibWl0LnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBjbGljayBldmVudHMgZm9yIHRoZSBTaG93IC8gSGlkZSBsb2dpbiBhcmVhIGF0IHRoZSB0b3Agb2YgdGhlIGNoZWNrb3V0IHNjcmVlblxuXHRcdCAqXG5cdFx0ICogQHNpbmNlIDMuMC4wXG5cdFx0ICogQHNpbmNlIDMuMzQuNSBXaGVuIHNob3dpbmcgdGhlIGxvZ2luIGZvcm0gYXJlYSBtYWtlIHN1cmUgd2Ugc2xpZGUgdXAgdGhlIGAubGxtcy1ub3RpY2VgIGxpbmsncyBwYXJlbnQgdG9vLlxuXHRcdCAqXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kX2xvZ2luID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoICdhW2hyZWY9XCIjbGxtcy1zaG93LWxvZ2luXCJdJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCQoIHRoaXMgKS5jbG9zZXN0KCAnLmxsbXMtaW5mbywubGxtcy1ub3RpY2UnICkuc2xpZGVVcCggNDAwICk7XG5cdFx0XHRcdCQoICdmb3JtLmxsbXMtbG9naW4nICkuc2xpZGVEb3duKCA0MDAgKTtcblxuXHRcdFx0fSApO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBDbGVhciBlcnJvciBtZXNzYWdlc1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMjcuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI3LjBcblx0XHQgKi9cblx0XHR0aGlzLmNsZWFyX2Vycm9ycyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0JCggJyNsbG1zLWNoZWNrb3V0LWVycm9ycycgKS5yZW1vdmUoKTtcblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogVHJpZ2dlcmVkIGJ5IGNsaWNraW5nIHRoZSBcIkFwcGx5IENvdXBvblwiIEJ1dHRvblxuXHRcdCAqIFZhbGlkYXRlcyB0aGUgY291cG9uIHZpYSBKUyBhbmQgYWRkcyBlcnJvciAvIHN1Y2Nlc3MgbWVzc2FnZXNcblx0XHQgKiBPbiBzdWNjZXNzIGl0IHdpbGwgcmVwbGFjZSBwYXJ0aWFscyBvbiB0aGUgY2hlY2tvdXQgc2NyZWVuIHdpdGggdXBkYXRlZFxuXHRcdCAqIHByaWNlcyBhbmQgYSBcInJlbW92ZSBjb3Vwb25cIiBidXR0b25cblx0XHQgKiBAcGFyYW0gICAgb2JqICAgJGJ0biAgalF1ZXJ5IHNlbGVjdG9yIG9mIHRoZSBBcHBseSBidXR0b25cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY291cG9uX2FwcGx5ID0gZnVuY3Rpb24gKCAkYnRuICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdCRjb2RlID0gJCggJyNsbG1zX2NvdXBvbl9jb2RlJyApLFxuXHRcdFx0XHRjb2RlID0gJGNvZGUudmFsKCksXG5cdFx0XHRcdCRtZXNzYWdlcyA9ICQoICcubGxtcy1jb3Vwb24tbWVzc2FnZXMnICksXG5cdFx0XHRcdCRlcnJvcnMgPSAkbWVzc2FnZXMuZmluZCggJy5sbG1zLWVycm9yJyApLFxuXHRcdFx0XHQkY29udGFpbmVyID0gJCggJ2Zvcm0ubGxtcy1jaGVja291dCcgKTtcblxuXHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkY29udGFpbmVyICk7XG5cblx0XHRcdHdpbmRvdy5MTE1TLkFqYXguY2FsbCgge1xuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAndmFsaWRhdGVfY291cG9uX2NvZGUnLFxuXHRcdFx0XHRcdGNvZGU6IGNvZGUsXG5cdFx0XHRcdFx0cGxhbl9pZDogJCggJyNsbG1zLXBsYW4taWQnICkudmFsKCksXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0JGVycm9ycy5oaWRlKCk7XG5cblx0XHRcdFx0fSxcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIHIgKSB7XG5cblx0XHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJGNvbnRhaW5lciApO1xuXG5cdFx0XHRcdFx0aWYgKCAnZXJyb3InID09PSByLmNvZGUgKSB7XG5cblx0XHRcdFx0XHRcdHZhciAkbWVzc2FnZSA9ICQoICc8bGk+JyArIHIubWVzc2FnZSArICc8L2xpPicpO1xuXG5cdFx0XHRcdFx0XHRpZiAoICEgJGVycm9ycy5sZW5ndGggKSB7XG5cblx0XHRcdFx0XHRcdFx0JGVycm9ycyA9ICQoICc8dWwgY2xhc3M9XCJsbG1zLW5vdGljZSBsbG1zLWVycm9yXCIgLz4nICk7XG5cdFx0XHRcdFx0XHRcdCRtZXNzYWdlcy5hcHBlbmQoICRlcnJvcnMgKTtcblxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHQkZXJyb3JzLmVtcHR5KCk7XG5cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0JG1lc3NhZ2UuYXBwZW5kVG8oICRlcnJvcnMgKTtcblx0XHRcdFx0XHRcdCRlcnJvcnMuc2hvdygpO1xuXG5cdFx0XHRcdFx0fSBlbHNlIGlmICggci5zdWNjZXNzICkge1xuXG5cdFx0XHRcdFx0XHQkKCAnLmxsbXMtY291cG9uLXdyYXBwZXInICkucmVwbGFjZVdpdGgoIHIuZGF0YS5jb3Vwb25faHRtbCApO1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kX2NvdXBvbigpO1xuXG5cdFx0XHRcdFx0XHQkKCAnLmxsbXMtcGF5bWVudC1nYXRld2F5cycgKS5yZXBsYWNlV2l0aCggci5kYXRhLmdhdGV3YXlzX2h0bWwgKTtcblx0XHRcdFx0XHRcdHNlbGYuYmluZF9nYXRld2F5cygpO1xuXG5cdFx0XHRcdFx0XHQkKCAnLmxsbXMtb3JkZXItc3VtbWFyeScgKS5yZXBsYWNlV2l0aCggci5kYXRhLnN1bW1hcnlfaHRtbCApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENhbGxlZCBieSBjbGlja2luZyB0aGUgXCJSZW1vdmUgQ291cG9uXCIgYnV0dG9uXG5cdFx0ICogUmVtb3ZlcyB0aGUgY291cG9uIHZpYSBBSkFYIGFuZCB1bnNldHMgcmVsYXRlZCBzZXNzaW9uIGRhdGFcblx0XHQgKiBAcGFyYW0gICAgb2JqICAgJGJ0biAgalF1ZXJ5IHNlbGVjdG9yIG9mIHRoZSBSZW1vdmUgYnV0dG9uXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmNvdXBvbl9yZW1vdmUgPSBmdW5jdGlvbiggJGJ0biApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHQkY29udGFpbmVyID0gJCggJ2Zvcm0ubGxtcy1jaGVja291dCcgKTtcblxuXHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkY29udGFpbmVyICk7XG5cblx0XHRcdHdpbmRvdy5MTE1TLkFqYXguY2FsbCgge1xuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAncmVtb3ZlX2NvdXBvbl9jb2RlJyxcblx0XHRcdFx0XHRwbGFuX2lkOiAkKCAnI2xsbXMtcGxhbi1pZCcgKS52YWwoKSxcblx0XHRcdFx0fSxcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIHIgKSB7XG5cblx0XHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJGNvbnRhaW5lciApO1xuXG5cdFx0XHRcdFx0aWYgKCByLnN1Y2Nlc3MgKSB7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1jb3Vwb24td3JhcHBlcicgKS5yZXBsYWNlV2l0aCggci5kYXRhLmNvdXBvbl9odG1sICk7XG5cdFx0XHRcdFx0XHRzZWxmLmJpbmRfY291cG9uKCk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1vcmRlci1zdW1tYXJ5JyApLnJlcGxhY2VXaXRoKCByLmRhdGEuc3VtbWFyeV9odG1sICk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1wYXltZW50LWdhdGV3YXlzJyApLnJlcGxhY2VXaXRoKCByLmRhdGEuZ2F0ZXdheXNfaHRtbCApO1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kX2dhdGV3YXlzKCk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogU2Nyb2xsIGVycm9yIG1lc3NhZ2VzIGludG8gdmlld1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMjcuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI3LjBcblx0XHQgKi9cblx0XHR0aGlzLmZvY3VzX2Vycm9ycyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0JCggJ2h0bWwsIGJvZHknICkuYW5pbWF0ZSgge1xuXHRcdFx0XHRzY3JvbGxUb3A6ICQoICcjbGxtcy1jaGVja291dC1lcnJvcnMnICkub2Zmc2V0KCkudG9wIC0gNTAsXG5cdFx0XHR9LCAyMDAgKTtcblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBleHRlcm5hbCBnYXRld2F5IEpTXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmxvYWRfZ2F0ZXdheXMgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDw9IGdhdGV3YXlzLmxlbmd0aDsgaSsrICkge1xuXHRcdFx0XHR2YXIgZyA9IGdhdGV3YXlzW2ldO1xuXHRcdFx0XHRpZiAoIHR5cGVvZiBnID09PSAnb2JqZWN0JyAmJiBnICE9PSBudWxsICkge1xuXHRcdFx0XHRcdGlmICggZy5iaW5kICE9PSB1bmRlZmluZWQgJiYgJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGcuYmluZCAgKSB7XG5cdFx0XHRcdFx0XHRnLmJpbmQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogU3RhcnQgb3Igc3RvcCBwcm9jZXNzaW5nIGV2ZW50cyBvbiB0aGUgY2hlY2tvdXQgZm9ybVxuXHRcdCAqIEBwYXJhbSAgICBzdHJpbmcgICBhY3Rpb24gIHdoZXRoZXIgdG8gc3RhcnQgb3Igc3RvcCBwcm9jZXNzaW5nIFtzdGFydHxzdG9wXVxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjQuMVxuXHRcdCAqL1xuXHRcdHRoaXMucHJvY2Vzc2luZyA9IGZ1bmN0aW9uKCBhY3Rpb24gKSB7XG5cblx0XHRcdHZhciBmdW5jLCAkZm9ybTtcblxuXHRcdFx0c3dpdGNoICggYWN0aW9uICkge1xuXG5cdFx0XHRcdGNhc2UgJ3N0b3AnOlxuXHRcdFx0XHRcdGZ1bmMgPSAncmVtb3ZlQ2xhc3MnO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdzdGFydCc6XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0ZnVuYyA9ICdhZGRDbGFzcyc7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggJ2NoZWNrb3V0JyA9PT0gdGhpcy5mb3JtX2FjdGlvbiApIHtcblx0XHRcdFx0JGZvcm0gPSB0aGlzLiRjaGVja291dF9mb3JtO1xuXHRcdFx0fSBlbHNlIGlmICggJ2NvbmZpcm0nID09PSB0aGlzLmZvcm1fYWN0aW9uICkge1xuXHRcdFx0XHQkZm9ybSA9IHRoaXMuJGNvbmZpcm1fZm9ybTtcblx0XHRcdH1cblxuXHRcdFx0JGZvcm1bIGZ1bmMgXSggJ2xsbXMtaXMtcHJvY2Vzc2luZycgKTtcblx0XHRcdExMTVMuU3Bpbm5lclsgYWN0aW9uIF0oIHRoaXMuJGZvcm1fc2VjdGlvbnMgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBIYW5kbGVzIGZvcm0gc3VibWlzc2lvblxuXHRcdCAqIENhbGxzIGFsbCB2YWxpZGF0aW9uIGV2ZW50cyBpbiBgYmVmb3JlX3N1Ym1pdFtdYFxuXHRcdCAqIHdhaXRzIGZvciBjYWxsIGJhY2tzIGFuZCBlaXRoZXIgZGlzcGxheXMgcmV0dXJuZWQgZXJyb3JzXG5cdFx0ICogb3Igc3VibWl0cyB0aGUgZm9ybSB3aGVuIGFsbCBhcmUgc3VjY2Vzc2Z1bFxuXHRcdCAqIEBwYXJhbSAgICBvYmogICBlICBKUyBldmVudCBvYmplY3Rcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI3LjBcblx0XHQgKi9cblx0XHR0aGlzLnN1Ym1pdCA9IGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IGUuZGF0YSxcblx0XHRcdFx0bnVtID0gYmVmb3JlX3N1Ym1pdC5sZW5ndGgsXG5cdFx0XHRcdGNoZWNrcyA9IDAsXG5cdFx0XHRcdG1heF9jaGVja3MgPSA2MDAwMCxcblx0XHRcdFx0ZXJyb3JzID0gW10sXG5cdFx0XHRcdGZpbmlzaGVzID0gMCxcblx0XHRcdFx0c3VjY2Vzc2VzID0gMCxcblx0XHRcdFx0aW50ZXJ2YWw7XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0Ly8gYWRkIHNwaW5uZXJzXG5cdFx0XHRzZWxmLnByb2Nlc3NpbmcoICdzdGFydCcgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGVycm9ycyB0byBwcmV2ZW50IGR1cGxpY2F0ZXNcblx0XHRcdHNlbGYuY2xlYXJfZXJyb3JzKCk7XG5cblx0XHRcdC8vIHN0YXJ0IHJ1bm5pbmcgYWxsIHRoZSBldmVudHNcblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGJlZm9yZV9zdWJtaXQubGVuZ3RoOyBpKysgKSB7XG5cblx0XHRcdFx0dmFyIG9iaiA9IGJlZm9yZV9zdWJtaXRbIGkgXTtcblxuXHRcdFx0XHRvYmouaGFuZGxlciggb2JqLmRhdGEsIGZ1bmN0aW9uKCByICkge1xuXG5cdFx0XHRcdFx0ZmluaXNoZXMrKztcblx0XHRcdFx0XHRpZiAoIHRydWUgPT09IHIgKSB7XG5cdFx0XHRcdFx0XHRzdWNjZXNzZXMrKztcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCAnc3RyaW5nJyA9PT0gdHlwZW9mIHIgKSB7XG5cdFx0XHRcdFx0XHRlcnJvcnMucHVzaCggciApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gcnVuIGFuIGludGVydmFsIHRvIHdhaXQgZm9yIGZpbmlzaGVzXG5cdFx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHR2YXIgY2xlYXIgPSBmYWxzZSxcblx0XHRcdFx0XHRzdG9wID0gZmFsc2U7XG5cblx0XHRcdFx0Ly8gdGltZW91dC4uLlxuXHRcdFx0XHRpZiAoIGNoZWNrcyA+PSBtYXhfY2hlY2tzICkge1xuXG5cdFx0XHRcdFx0Y2xlYXIgPSB0cnVlO1xuXHRcdFx0XHRcdHN0b3AgPSB0cnVlO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gZXZlcnl0aGluZyBoYXMgZmluaXNoZWRcblx0XHRcdFx0ZWxzZSBpZiAoIG51bSA9PT0gZmluaXNoZXMgKSB7XG5cblx0XHRcdFx0XHQvLyBhbGwgd2VyZSBzdWNjZXNzZnVsLCBzdWJtaXQgdGhlIGZvcm1cblx0XHRcdFx0XHRpZiAoIG51bSA9PT0gc3VjY2Vzc2VzICkge1xuXG5cdFx0XHRcdFx0XHRjbGVhciA9IHRydWU7XG5cblx0XHRcdFx0XHRcdHNlbGYuJGNoZWNrb3V0X2Zvcm0ub2ZmKCAnc3VibWl0Jywgc2VsZi5zdWJtaXQgKTtcblx0XHRcdFx0XHRcdHNlbGYuJGNoZWNrb3V0X2Zvcm0udHJpZ2dlciggJ3N1Ym1pdCcgKTtcblxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIGVycm9ycy5sZW5ndGggKSB7XG5cblx0XHRcdFx0XHRcdGNsZWFyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHN0b3AgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBlcnJvcnMubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYuYWRkX2Vycm9yKCBlcnJvcnNbIGkgXSApO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRzZWxmLmZvY3VzX2Vycm9ycygpO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIGNsZWFyICkge1xuXHRcdFx0XHRcdGNsZWFySW50ZXJ2YWwoIGludGVydmFsICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHN0b3AgKSB7XG5cdFx0XHRcdFx0c2VsZi5wcm9jZXNzaW5nKCAnc3RvcCcgKTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Y2hlY2tzKys7XG5cblx0XHRcdH0sIDEwMCApO1xuXG5cdFx0fTtcblxuXHRcdC8vIGluaXRpYWxpemVcblx0XHR0aGlzLmluaXQoKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH07XG5cblx0d2luZG93LmxsbXMgPSB3aW5kb3cubGxtcyB8fCB7fTtcblx0d2luZG93LmxsbXMuY2hlY2tvdXQgPSBuZXcgbGxtc19jaGVja291dCgpO1xuXG59ICkoIGpRdWVyeSApO1xuIl19
