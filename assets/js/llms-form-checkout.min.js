!function(e){window.llms=window.llms||{},window.llms.checkout=function(){return this.init=function(){e(".llms-checkout-wrapper").length&&(this.bind_login(),this.bind_coupon(),e('input[name="llms_payment_gateway"]').on("change",function(){e('input[name="llms_payment_gateway"]').each(function(){var l=e(this),n=l.closest(".llms-payment-gateway"),o=n.find(".llms-gateway-fields").find("input, textarea, select"),t=l.is(":checked"),s=t?"addClass":"removeClass";n[s]("is-selected"),t?(o.removeAttr("disabled"),e(".llms-payment-gateways").trigger("llms-gateway-selected",{id:l.val(),$selector:n})):o.attr("disabled","disabled")})}),e(".llms-payment-gateways").on("llms-gateway-selected",function(l,n){var o=e("#llms_create_pending_order");n.$selector&&n.$selector.find(".llms-gateway-fields .invalid").length?o.attr("disabled","disabled"):o.removeAttr("disabled")}))},this.bind_coupon=function(){var l=this;e('a[href="#llms-coupon-toggle"]').on("click",function(l){l.preventDefault(),e(".llms-coupon-entry").slideToggle(400)}),e("#llms-apply-coupon").on("click",function(n){n.preventDefault(),l.coupon_apply(e(this))}),e("#llms-remove-coupon").on("click",function(n){n.preventDefault(),l.coupon_remove(e(this))})},this.bind_login=function(){e('a[href="#llms-show-login"]').on("click",function(l){l.preventDefault(),e(this).closest(".llms-info").slideUp(400),e("form.llms-login").slideDown(400)})},this.coupon_apply=function(l){var n=this,o=e("#llms_coupon_code"),t=o.val(),s=e(".llms-coupon-messages"),a=s.find(".llms-error"),i=e("form.llms-checkout");LLMS.Spinner.start(i),window.LLMS.Ajax.call({data:{action:"validate_coupon_code",code:t,plan_id:e("#llms-plan-id").val()},beforeSend:function(){a.hide()},success:function(l){if(LLMS.Spinner.stop(i),"error"===l.code){var o=e("<li>"+l.message+"</li>");a.length?a.empty():(a=e('<ul class="llms-error" />'),s.append(a)),o.appendTo(a),a.show()}else l.success&&(e(".llms-coupon-wrapper").replaceWith(l.data.coupon_html),n.bind_coupon(),e(".llms-order-summary").replaceWith(l.data.summary_html))}})},this.coupon_remove=function(l){var n=this,o=e("form.llms-checkout");LLMS.Spinner.start(o),window.LLMS.Ajax.call({data:{action:"remove_coupon_code",plan_id:e("#llms-plan-id").val()},success:function(l){LLMS.Spinner.stop(o),l.success&&(e(".llms-coupon-wrapper").replaceWith(l.data.coupon_html),n.bind_coupon(),e(".llms-order-summary").replaceWith(l.data.summary_html))}})},this.init(),this};new window.llms.checkout}(jQuery);