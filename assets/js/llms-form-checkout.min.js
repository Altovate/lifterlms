!function(e){var t=function(){var t=[],s=[];return this.$checkout_form=e("#llms-product-purchase-form"),this.$checkout_sections=this.$checkout_form.find(".llms-checkout-section"),this.init=function(){this.$checkout_form.length&&(this.$checkout_form.on("submit",this,this.submit),e(".llms-password-strength-meter").length&&this.add_before_submit_event({data:LLMS.PasswordStrength,handler:LLMS.PasswordStrength.checkout}),this.bind_login(),this.bind_coupon(),this.bind_gateways())},this.add_before_submit_event=function(e){e.handler&&"function"==typeof e.handler&&(e.data||(e.data=null),t.push(e))},this.add_gateway=function(e){s.push(e)},this.bind_coupon=function(){var t=this;e('a[href="#llms-coupon-toggle"]').on("click",function(t){t.preventDefault(),e(".llms-coupon-entry").slideToggle(400)}),e("#llms-apply-coupon").on("click",function(s){s.preventDefault(),t.coupon_apply(e(this))}),e("#llms-remove-coupon").on("click",function(s){s.preventDefault(),t.coupon_remove(e(this))})},this.bind_gateways=function(){this.load_gateways(),e('input[name="llms_payment_gateway"]').length||e("#llms_create_pending_order").removeAttr("disabled"),e('input[name="llms_payment_gateway"]').on("change",function(){e('input[name="llms_payment_gateway"]').each(function(){var t=e(this),s=t.closest(".llms-payment-gateway"),l=s.find(".llms-gateway-fields").find("input, textarea, select"),n=t.is(":checked"),a=n?"addClass":"removeClass";s[a]("is-selected"),n?(l.removeAttr("disabled"),e(".llms-payment-gateways").trigger("llms-gateway-selected",{id:t.val(),$selector:s})):l.attr("disabled","disabled")})}),e(".llms-payment-gateways").on("llms-gateway-selected",function(t,s){var l=e("#llms_create_pending_order");s.$selector&&s.$selector.find(".llms-gateway-fields .invalid").length?l.attr("disabled","disabled"):l.removeAttr("disabled")})},this.bind_login=function(){e('a[href="#llms-show-login"]').on("click",function(t){t.preventDefault(),e(this).closest(".llms-info").slideUp(400),e("form.llms-login").slideDown(400)})},this.coupon_apply=function(t){var s=this,l=e("#llms_coupon_code"),n=l.val(),a=e(".llms-coupon-messages"),o=a.find(".llms-error"),i=e("form.llms-checkout");LLMS.Spinner.start(i),window.LLMS.Ajax.call({data:{action:"validate_coupon_code",code:n,plan_id:e("#llms-plan-id").val()},beforeSend:function(){o.hide()},success:function(t){if(LLMS.Spinner.stop(i),"error"===t.code){var l=e("<li>"+t.message+"</li>");o.length?o.empty():(o=e('<ul class="llms-notice llms-error" />'),a.append(o)),l.appendTo(o),o.show()}else t.success&&(e(".llms-coupon-wrapper").replaceWith(t.data.coupon_html),s.bind_coupon(),e(".llms-payment-gateways").replaceWith(t.data.gateways_html),s.bind_gateways(),e(".llms-order-summary").replaceWith(t.data.summary_html))}})},this.coupon_remove=function(t){var s=this,l=e("form.llms-checkout");LLMS.Spinner.start(l),window.LLMS.Ajax.call({data:{action:"remove_coupon_code",plan_id:e("#llms-plan-id").val()},success:function(t){LLMS.Spinner.stop(l),t.success&&(e(".llms-coupon-wrapper").replaceWith(t.data.coupon_html),s.bind_coupon(),e(".llms-order-summary").replaceWith(t.data.summary_html),e(".llms-payment-gateways").replaceWith(t.data.gateways_html),s.bind_gateways())}})},this.load_gateways=function(){for(var e=0;e<=s.length;e++){var t=s[e];"object"==typeof t&&null!==t&&void 0!==t.bind&&"function"==typeof t.bind&&t.bind()}},this.processing=function(e){var t;switch(e){case"stop":t="removeClass";break;case"start":default:t="addClass"}this.$checkout_form[t]("llms-is-processing"),LLMS.Spinner[e](this.$checkout_sections)},this.submit=function(s){var l,n=s.data,a=t.length,o=0,i=6e4,c=[],r=0,d=0;s.preventDefault(),n.processing("start"),e("#llms-checkout-errors").remove();for(var m=0;m<t.length;m++){var u=t[m];u.handler(u.data,function(e){r++,!0===e?d++:"string"==typeof e&&c.push(e)})}l=setInterval(function(){var t=!1,s=!1;if(o>=i)t=!0,s=!0;else if(a===r)if(a===d)t=!0,n.$checkout_form.off("submit",n.submit),n.$checkout_form.trigger("submit");else if(c.length){t=!0,s=!0;for(var m=e('<ul class="llms-notice llms-error" id="llms-checkout-errors" />'),u=0;u<c.length;u++)m.append("<li>"+c[u]+"</li>");e(".llms-checkout-wrapper").prepend(m),e("html, body").animate({scrollTop:m.offset().top-50},200)}t&&clearInterval(l),s&&n.processing("stop"),o++},100)},this.init(),this};window.llms=window.llms||{},window.llms.checkout=new t}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtZm9ybS1jaGVja291dC5qcyJdLCJuYW1lcyI6WyIkIiwibGxtc19jaGVja291dCIsImJlZm9yZV9zdWJtaXQiLCJnYXRld2F5cyIsInRoaXMiLCIkY2hlY2tvdXRfZm9ybSIsIiRjaGVja291dF9zZWN0aW9ucyIsImZpbmQiLCJpbml0IiwibGVuZ3RoIiwib24iLCJzdWJtaXQiLCJhZGRfYmVmb3JlX3N1Ym1pdF9ldmVudCIsImRhdGEiLCJMTE1TIiwiUGFzc3dvcmRTdHJlbmd0aCIsImhhbmRsZXIiLCJjaGVja291dCIsImJpbmRfbG9naW4iLCJiaW5kX2NvdXBvbiIsImJpbmRfZ2F0ZXdheXMiLCJvYmoiLCJwdXNoIiwiYWRkX2dhdGV3YXkiLCJnYXRld2F5X2NsYXNzIiwic2VsZiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInNsaWRlVG9nZ2xlIiwiY291cG9uX2FwcGx5IiwiY291cG9uX3JlbW92ZSIsImxvYWRfZ2F0ZXdheXMiLCJyZW1vdmVBdHRyIiwiZWFjaCIsIiRlbCIsIiRwYXJlbnQiLCJjbG9zZXN0IiwiJGZpZWxkcyIsImNoZWNrZWQiLCJpcyIsImRpc3BsYXlfZnVuYyIsInRyaWdnZXIiLCJpZCIsInZhbCIsIiRzZWxlY3RvciIsImF0dHIiLCIkc3VibWl0Iiwic2xpZGVVcCIsInNsaWRlRG93biIsIiRidG4iLCIkY29kZSIsImNvZGUiLCIkbWVzc2FnZXMiLCIkZXJyb3JzIiwiJGNvbnRhaW5lciIsIlNwaW5uZXIiLCJzdGFydCIsIndpbmRvdyIsIkFqYXgiLCJjYWxsIiwiYWN0aW9uIiwicGxhbl9pZCIsImJlZm9yZVNlbmQiLCJoaWRlIiwic3VjY2VzcyIsInIiLCJzdG9wIiwiJG1lc3NhZ2UiLCJtZXNzYWdlIiwiZW1wdHkiLCJhcHBlbmQiLCJhcHBlbmRUbyIsInNob3ciLCJyZXBsYWNlV2l0aCIsImNvdXBvbl9odG1sIiwiZ2F0ZXdheXNfaHRtbCIsInN1bW1hcnlfaHRtbCIsImkiLCJnIiwidW5kZWZpbmVkIiwiYmluZCIsInByb2Nlc3NpbmciLCJmdW5jIiwiaW50ZXJ2YWwiLCJudW0iLCJjaGVja3MiLCJtYXhfY2hlY2tzIiwiZXJyb3JzIiwiZmluaXNoZXMiLCJzdWNjZXNzZXMiLCJyZW1vdmUiLCJzZXRJbnRlcnZhbCIsImNsZWFyIiwib2ZmIiwiJGVyciIsInByZXBlbmQiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwib2Zmc2V0IiwidG9wIiwiY2xlYXJJbnRlcnZhbCIsImxsbXMiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQU1BLFNBQVlBLEdBRVgsR0FBSUMsR0FBZ0IsV0FRbkIsR0FBSUMsTUFRQUMsSUEwY0osT0F4Y0FDLE1BQUtDLGVBQWlCTCxFQUFHLCtCQUN6QkksS0FBS0UsbUJBQXFCRixLQUFLQyxlQUFlRSxLQUFNLDBCQVFwREgsS0FBS0ksS0FBTyxXQUVOSixLQUFLQyxlQUFlSSxTQUV4QkwsS0FBS0MsZUFBZUssR0FBSSxTQUFVTixLQUFNQSxLQUFLTyxRQUd4Q1gsRUFBRyxpQ0FBa0NTLFFBQ3pDTCxLQUFLUSx5QkFDSkMsS0FBTUMsS0FBS0MsaUJBQ1hDLFFBQVNGLEtBQUtDLGlCQUFpQkUsV0FJakNiLEtBQUtjLGFBRUxkLEtBQUtlLGNBRUxmLEtBQUtnQixrQkFlUGhCLEtBQUtRLHdCQUEwQixTQUFVUyxHQUVsQ0EsRUFBSUwsU0FBVyxrQkFBc0JLLEdBQUlMLFVBSXpDSyxFQUFJUixPQUNUUSxFQUFJUixLQUFPLE1BR1pYLEVBQWNvQixLQUFNRCxLQVdyQmpCLEtBQUttQixZQUFjLFNBQVVDLEdBRTVCckIsRUFBU21CLEtBQU1FLElBVWhCcEIsS0FBS2UsWUFBYyxXQUVsQixHQUFJTSxHQUFPckIsSUFHWEosR0FBRyxpQ0FBa0NVLEdBQUksUUFBUyxTQUFVZ0IsR0FFM0RBLEVBQUVDLGlCQUNGM0IsRUFBRyxzQkFBdUI0QixZQUFhLE9BS3hDNUIsRUFBRyxzQkFBdUJVLEdBQUksUUFBUyxTQUFVZ0IsR0FFaERBLEVBQUVDLGlCQUNGRixFQUFLSSxhQUFjN0IsRUFBR0ksU0FLdkJKLEVBQUcsdUJB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QixlQUFlb0MsUUFBUyxjQUV2QixJQUFLOEMsRUFBTzlFLE9BQVMsQ0FFM0JtRixHQUFRLEVBQ1IxQixHQUFPLENBSVAsS0FBTSxHQUZGNEIsR0FBTzlGLEVBQUcsbUVBRUo2RSxFQUFJLEVBQUdBLEVBQUlVLEVBQU85RSxPQUFRb0UsSUFDbkNpQixFQUFLeEIsT0FBUSxPQUFTaUIsRUFBT1YsR0FBSyxRQUduQzdFLEdBQUcsMEJBQTJCK0YsUUFBU0QsR0FDdkM5RixFQUFHLGNBQWVnRyxTQUNqQkMsVUFBV0gsRUFBS0ksU0FBU0MsSUFBTSxJQUM3QixLQU1BUCxHQUNKUSxjQUFlakIsR0FHWGpCLEdBQ0p6QyxFQUFLd0QsV0FBWSxRQUlsQkksS0FFRSxNQUtKakYsS0FBS0ksT0FFRUosS0FJUnFELFFBQU80QyxLQUFPNUMsT0FBTzRDLFNBQ3JCNUMsT0FBTzRDLEtBQUtwRixTQUFXLEdBQUloQixJQUV2QnFHIiwiZmlsZSI6ImxsbXMtZm9ybS1jaGVja291dC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIExpZnRlckxNUyBDaGVja291dCBTY3JlZW4gcmVsYXRlZCBldmVudHMgYW5kIGludGVyYWN0aW9uc1xuICpcbiAqIEBzaW5jZSAgICAzLjAuMFxuICogQHZlcnNpb24gIDMuMC4wXG4gKi9cbiggZnVuY3Rpb24oICQgKSB7XG5cblx0dmFyIGxsbXNfY2hlY2tvdXQgPSBmdW5jdGlvbigpIHtcblxuXHRcdC8qKlxuXHRcdCAqIEFycmF5IG9mIHZhbGlkYXRpb24gZnVuY3Rpb25zIHRvIGNhbGwgb24gZm9ybSBzdWJtaXNzaW9uXG5cdFx0ICogQHR5cGUgIGFycmF5XG5cdFx0ICogQHNpbmNlIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gMy4wLjBcblx0XHQgKi9cblx0XHR2YXIgYmVmb3JlX3N1Ym1pdCA9IFtdOyAvLyBhcnJheSBvZiBmdW5jdGlvbnMgdG8gY2FsbCBiZWZvcmUgc3VibWl0dGluZyB0aGUgZm9ybVxuXG5cdFx0LyoqXG5cdFx0ICogQXJyYXkgb2YgZ2F0ZXdheXMgdG8gYmUgYXV0b21hdGljYWxseSBib3VuZCB3aGVuIG5lZWRlZFxuXHRcdCAqIEB0eXBlICBhcnJheVxuXHRcdCAqIEBzaW5jZSAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMC4wXG5cdFx0ICovXG5cdFx0dmFyIGdhdGV3YXlzID0gW107XG5cblx0XHR0aGlzLiRjaGVja291dF9mb3JtID0gJCggJyNsbG1zLXByb2R1Y3QtcHVyY2hhc2UtZm9ybScgKTtcblx0XHR0aGlzLiRjaGVja291dF9zZWN0aW9ucyA9IHRoaXMuJGNoZWNrb3V0X2Zvcm0uZmluZCggJy5sbG1zLWNoZWNrb3V0LXNlY3Rpb24nICk7XG5cblx0XHQvKipcblx0XHQgKiBJbml0YWxpemUgY2hlY2tvdXQgSlMgJiBiaW5kIGlmIG9uIHRoZSBjaGVja291dCBzY3JlZW5cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRpZiAoIHRoaXMuJGNoZWNrb3V0X2Zvcm0ubGVuZ3RoICkge1xuXG5cdFx0XHRcdHRoaXMuJGNoZWNrb3V0X2Zvcm0ub24oICdzdWJtaXQnLCB0aGlzLCB0aGlzLnN1Ym1pdCApO1xuXG5cdFx0XHRcdC8vIGFkZCBiZWZvcmUgc3VibWl0IGV2ZW50IGZvciBwYXNzd29yZCBzdHJlbmd0aCBtZXRlciBpZiBvbmUncyBmb3VuZFxuXHRcdFx0XHRpZiAoICQoICcubGxtcy1wYXNzd29yZC1zdHJlbmd0aC1tZXRlcicgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRfYmVmb3JlX3N1Ym1pdF9ldmVudCgge1xuXHRcdFx0XHRcdFx0ZGF0YTogTExNUy5QYXNzd29yZFN0cmVuZ3RoLFxuXHRcdFx0XHRcdFx0aGFuZGxlcjogTExNUy5QYXNzd29yZFN0cmVuZ3RoLmNoZWNrb3V0LFxuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuYmluZF9sb2dpbigpO1xuXG5cdFx0XHRcdHRoaXMuYmluZF9jb3Vwb24oKTtcblxuXHRcdFx0XHR0aGlzLmJpbmRfZ2F0ZXdheXMoKTtcblxuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFB1YmxpYyBmdW5jdGlvbiB3aGljaCBhbGxvd3Mgb3RoZXIgY2xhc3NlcyBvciBleHRlbnNpb25zIHRvIGFkZFxuXHRcdCAqIGJlZm9yZSBzdWJtaXQgZXZlbnRzIHRvIGxsbXMgY2hlY2tvdXQgcHJpdmF0ZSBcImJlZm9yZV9zdWJtaXRcIiBhcnJheVxuXHRcdCAqIEBwYXJhbSAgICBvYmplY3QgIG9iaiAgb2JqZWN0IG9mIGRhdGEgdG8gcHVzaCB0byB0aGUgYXJyYXlcblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzIGF0IGxlYXN0IGEgXCJoYW5kbGVyXCIga2V5IHdoaWNoIHNob3VsZCBwYXNzIGEgY2FsbGFibGUgZnVuY3Rpb25cblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVwiIGNhbiBiZSBhbnl0aGluZywgd2lsbCBiZSBwYXNzZWQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlciB0byB0aGUgaGFuZGxlciBmdW5jdGlvblxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYWRkX2JlZm9yZV9zdWJtaXRfZXZlbnQgPSBmdW5jdGlvbiggb2JqICkge1xuXG5cdFx0XHRpZiAoICFvYmouaGFuZGxlciB8fCAnZnVuY3Rpb24nICE9PSB0eXBlb2Ygb2JqLmhhbmRsZXIgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCAhb2JqLmRhdGEgKSB7XG5cdFx0XHRcdG9iai5kYXRhID0gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0YmVmb3JlX3N1Ym1pdC5wdXNoKCBvYmogKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBQdWJsaWMgZnVuY3Rpb24gd2hpY2ggYWxsb3dzIG90aGVyIGNsYXNzZXMgb3IgZXh0ZW5zaW9ucyB0byBhZGRcblx0XHQgKiBnYXRld2F5cyBjbGFzc2VzIHRoYXQgc2hvdWxkIGJlIGJvdW5kIGJ5IHRoaXMgY2xhc3Ncblx0XHQgKiBAcGFyYW0gICAgb2JqICAgZ2F0ZXdheV9jbGFzcyAgY2FsbGFibGUgY2xhc3Mgb2JqZWN0XG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5hZGRfZ2F0ZXdheSA9IGZ1bmN0aW9uKCBnYXRld2F5X2NsYXNzICkge1xuXG5cdFx0XHRnYXRld2F5cy5wdXNoKCBnYXRld2F5X2NsYXNzICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBjb3Vwb24gYWRkICYgcmVtb3ZlIGJ1dHRvbiBldmVudHNcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYmluZF9jb3Vwb24gPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHQvLyBzaG93ICYgaGlkZSB0aGUgY291cG9uIGZpZWxkICYgYnV0dG9uXG5cdFx0XHQkKCAnYVtocmVmPVwiI2xsbXMtY291cG9uLXRvZ2dsZVwiXScgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQkKCAnLmxsbXMtY291cG9uLWVudHJ5JyApLnNsaWRlVG9nZ2xlKCA0MDAgKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBhcHBseSBjb3Vwb24gY2xpY2tcblx0XHRcdCQoICcjbGxtcy1hcHBseS1jb3Vwb24nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0c2VsZi5jb3Vwb25fYXBwbHkoICQoIHRoaXMgKSApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIHJlbW92ZSBjb3Vwb24gY2xpY2tcblx0XHRcdCQoICcjbGxtcy1yZW1vdmUtY291cG9uJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHNlbGYuY291cG9uX3JlbW92ZSggJCggdGhpcyApICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGdhdGV3YXkgc2VjdGlvbiBldmVudHNcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYmluZF9nYXRld2F5cyA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR0aGlzLmxvYWRfZ2F0ZXdheXMoKTtcblxuXHRcdFx0aWYgKCAhICQoICdpbnB1dFtuYW1lPVwibGxtc19wYXltZW50X2dhdGV3YXlcIl0nKS5sZW5ndGggKSB7XG5cdFx0XHRcdCQoICcjbGxtc19jcmVhdGVfcGVuZGluZ19vcmRlcicgKS5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGFkZCBjbGFzcyBhbmQgdHJpZ2dlciB3YXRjaGFibGUgZXZlbnQgd2hlbiBnYXRld2F5IHNlbGVjdGlvbiBjaGFuZ2VzXG5cdFx0XHQkKCAnaW5wdXRbbmFtZT1cImxsbXNfcGF5bWVudF9nYXRld2F5XCJdJyApLm9uKCAnY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cbiBcdFx0XHRcdCQoICdpbnB1dFtuYW1lPVwibGxtc19wYXltZW50X2dhdGV3YXlcIl0nICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0XHR2YXIgJGVsID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdFx0JHBhcmVudCA9ICRlbC5jbG9zZXN0KCAnLmxsbXMtcGF5bWVudC1nYXRld2F5JyApLFxuXHRcdFx0XHRcdFx0JGZpZWxkcyA9ICRwYXJlbnQuZmluZCggJy5sbG1zLWdhdGV3YXktZmllbGRzJyApLmZpbmQoICdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCcgKSxcblx0XHRcdFx0XHRcdGNoZWNrZWQgPSAkZWwuaXMoICc6Y2hlY2tlZCcgKSxcblx0XHRcdFx0XHRcdGRpc3BsYXlfZnVuYyA9ICggY2hlY2tlZCApID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyc7XG5cblx0XHRcdFx0XHQkcGFyZW50WyBkaXNwbGF5X2Z1bmMgXSggJ2lzLXNlbGVjdGVkJyApO1xuXG5cdFx0XHRcdFx0aWYgKCBjaGVja2VkICkge1xuXG5cdFx0XHRcdFx0XHQvLyBlbmFibGUgZmllbGRzXG5cdFx0XHRcdFx0XHQkZmllbGRzLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblxuXHRcdFx0XHRcdFx0Ly8gZW1pdCBhIHdhdGNoYWJsZSBldmVudCBmb3IgZXh0ZW5zaW9ucyB0byBob29rIG9udG9cblx0XHRcdFx0XHRcdCQoICcubGxtcy1wYXltZW50LWdhdGV3YXlzJyApLnRyaWdnZXIoICdsbG1zLWdhdGV3YXktc2VsZWN0ZWQnLCB7XG5cdFx0XHRcdFx0XHRcdGlkOiAkZWwudmFsKCksXG5cdFx0XHRcdFx0XHRcdCRzZWxlY3RvcjogJHBhcmVudCxcblx0XHRcdFx0XHRcdH0gKTtcblxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRcdC8vIGRpc2FibGUgZmllbGRzXG5cdFx0XHRcdFx0XHQkZmllbGRzLmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gZW5hYmxlIC8gZGlzYWJsZSBidXR0b25zIGRlcGVuZGluZyBvbiBmaWVsZCB2YWxpZGF0aW9uIHN0YXR1c1xuXHRcdFx0JCggJy5sbG1zLXBheW1lbnQtZ2F0ZXdheXMnICkub24oICdsbG1zLWdhdGV3YXktc2VsZWN0ZWQnLCBmdW5jdGlvbiggZSwgZGF0YSApIHtcblxuXHRcdFx0XHR2YXIgJHN1Ym1pdCA9ICQoICcjbGxtc19jcmVhdGVfcGVuZGluZ19vcmRlcicgKTtcblxuXHRcdFx0XHRpZiAoIGRhdGEuJHNlbGVjdG9yICYmIGRhdGEuJHNlbGVjdG9yLmZpbmQoICcubGxtcy1nYXRld2F5LWZpZWxkcyAuaW52YWxpZCcgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0JHN1Ym1pdC5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHN1Ym1pdC5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEJpbmQgY2xpY2sgZXZlbnRzIGZvciB0aGUgU2hvdyAvIEhpZGUgbG9naW4gYXJlYSBhdCB0aGUgdG9wIG9mIHRoZSBjaGVja291dCBzY3JlZW5cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYmluZF9sb2dpbiA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQkKCAnYVtocmVmPVwiI2xsbXMtc2hvdy1sb2dpblwiXScgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQkKCB0aGlzICkuY2xvc2VzdCggJy5sbG1zLWluZm8nICkuc2xpZGVVcCggNDAwICk7XG5cdFx0XHRcdCQoICdmb3JtLmxsbXMtbG9naW4nICkuc2xpZGVEb3duKCA0MDAgKTtcblxuXHRcdFx0fSApO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBUcmlnZ2VyZWQgYnkgY2xpY2tpbmcgdGhlIFwiQXBwbHkgQ291cG9uXCIgQnV0dG9uXG5cdFx0ICogVmFsaWRhdGVzIHRoZSBjb3Vwb24gdmlhIEpTIGFuZCBhZGRzIGVycm9yIC8gc3VjY2VzcyBtZXNzYWdlc1xuXHRcdCAqIE9uIHN1Y2Nlc3MgaXQgd2lsbCByZXBsYWNlIHBhcnRpYWxzIG9uIHRoZSBjaGVja291dCBzY3JlZW4gd2l0aCB1cGRhdGVkXG5cdFx0ICogcHJpY2VzIGFuZCBhIFwicmVtb3ZlIGNvdXBvblwiIGJ1dHRvblxuXHRcdCAqIEBwYXJhbSAgICBvYmogICAkYnRuICBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIEFwcGx5IGJ1dHRvblxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5jb3Vwb25fYXBwbHkgPSBmdW5jdGlvbiAoICRidG4gKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0JGNvZGUgPSAkKCAnI2xsbXNfY291cG9uX2NvZGUnICksXG5cdFx0XHRcdGNvZGUgPSAkY29kZS52YWwoKSxcblx0XHRcdFx0JG1lc3NhZ2VzID0gJCggJy5sbG1zLWNvdXBvbi1tZXNzYWdlcycgKSxcblx0XHRcdFx0JGVycm9ycyA9ICRtZXNzYWdlcy5maW5kKCAnLmxsbXMtZXJyb3InICksXG5cdFx0XHRcdCRjb250YWluZXIgPSAkKCAnZm9ybS5sbG1zLWNoZWNrb3V0JyApO1xuXG5cdFx0XHRMTE1TLlNwaW5uZXIuc3RhcnQoICRjb250YWluZXIgKTtcblxuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICd2YWxpZGF0ZV9jb3Vwb25fY29kZScsXG5cdFx0XHRcdFx0Y29kZTogY29kZSxcblx0XHRcdFx0XHRwbGFuX2lkOiAkKCAnI2xsbXMtcGxhbi1pZCcgKS52YWwoKSxcblx0XHRcdFx0fSxcblx0XHRcdFx0YmVmb3JlU2VuZDogZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0XHQkZXJyb3JzLmhpZGUoKTtcblxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggciApIHtcblxuXHRcdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCAkY29udGFpbmVyICk7XG5cblx0XHRcdFx0XHRpZiAoICdlcnJvcicgPT09IHIuY29kZSApIHtcblxuXHRcdFx0XHRcdFx0dmFyICRtZXNzYWdlID0gJCggJzxsaT4nICsgci5tZXNzYWdlICsgJzwvbGk+Jyk7XG5cblx0XHRcdFx0XHRcdGlmICggISAkZXJyb3JzLmxlbmd0aCApIHtcblxuXHRcdFx0XHRcdFx0XHQkZXJyb3JzID0gJCggJzx1bCBjbGFzcz1cImxsbXMtbm90aWNlIGxsbXMtZXJyb3JcIiAvPicgKTtcblx0XHRcdFx0XHRcdFx0JG1lc3NhZ2VzLmFwcGVuZCggJGVycm9ycyApO1xuXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHRcdCRlcnJvcnMuZW1wdHkoKTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQkbWVzc2FnZS5hcHBlbmRUbyggJGVycm9ycyApO1xuXHRcdFx0XHRcdFx0JGVycm9ycy5zaG93KCk7XG5cblx0XHRcdFx0XHR9IGVsc2UgaWYgKCByLnN1Y2Nlc3MgKSB7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1jb3Vwb24td3JhcHBlcicgKS5yZXBsYWNlV2l0aCggci5kYXRhLmNvdXBvbl9odG1sICk7XG5cdFx0XHRcdFx0XHRzZWxmLmJpbmRfY291cG9uKCk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1wYXltZW50LWdhdGV3YXlzJyApLnJlcGxhY2VXaXRoKCByLmRhdGEuZ2F0ZXdheXNfaHRtbCApO1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kX2dhdGV3YXlzKCk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1vcmRlci1zdW1tYXJ5JyApLnJlcGxhY2VXaXRoKCByLmRhdGEuc3VtbWFyeV9odG1sICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQ2FsbGVkIGJ5IGNsaWNraW5nIHRoZSBcIlJlbW92ZSBDb3Vwb25cIiBidXR0b25cblx0XHQgKiBSZW1vdmVzIHRoZSBjb3Vwb24gdmlhIEFKQVggYW5kIHVuc2V0cyByZWxhdGVkIHNlc3Npb24gZGF0YVxuXHRcdCAqIEBwYXJhbSAgICBvYmogICAkYnRuICBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIFJlbW92ZSBidXR0b25cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY291cG9uX3JlbW92ZSA9IGZ1bmN0aW9uKCAkYnRuICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdCRjb250YWluZXIgPSAkKCAnZm9ybS5sbG1zLWNoZWNrb3V0JyApO1xuXG5cdFx0XHRMTE1TLlNwaW5uZXIuc3RhcnQoICRjb250YWluZXIgKTtcblxuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICdyZW1vdmVfY291cG9uX2NvZGUnLFxuXHRcdFx0XHRcdHBsYW5faWQ6ICQoICcjbGxtcy1wbGFuLWlkJyApLnZhbCgpLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiggciApIHtcblxuXHRcdFx0XHRcdExMTVMuU3Bpbm5lci5zdG9wKCAkY29udGFpbmVyICk7XG5cblx0XHRcdFx0XHRpZiAoIHIuc3VjY2VzcyApIHtcblxuXHRcdFx0XHRcdFx0JCggJy5sbG1zLWNvdXBvbi13cmFwcGVyJyApLnJlcGxhY2VXaXRoKCByLmRhdGEuY291cG9uX2h0bWwgKTtcblx0XHRcdFx0XHRcdHNlbGYuYmluZF9jb3Vwb24oKTtcblxuXHRcdFx0XHRcdFx0JCggJy5sbG1zLW9yZGVyLXN1bW1hcnknICkucmVwbGFjZVdpdGgoIHIuZGF0YS5zdW1tYXJ5X2h0bWwgKTtcblxuXHRcdFx0XHRcdFx0JCggJy5sbG1zLXBheW1lbnQtZ2F0ZXdheXMnICkucmVwbGFjZVdpdGgoIHIuZGF0YS5nYXRld2F5c19odG1sICk7XG5cdFx0XHRcdFx0XHRzZWxmLmJpbmRfZ2F0ZXdheXMoKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGV4dGVybmFsIGdhdGV3YXkgSlNcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMubG9hZF9nYXRld2F5cyA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPD0gZ2F0ZXdheXMubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdHZhciBnID0gZ2F0ZXdheXNbaV07XG5cdFx0XHRcdGlmICggdHlwZW9mIGcgPT09ICdvYmplY3QnICYmIGcgIT09IG51bGwgKSB7XG5cdFx0XHRcdFx0aWYgKCBnLmJpbmQgIT09IHVuZGVmaW5lZCAmJiAnZnVuY3Rpb24nID09PSB0eXBlb2YgZy5iaW5kICApIHtcblx0XHRcdFx0XHRcdGcuYmluZCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBTdGFydCBvciBzdG9wIHByb2NjZXNzaW5nIGV2ZW50cyBvbiB0aGUgY2hlY2tvdXQgZm9ybVxuXHRcdCAqIEBwYXJhbSAgICBzdHJpbmcgICBhY3Rpb24gIHdoZXRoZXIgdG8gc3RhcnQgb3Igc3RvcCBwcm9jZXNzaW5nIFtzdGFydHxzdG9wXVxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5wcm9jZXNzaW5nID0gZnVuY3Rpb24oIGFjdGlvbiApIHtcblxuXHRcdFx0dmFyIGZ1bmM7XG5cblx0XHRcdHN3aXRjaCAoIGFjdGlvbiApIHtcblxuXHRcdFx0XHRjYXNlICdzdG9wJzpcblx0XHRcdFx0XHRmdW5jID0gJ3JlbW92ZUNsYXNzJztcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAnc3RhcnQnOlxuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdGZ1bmMgPSAnYWRkQ2xhc3MnO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLiRjaGVja291dF9mb3JtWyBmdW5jIF0oICdsbG1zLWlzLXByb2Nlc3NpbmcnICk7XG5cdFx0XHRMTE1TLlNwaW5uZXJbIGFjdGlvbiBdKCB0aGlzLiRjaGVja291dF9zZWN0aW9ucyApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEhhbmRsZXMgZm9ybSBzdWJtaXNzaW9uXG5cdFx0ICogQ2FsbHMgYWxsIHZhbGlkYXRpb24gZXZlbnRzIGluIGBiZWZvcmVfc3VibWl0W11gXG5cdFx0ICogd2FpdHMgZm9yIGNhbGwgYmFja3MgYW5kIGVpdGhlciBkaXNwbGF5cyByZXR1cm5lZCBlcnJvcnNcblx0XHQgKiBvciBzdWJtaXRzIHRoZSBmb3JtIHdoZW4gYWxsIGFyZSBzdWNjZXNmdWxcblx0XHQgKiBAcGFyYW0gICAgb2JqICAgZSAgSlMgZXZlbnQgb2JqZWN0XG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLnN1Ym1pdCA9IGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IGUuZGF0YSxcblx0XHRcdFx0bnVtID0gYmVmb3JlX3N1Ym1pdC5sZW5ndGgsXG5cdFx0XHRcdGNoZWNrcyA9IDAsXG5cdFx0XHRcdG1heF9jaGVja3MgPSA2MDAwMCxcblx0XHRcdFx0ZXJyb3JzID0gW10sXG5cdFx0XHRcdGZpbmlzaGVzID0gMCxcblx0XHRcdFx0c3VjY2Vzc2VzID0gMCxcblx0XHRcdFx0aW50ZXJ2YWw7XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0Ly8gYWRkIHNwaW5uZXJzXG5cdFx0XHRzZWxmLnByb2Nlc3NpbmcoICdzdGFydCcgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGVycm9ycyB0byBwcmV2ZW50IGR1cGxpY2F0ZXNcblx0XHRcdCQoICcjbGxtcy1jaGVja291dC1lcnJvcnMnICkucmVtb3ZlKCk7XG5cblx0XHRcdC8vIHN0YXJ0IHJ1bm5pbmcgYWxsIHRoZSBldmVudHNcblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGJlZm9yZV9zdWJtaXQubGVuZ3RoOyBpKysgKSB7XG5cblx0XHRcdFx0dmFyIG9iaiA9IGJlZm9yZV9zdWJtaXRbIGkgXTtcblxuXHRcdFx0XHRvYmouaGFuZGxlciggb2JqLmRhdGEsIGZ1bmN0aW9uKCByICkge1xuXG5cdFx0XHRcdFx0ZmluaXNoZXMrKztcblx0XHRcdFx0XHRpZiAoIHRydWUgPT09IHIgKSB7XG5cdFx0XHRcdFx0XHRzdWNjZXNzZXMrKztcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCAnc3RyaW5nJyA9PT0gdHlwZW9mIHIgKSB7XG5cdFx0XHRcdFx0XHRlcnJvcnMucHVzaCggciApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gcnVuIGFuIGludGVydmFsIHRvIHdhaXQgZm9yIGZpbmlzaGVzXG5cdFx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHR2YXIgY2xlYXIgPSBmYWxzZSxcblx0XHRcdFx0XHRzdG9wID0gZmFsc2U7XG5cblx0XHRcdFx0Ly8gdGltZW91dC4uLlxuXHRcdFx0XHRpZiAoIGNoZWNrcyA+PSBtYXhfY2hlY2tzICkge1xuXG5cdFx0XHRcdFx0Y2xlYXIgPSB0cnVlO1xuXHRcdFx0XHRcdHN0b3AgPSB0cnVlO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gZXZlcnl0aGluZyBoYXMgZmluaXNoZWRcblx0XHRcdFx0ZWxzZSBpZiAoIG51bSA9PT0gZmluaXNoZXMgKSB7XG5cblx0XHRcdFx0XHQvLyBhbGwgd2VyZSBzdWNjZXNmdWwsIHN1Ym1pdCB0aGUgZm9ybVxuXHRcdFx0XHRcdGlmICggbnVtID09PSBzdWNjZXNzZXMgKSB7XG5cblx0XHRcdFx0XHRcdGNsZWFyID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0c2VsZi4kY2hlY2tvdXRfZm9ybS5vZmYoICdzdWJtaXQnLCBzZWxmLnN1Ym1pdCApO1xuXHRcdFx0XHRcdFx0c2VsZi4kY2hlY2tvdXRfZm9ybS50cmlnZ2VyKCAnc3VibWl0JyApO1xuXG5cdFx0XHRcdFx0fSBlbHNlIGlmICggZXJyb3JzLmxlbmd0aCApIHtcblxuXHRcdFx0XHRcdFx0Y2xlYXIgPSB0cnVlO1xuXHRcdFx0XHRcdFx0c3RvcCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdHZhciAkZXJyID0gJCggJzx1bCBjbGFzcz1cImxsbXMtbm90aWNlIGxsbXMtZXJyb3JcIiBpZD1cImxsbXMtY2hlY2tvdXQtZXJyb3JzXCIgLz4nKVxuXG5cdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBlcnJvcnMubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdFx0XHRcdCRlcnIuYXBwZW5kKCAnPGxpPicgKyBlcnJvcnNbaV0gKyAnPC9saT4nICk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1jaGVja291dC13cmFwcGVyJyApLnByZXBlbmQoICRlcnIgKTtcblx0XHRcdFx0XHRcdCQoICdodG1sLCBib2R5JyApLmFuaW1hdGUoIHtcblx0XHRcdFx0XHRcdFx0c2Nyb2xsVG9wOiAkZXJyLm9mZnNldCgpLnRvcCAtIDUwLFxuXHRcdFx0XHRcdFx0fSwgMjAwICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggY2xlYXIgKSB7XG5cdFx0XHRcdFx0Y2xlYXJJbnRlcnZhbCggaW50ZXJ2YWwgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggc3RvcCApIHtcblx0XHRcdFx0XHRzZWxmLnByb2Nlc3NpbmcoICdzdG9wJyApO1xuXHRcdFx0XHR9XG5cblxuXHRcdFx0XHRjaGVja3MrKztcblxuXHRcdFx0fSwgMTAwICk7XG5cblx0XHR9O1xuXG5cdFx0Ly8gaW5pdGFsaXplXG5cdFx0dGhpcy5pbml0KCk7XG5cblx0XHRyZXR1cm4gdGhpcztcblxuXHR9O1xuXG5cdHdpbmRvdy5sbG1zID0gd2luZG93LmxsbXMgfHwge307XG5cdHdpbmRvdy5sbG1zLmNoZWNrb3V0ID0gbmV3IGxsbXNfY2hlY2tvdXQoKTtcblxufSApKCBqUXVlcnkgKTtcbiJdfQ==
