!function(i){window.llms=window.llms||{},window.llms.checkout=function(){return this.init=function(){this.bind(),this.bind_coupon(),this.bind_pricing(),this.set_price(),i(".llms-payment-methods input[type=radio]:checked").change(),this.init_user_fields()},this.bind=function(){var t=this;i("#llms_country_options").chosen({width:"100%"}),i(".llms-toggle").on("click",function(e){e.preventDefault(),t.toggle_user_fields(i(this))}),i(document).on("llms-payment-method-change",function(t,e){"creditcard"===e.type?i(".llms-creditcard-fields").slideDown(400):i(".llms-creditcard-fields").slideUp(400)})},this.bind_coupon=function(){var t=this;i(".llms-coupon-toggle-button").on("click",function(t){t.preventDefault();var e=i(this),n=e.closest(".llms-coupon-entry");$input=i("#llms-coupon-code"),n.toggleClass("active"),$input.attr("disabled")?$input.removeAttr("disabled"):$input.attr("disabled",!0)}),i("#llms-apply-coupon").on("click",function(e){e.preventDefault(),t.coupon_apply(i(this))}),i("#llms-remove-coupon").on("click",function(e){e.preventDefault(),t.coupon_remove(i(this))})},this.bind_pricing=function(){var t=this;i(".llms-payment-options input[type=radio]").on("change",function(){t.set_price()}),i(".llms-payment-methods input[type=radio]").on("change",function(){var t=i(this);i(document).trigger("llms-payment-method-change",{gateway:t.val()})}),i(".llms-payment-options input[type=radio]:checked").trigger("change")},this.coupon_apply=function(t){var e=this,n=i("#llms-coupon-code"),s=n.val(),l=i(".llms-coupon-notice"),o=l.find(".llms-error"),c=i(".llms-coupon-entry");LLMS.Spinner.start(c),window.LLMS.Ajax.call({data:{action:"validate_coupon_code",code:s,product_id:i("#llms-product-id").val()},beforeSend:function(){o.hide()},success:function(t){if(LLMS.Spinner.stop(c),"error"===t.code){var n=i("<li>"+t.message+"</li>");o.length?o.empty():(o=i('<ul class="llms-error" />'),l.append(o)),n.appendTo(o),o.show()}else t.success&&(i("#llms-coupon-form").replaceWith(t.data.coupon_html),e.bind_coupon(),i("#llms-payment-options").replaceWith(t.data.pricing_html),e.bind_pricing())}})},this.coupon_remove=function(t){var e=this,n=i(".llms-coupon-entry");LLMS.Spinner.start(n),window.LLMS.Ajax.call({data:{action:"remove_coupon_code",product_id:i("#llms-product-id").val()},success:function(t){LLMS.Spinner.stop(n),t.success&&(i("#llms-coupon-form").replaceWith(t.data.coupon_html),e.bind_coupon(),i("#llms-payment-options").replaceWith(t.data.pricing_html),e.bind_pricing())}})},this.hide_user_fields=function(i){i.removeClass("active").find("input","select","textarea").attr("disabled",!0)},this.init_user_fields=function(){var t=this;i(".llms-user-fields").each(function(){var e=i(this);e.hasClass("active")?t.show_user_fields(e):t.hide_user_fields(e)})},this.show_user_fields=function(i){i.addClass("active").find("input","select","textarea").removeAttr("disabled")},this.toggle_user_fields=function(t){var e=t.closest(".llms-user-fields").attr("id"),n=i("#"+e),s=i("llms-login-fields"===e?"#llms-register-fields":"#llms-login-fields");this.hide_user_fields(n),this.show_user_fields(s)},this.set_price=function(){var t=i(".llms-payment-options input[type=radio]:checked"),e=t.parent().find("label").html();i(".llms-final-price").html(e)},this.init(),this};new window.llms.checkout}(jQuery);