!function(a){window.llms=window.llms||{},window.llms.metabox_product=function(){this.init=function(){this.bind()},this.bind=function(){var e=this;a("#llms-access-plans").on("change","[data-controller-id]",function(){e.controller_change(a(this))}),a("#llms-access-plans .llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),a("#llms-access-plans [data-controller-id]").trigger("change"),a("#llms-new-access-plan").on("click",function(){e.init_plan()}),a("#llms-access-plans").sortable({handle:".llms-drag-handle",items:".llms-access-plan",start:function(e,l){a("#llms-access-plans").addClass("dragging")},stop:function(l,s){a("#llms-access-plans").removeClass("dragging"),e.update_plan_orders()}}),a("#llms-access-plans").on("keyup","input.llms-plan-title",function(){var e=a(this),l=e.closest(".llms-access-plan"),s=l.find("span.llms-plan-title"),t=e.val(),n=t?t:s.attr("data-default");s.text(n)}),a("#llms-access-plans").on("click",".llms-plan-delete",function(l){l.stopPropagation(),e.delete_plan(a(this))})},this.init_plan=function(){var e=a("#llms-new-access-plan-model").clone();$existing_plans=a("#llms-access-plans .llms-access-plan"),e.removeAttr("id"),e.find("select, input, textarea").each(function(){a(this).removeAttr("disabled")}),e.find("[data-controller-id]").trigger("change"),e.find(".llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),e.appendTo("#llms-access-plans"),this.update_plan_orders(),e.find(".llms-collapsible-header").trigger("click")},this.controller_change=function(e){var l=e.attr("data-controller-id"),s=e.val(),t=e.closest(".llms-access-plan"),n=t.find('[data-controller="'+l+'"]');n.each(function(){var e,l,t=a(this),n="SELECT"===t[0].nodeName||"INPUT"===t[0].nodeName||"TEXTAREA"===t[0].nodeName?t:t.find("input, select, textarea"),i=t.attr("data-value-is"),c=t.attr("data-value-is-not");switch("undefined"!=typeof i&&i!==!1?l="==":"undefined"!=typeof c&&c!==!1&&(l="!="),l){case"==":e=s==i?"show":"hide";break;case"!=":e=s!=c?"show":"hide"}"show"===e?(t.show(),n.removeAttr("disabled").trigger("change")):"hide"===e&&(t.hide(),n.attr("disabled","disabled"))})},this.delete_plan=function(a){var e=a.closest(".llms-access-plan"),l=e.attr("data-id");l?confirm():(e.fadeOut(400),setTimeout(function(){e.remove()},450))},this.update_plan_orders=function(){a("#llms-access-plans .llms-access-plan").each(function(){var e=a(this),l=e.find(".plan-order"),s=1*l.val(),t=e.index();e.find("select, input, textarea").each(function(){var e=a(this).attr("name");a(this).attr("name",e.replace(s,t))}),l.val(t)})},this.init()};new window.llms.metabox_product}(jQuery);