!function(c){window.llms=window.llms||{},window.llms.metabox_product=function(){this.$plans=null,this.$save=null,this.temp_id=Math.floor(7777*Math.random()+777),this.validation_class="llms-invalid",this.init=function(e){var t=this;t.$plans=c("#llms-access-plans"),t.$save=c("#llms-save-access-plans"),t.bind_visibility();var a=c("#lifterlms-product #llms-product-options-access-plans");if(a.length)if(e)t.bind();else{LLMS.Spinner.start(a);var l,s=0;l=setInterval(function(){if(300<=s)a.html(LLMS.l10n.translate("There was an error loading the necessary resources. Please try again."));else{if("undefined"==typeof tinyMCE)return void s++;t.bind()}clearInterval(l),LLMS.Spinner.stop(a)},100)}},this.bind=function(){var s=this;(setTimeout(function(){s.has_plan_limit_been_reached()&&s.toggle_create_button("disable")},500),0===s.get_current_plan_count()&&s.toggle_save_button("disable"),s.$save.on("click",function(e){e.preventDefault(),s.save_plans()}),s.$plans.on("change","[data-controller-id]",function(){s.controller_change(c(this))}),c("#llms-access-plans .llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),c("#llms-access-plans [data-controller-id]").trigger("change"),c("#llms-new-access-plan").on("click",function(){s.init_plan(),s.toggle_create_button("disable"),s.toggle_save_button("enable"),setTimeout(function(){s.has_plan_limit_been_reached()||s.toggle_create_button("enable")},500)}),s.$plans.sortable({handle:".llms-drag-handle",items:".llms-access-plan",start:function(e,t){s.$plans.addClass("dragging")},stop:function(e,t){s.$plans.removeClass("dragging"),s.update_plan_orders()}}),s.$plans.on("keyup","input.llms-plan-title",function(){var e=c(this),t=e.closest(".llms-access-plan").find("span.llms-plan-title"),a=e.val(),l=a||t.attr("data-default");t.text(l)}),s.$plans.on("focusin","input",function(e,t){c(this).addClass("llms-has-been-focused")}),s.$plans.on("keyup focusout llms-validate-plan-field","input",function(e,t){var a=c(this);a[0].checkValidity()?a.removeClass(s.validation_class):(a.addClass(s.validation_class),"keyup"===e.type&&a[0].reportValidity()),t&&!t.cascade||a.closest(".llms-access-plan").trigger("llms-validate-plan",{original_event:e.type})}),s.$plans.on("llms-validate-plan",".llms-access-plan",function(e,t){t=t||{};var a=c(this),l=t.original_event?"input.llms-has-been-focused":"input";a.find(l).each(function(){c(this).trigger("llms-validate-plan-field",{cascade:!1})}),a.find("."+s.validation_class).length?a.addClass(s.validation_class):a.removeClass(s.validation_class)}),s.$plans.on("llms-collapsible-toggled",".llms-access-plan",function(){var e=c(this);e.hasClass("opened")&&setTimeout(function(){e.find("input.llms-invalid").each(function(){c(this)[0].reportValidity()})},500)}),s.$plans.on("click",".llms-plan-delete",function(e){e.stopPropagation(),s.delete_plan(c(this))}),window.llms.metaboxes.post_select(c("#llms-access-plans .llms-availability-restrictions")),c("#_llms_plans_content_llms-new-access-plan-model").attr("disabled","disabled"),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,"_llms_plans_content_llms-new-access-plan-model"),wp.data)||c("form#post").on("submit",function(e){s.get_current_plan_count()&&(e.preventDefault(),s.$save.trigger("click"))})},this.bind_visibility=function(){var t=c("#llms-catalog-visibility-select"),a=c("a.llms-edit-catalog-visibility"),e=c("a.llms-save-catalog-visibility"),l=c("a.llms-cancel-catalog-visibility");a.on("click",function(e){e.preventDefault(),t.slideDown("fast"),a.hide()}),e.on("click",function(e){e.preventDefault(),t.slideUp("fast"),a.show(),c("#llms-catalog-visibility-display").text(c('input[name="_llms_visibility"]:checked').attr("data-label"))}),l.on("click",function(e){e.preventDefault(),t.slideUp("fast"),a.show()})},this.delete_plan=function(e){var t=this,a=e.closest(".llms-access-plan"),l=a.attr("data-id"),s=LLMS.l10n.translate("After deleting this access plan, any students subscribed to this plan will still have access and will continue to make recurring payments according to the access plan's settings. If you wish to terminate their plans you must do so manually. This action cannot be reversed.");l?window.confirm(s)&&(LLMS.Spinner.start(a),window.LLMS.Ajax.call({data:{action:"delete_access_plan",plan_id:l},success:function(e){LLMS.Spinner.stop(a),e.success?(t.remove_plan_el(a),t.trigger_update_hook()):e.message&&alert(e.message)}})):t.remove_plan_el(a)},this.controller_change=function(e){var t=e.attr("data-controller-id"),i=e.val(),a=e.closest(".llms-access-plan").find('[data-controller="'+t+'"]');"checkbox"===e.attr("type")&&(i=e.is(":checked")?i:"no"),a.each(function(){var e,t,a=c(this),l="SELECT"===a[0].nodeName||"INPUT"===a[0].nodeName||"TEXTAREA"===a[0].nodeName?a:a.find("input, select, textarea"),s=a.attr("data-value-is"),n=a.attr("data-value-is-not");switch(void 0!==s&&!1!==s?t="==":void 0!==n&&!1!==n&&(t="!="),t){case"==":e=i==s?"show":"hide";break;case"!=":e=i!=n?"show":"hide"}"show"===e?(a.show(),l.removeAttr("disabled").trigger("change")):"hide"===e&&(a.hide(),l.attr("disabled","disabled"))})},this.get_current_plan_count=function(){return this.$plans.find(".llms-access-plan").length},this.get_plans_array=function(){tinyMCE.triggerSave();for(var e=this.$plans.closest("form").serializeArray(),t=[],a=0;a<e.length;a++)if(-1!==e[a].name.indexOf("_llms_plans")){var l=e[a].name.replace("_llms_plans[","").split("]["),s=1*l[0]-1,n=l[1].replace("]",""),i=3===l.length?"array":"single";t[s]||(t[s]={}),"array"===i?(t[s][n]||(t[s][n]=[]),t[s][n].push(e[a].value)):t[s][n]=e[a].value}return t},this.has_plan_limit_been_reached=function(){var e=window.llms.product.access_plan_limit;return this.get_current_plan_count()>=e},this.init_plan=function(){if(!this.has_plan_limit_been_reached()){var e=c("#llms-new-access-plan-model").clone();$existing_plans=c("#llms-access-plans .llms-access-plan"),$editor=e.find("#_llms_plans_content_llms-new-access-plan-model"),e.removeAttr("id"),$editor.removeAttr("id").attr("id","_llms_plans_content_"+this.temp_id),this.temp_id++,e.find("select, input, textarea").each(function(){c(this).removeAttr("disabled")}),e.find(".llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),e.appendTo("#llms-access-plans"),this.update_plan_orders(),e.find(".llms-collapsible-header").trigger("click"),this.has_plan_limit_been_reached()&&this.toggle_create_button("disable"),window.llms.metaboxes.post_select(e.find(".llms-availability-restrictions")),e.find("[data-controller-id]").trigger("change"),c(document).trigger("llms-plan-init",e)}},this.save_plans=function(){var t=this;if(t.$plans.find(".llms-access-plan").each(function(){c(this).trigger("llms-validate-plan")}),t.$plans.find("."+t.validation_class).length)return t.$plans.find(".llms-access-plan."+t.validation_class).not(".opened").first().find(".llms-collapsible-header").trigger("click"),void c(document).trigger("llms-access-plan-validation-errors");LLMS.Spinner.start(t.$plans),t.$save.attr("disabled","disabled"),window.LLMS.Ajax.call({data:{action:"llms_update_access_plans",plans:t.get_plans_array()},complete:function(){LLMS.Spinner.stop(t.$plans),t.$save.removeAttr("disabled")},error:function(e,t,a){console.error("llms access plan save error encounterd:",e),alert(LLMS.l10n.translate("An error was encounterd during the save attempt. Please try again.")+" ["+t+": "+a+"]")},success:function(e){!e.success&&e.code&&"error"===e.code?alert(e.message):e.data&&e.data.html&&(c("#llms-product-options-access-plans").replaceWith(e.data.html),t.init(!0),window.llms.metaboxes.init(),t.update_plan_orders(),t.trigger_update_hook())}})},this.toggle_button=function(e,t){"disable"===t?e.attr("disabled","disabled"):e.removeAttr("disabled")},this.toggle_create_button=function(e){this.toggle_button(c("#llms-new-access-plan"),e)},this.toggle_save_button=function(e){this.toggle_button(this.$save,e)},this.remove_plan_el=function(e){var t=this;e.fadeOut(400),setTimeout(function(){e.remove(),t.has_plan_limit_been_reached()||t.toggle_create_button("enable"),0===t.get_current_plan_count()&&t.toggle_save_button("disable")},450)},this.trigger_update_hook=function(){c(document).trigger("llms-access-plans-updated")},this.update_plan_orders=function(){c("#llms-access-plans .llms-access-plan").each(function(){var e=c(this),t=e.find(".plan-order"),a=e.find('textarea[id^="_llms_plans_content_"]').attr("id"),l=1*t.val(),s=e.index();tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,a),e.find("select, input, textarea").each(function(){var e=c(this).attr("name");e&&c(this).attr("name",e.replace(l,s))}),tinyMCE.EditorManager.execCommand("mceAddEditor",!0,a),t.val(s)})},this.init()};new window.llms.metabox_product}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtbWV0YWJveC1wcm9kdWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJsbG1zIiwibWV0YWJveF9wcm9kdWN0IiwidGhpcyIsIiRwbGFucyIsIiRzYXZlIiwidGVtcF9pZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInZhbGlkYXRpb25fY2xhc3MiLCJpbml0Iiwic2tpcF9kZXBfY2hlY2tzIiwic2VsZiIsImJpbmRfdmlzaWJpbGl0eSIsIiRtYiIsImxlbmd0aCIsImJpbmQiLCJMTE1TIiwiU3Bpbm5lciIsInN0YXJ0IiwiaW50ZXJ2YWwiLCJjb3VudGVyIiwic2V0SW50ZXJ2YWwiLCJodG1sIiwibDEwbiIsInRyYW5zbGF0ZSIsInRpbnlNQ0UiLCJjbGVhckludGVydmFsIiwic3RvcCIsInNldFRpbWVvdXQiLCJoYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQiLCJ0b2dnbGVfY3JlYXRlX2J1dHRvbiIsImdldF9jdXJyZW50X3BsYW5fY291bnQiLCJ0b2dnbGVfc2F2ZV9idXR0b24iLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInNhdmVfcGxhbnMiLCJjb250cm9sbGVyX2NoYW5nZSIsImRhdGVwaWNrZXIiLCJkYXRlRm9ybWF0IiwidHJpZ2dlciIsImluaXRfcGxhbiIsInNvcnRhYmxlIiwiaGFuZGxlIiwiaXRlbXMiLCJldmVudCIsInVpIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInVwZGF0ZV9wbGFuX29yZGVycyIsIiRpbnB1dCIsIiRkaXNwbGF5IiwiY2xvc2VzdCIsImZpbmQiLCJ2YWwiLCJ0aXRsZSIsImF0dHIiLCJ0ZXh0IiwiZGF0YSIsImNoZWNrVmFsaWRpdHkiLCJ0eXBlIiwicmVwb3J0VmFsaWRpdHkiLCJjYXNjYWRlIiwib3JpZ2luYWxfZXZlbnQiLCIkcGxhbiIsInNlbGVjdG9yIiwiZWFjaCIsImhhc0NsYXNzIiwic3RvcFByb3BhZ2F0aW9uIiwiZGVsZXRlX3BsYW4iLCJtZXRhYm94ZXMiLCJwb3N0X3NlbGVjdCIsIkVkaXRvck1hbmFnZXIiLCJleGVjQ29tbWFuZCIsIndwIiwiJHJhZGlvcyIsIiR0b2dnbGUiLCIkY2FuY2VsIiwic2xpZGVEb3duIiwiaGlkZSIsInNsaWRlVXAiLCJzaG93IiwiJGJ0biIsInBsYW5faWQiLCJ3YXJuaW5nIiwiY29uZmlybSIsIkFqYXgiLCJjYWxsIiwiYWN0aW9uIiwic3VjY2VzcyIsInIiLCJyZW1vdmVfcGxhbl9lbCIsInRyaWdnZXJfdXBkYXRlX2hvb2siLCJtZXNzYWdlIiwiYWxlcnQiLCIkZWwiLCJpZCIsIiRjb250cm9scyIsImlzIiwib3BlcmF0b3IiLCIkYyIsIiRlbHMiLCJub2RlTmFtZSIsImVxdWFscyIsIm5vdF9lcXVhbHMiLCJyZW1vdmVBdHRyIiwiZ2V0X3BsYW5zX2FycmF5IiwidHJpZ2dlclNhdmUiLCJmb3JtIiwic2VyaWFsaXplQXJyYXkiLCJwbGFucyIsImkiLCJuYW1lIiwiaW5kZXhPZiIsImtleXMiLCJyZXBsYWNlIiwic3BsaXQiLCJpbmRleCIsInB1c2giLCJ2YWx1ZSIsImxpbWl0IiwicHJvZHVjdCIsImFjY2Vzc19wbGFuX2xpbWl0IiwiJGNsb25lIiwiY2xvbmUiLCIkZXhpc3RpbmdfcGxhbnMiLCIkZWRpdG9yIiwiYXBwZW5kVG8iLCJkb2N1bWVudCIsIm5vdCIsImZpcnN0IiwiY29tcGxldGUiLCJlcnJvciIsImpxWEhSIiwidGV4dFN0YXR1cyIsImVycm9yVGhyb3duIiwiY29uc29sZSIsInJlcyIsImNvZGUiLCJyZXBsYWNlV2l0aCIsInRvZ2dsZV9idXR0b24iLCJzdGF0dXMiLCJmYWRlT3V0IiwicmVtb3ZlIiwiJHAiLCIkb3JkZXIiLCJlZGl0b3JfaWQiLCJvcmlnIiwiY3VyciIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBTUEsU0FBWUEsR0FFWEMsT0FBT0MsS0FBT0QsT0FBT0MsTUFBUSxHQUU3QkQsT0FBT0MsS0FBS0MsZ0JBQWtCLFdBTTdCQyxLQUFLQyxPQUFTLEtBTWRELEtBQUtFLE1BQVEsS0FPYkYsS0FBS0csUUFBVUMsS0FBS0MsTUFBeUIsS0FBaEJELEtBQUtFLFNBQW9CLEtBTXRETixLQUFLTyxpQkFBbUIsZUFVeEJQLEtBQUtRLEtBQU8sU0FBVUMsR0FFckIsSUFBSUMsRUFBT1YsS0FFWFUsRUFBS1QsT0FBU0wsRUFBRyxzQkFDakJjLEVBQUtSLE1BQVFOLEVBQUcsMkJBRWhCYyxFQUFLQyxrQkFFTCxJQUFJQyxFQUFNaEIsRUFBRyx5REFFYixHQUFPZ0IsRUFBSUMsT0FFSixHQUFLSixFQUNYQyxFQUFLSSxXQURDLENBS1BDLEtBQUtDLFFBQVFDLE1BQU9MLEdBSXBCLElBQ0NNLEVBREdDLEVBQVUsRUFHZEQsRUFBV0UsWUFBYSxXQUd2QixHQUFnQixLQUFYRCxFQUVKUCxFQUFJUyxLQUFNTixLQUFLTyxLQUFLQyxVQUFXLDhFQUkzQixDQUFBLEdBQUssb0JBQXVCQyxRQUdoQyxZQURBTCxJQU9BVCxFQUFLSSxPQUlOVyxjQUFlUCxHQUNmSCxLQUFLQyxRQUFRVSxLQUFNZCxJQUVqQixPQVlKWixLQUFLYyxLQUFPLFdBRVgsSUFBSUosRUFBT1YsTUFFWDJCLFdBQVksV0FDTmpCLEVBQUtrQiwrQkFDVGxCLEVBQUttQixxQkFBc0IsWUFFMUIsS0FFRSxJQUFNbkIsRUFBS29CLDBCQUNmcEIsRUFBS3FCLG1CQUFvQixXQUkxQnJCLEVBQUtSLE1BQU04QixHQUFJLFFBQVMsU0FBVUMsR0FDakNBLEVBQUVDLGlCQUNGeEIsRUFBS3lCLGVBSU56QixFQUFLVCxPQUFPK0IsR0FBSSxTQUFVLHVCQUF3QixXQUNqRHRCLEVBQUswQixrQkFBbUJ4QyxFQUFHSSxTQUc1QkosRUFBRyxtREFBb0R5QyxXQUFZLENBQ2xFQyxXQUFZLGFBSWIxQyxFQUFHLDJDQUE0QzJDLFFBQVMsVUFHeEQzQyxFQUFHLHlCQUEwQm9DLEdBQUksUUFBUyxXQUN6Q3RCLEVBQUs4QixZQUNMOUIsRUFBS21CLHFCQUFzQixXQUMzQm5CLEVBQUtxQixtQkFBb0IsVUFDekJKLFdBQVksV0FDSmpCLEVBQUtrQiwrQkFDWGxCLEVBQUttQixxQkFBc0IsV0FFMUIsT0FHSm5CLEVBQUtULE9BQU93QyxTQUFVLENBQ3JCQyxPQUFRLG9CQUNSQyxNQUFPLG9CQUNQMUIsTUFBTyxTQUFVMkIsRUFBT0MsR0FDdkJuQyxFQUFLVCxPQUFPNkMsU0FBVSxhQUV2QnBCLEtBQU0sU0FBVWtCLEVBQU9DLEdBQ3RCbkMsRUFBS1QsT0FBTzhDLFlBQWEsWUFDekJyQyxFQUFLc0Msd0JBS1B0QyxFQUFLVCxPQUFPK0IsR0FBSSxRQUFTLHdCQUF5QixXQUVqRCxJQUFJaUIsRUFBU3JELEVBQUdJLE1BRWZrRCxFQURRRCxFQUFPRSxRQUFTLHFCQUNQQyxLQUFNLHdCQUN2QkMsRUFBTUosRUFBT0ksTUFDYkMsRUFBUSxHQUFnQkosRUFBU0ssS0FBTSxnQkFFeENMLEVBQVNNLEtBQU1GLEtBS2hCNUMsRUFBS1QsT0FBTytCLEdBQUksVUFBVyxRQUFTLFNBQVVDLEVBQUd3QixHQUNoRDdELEVBQUdJLE1BQU84QyxTQUFVLDJCQUlyQnBDLEVBQUtULE9BQU8rQixHQUFJLDBDQUEyQyxRQUFTLFNBQVVDLEVBQUd3QixHQUVoRixJQUFJUixFQUFTckQsRUFBR0ksTUFFWGlELEVBQU8sR0FBR1MsZ0JBQ2RULEVBQU9GLFlBQWFyQyxFQUFLSCxtQkFFekIwQyxFQUFPSCxTQUFVcEMsRUFBS0gsa0JBQ2pCLFVBQVkwQixFQUFFMEIsTUFDbEJWLEVBQU8sR0FBR1csa0JBSUxILElBQVFBLEVBQUtJLFNBQ25CWixFQUFPRSxRQUFTLHFCQUFzQlosUUFBUyxxQkFBc0IsQ0FBRXVCLGVBQWdCN0IsRUFBRTBCLFNBTTNGakQsRUFBS1QsT0FBTytCLEdBQUkscUJBQXNCLG9CQUFxQixTQUFVQyxFQUFHd0IsR0FFdkVBLEVBQU9BLEdBQVEsR0FFZixJQUFJTSxFQUFRbkUsRUFBR0ksTUFFZGdFLEVBQVdQLEVBQUtLLGVBQWlCLDhCQUFnQyxRQUVsRUMsRUFBTVgsS0FBTVksR0FBV0MsS0FBTSxXQUM1QnJFLEVBQUdJLE1BQU91QyxRQUFTLDJCQUE0QixDQUFFc0IsU0FBUyxNQUd0REUsRUFBTVgsS0FBTSxJQUFNMUMsRUFBS0gsa0JBQW1CTSxPQUM5Q2tELEVBQU1qQixTQUFVcEMsRUFBS0gsa0JBRXJCd0QsRUFBTWhCLFlBQWFyQyxFQUFLSCxvQkFLMUJHLEVBQUtULE9BQU8rQixHQUFJLDJCQUE0QixvQkFBcUIsV0FFaEUsSUFBSStCLEVBQVFuRSxFQUFHSSxNQUVWK0QsRUFBTUcsU0FBVSxXQUVwQnZDLFdBQVksV0FDWG9DLEVBQU1YLEtBQU0sc0JBQXVCYSxLQUFNLFdBQ3hDckUsRUFBR0ksTUFBTyxHQUFHNEQsb0JBRVosT0FLTGxELEVBQUtULE9BQU8rQixHQUFJLFFBQVMsb0JBQXFCLFNBQVVDLEdBQ3ZEQSxFQUFFa0Msa0JBQ0Z6RCxFQUFLMEQsWUFBYXhFLEVBQUdJLFNBSXRCSCxPQUFPQyxLQUFLdUUsVUFBVUMsWUFBYTFFLEVBQUcsdURBSXRDQSxFQUFHLG1EQUFvRDJELEtBQU0sV0FBWSxZQUN6RS9CLFFBQVErQyxjQUFjQyxZQUFhLG1CQUFtQixFQUFNLGtEQUdyREMsR0FBR2hCLE9BR1U3RCxFQUFHLGFBQ1RvQyxHQUFJLFNBQVUsU0FBVUMsR0FDL0J2QixFQUFLb0IsMkJBQ1RHLEVBQUVDLGlCQUNGeEIsRUFBS1IsTUFBTXFDLFFBQVMsYUFjeEJ2QyxLQUFLVyxnQkFBa0IsV0FFdEIsSUFBSStELEVBQVU5RSxFQUFHLG1DQUNoQitFLEVBQVUvRSxFQUFHLGtDQUNiTSxFQUFRTixFQUFHLGtDQUNYZ0YsRUFBV2hGLEVBQUcsb0NBRWYrRSxFQUFRM0MsR0FBSSxRQUFTLFNBQVVDLEdBQzlCQSxFQUFFQyxpQkFDRndDLEVBQVFHLFVBQVcsUUFDbkJGLEVBQVFHLFNBR1Q1RSxFQUFNOEIsR0FBSSxRQUFTLFNBQVVDLEdBQzVCQSxFQUFFQyxpQkFDRndDLEVBQVFLLFFBQVMsUUFDakJKLEVBQVFLLE9BQ1JwRixFQUFHLG9DQUFxQzRELEtBQU01RCxFQUFHLDBDQUEyQzJELEtBQU0saUJBR25HcUIsRUFBUTVDLEdBQUksUUFBUyxTQUFVQyxHQUM5QkEsRUFBRUMsaUJBQ0Z3QyxFQUFRSyxRQUFTLFFBQ2pCSixFQUFRSyxVQWlCVmhGLEtBQUtvRSxZQUFjLFNBQVVhLEdBRTVCLElBQUl2RSxFQUFPVixLQUNWK0QsRUFBUWtCLEVBQUs5QixRQUFTLHFCQUN0QitCLEVBQVVuQixFQUFNUixLQUFNLFdBQ3RCNEIsRUFBVXBFLEtBQUtPLEtBQUtDLFVBQVcsb1JBR3pCMkQsRUFLS3JGLE9BQU91RixRQUFTRCxLQUUzQnBFLEtBQUtDLFFBQVFDLE1BQU84QyxHQUNwQmxFLE9BQU9rQixLQUFLc0UsS0FBS0MsS0FBTSxDQUN0QjdCLEtBQU0sQ0FDTDhCLE9BQVEscUJBQ1JMLFFBQVNBLEdBRVZNLFFBQVMsU0FBVUMsR0FDbEIxRSxLQUFLQyxRQUFRVSxLQUFNcUMsR0FDZDBCLEVBQUVELFNBQ045RSxFQUFLZ0YsZUFBZ0IzQixHQUNyQnJELEVBQUtpRix1QkFDTUYsRUFBRUcsU0FDYkMsTUFBT0osRUFBRUcsYUFqQlpsRixFQUFLZ0YsZUFBZ0IzQixJQW1DdkIvRCxLQUFLb0Msa0JBQW9CLFNBQVUwRCxHQUVsQyxJQUFJQyxFQUFLRCxFQUFJdkMsS0FBTSxzQkFDbEJGLEVBQU15QyxFQUFJekMsTUFFVjJDLEVBRFFGLEVBQUkzQyxRQUFTLHFCQUNIQyxLQUFNLHFCQUF1QjJDLEVBQUssTUFFaEQsYUFBZUQsRUFBSXZDLEtBQU0sVUFDN0JGLEVBQVF5QyxFQUFJRyxHQUFJLFlBQWlCNUMsRUFBTSxNQUd4QzJDLEVBQVUvQixLQUFNLFdBRWYsSUFJQ3NCLEVBQVFXLEVBSkxDLEVBQUt2RyxFQUFHSSxNQUNYb0csRUFBUyxXQUFhRCxFQUFHLEdBQUdFLFVBQVksVUFBYUYsRUFBRyxHQUFHRSxVQUFZLGFBQWdCRixFQUFHLEdBQUdFLFNBQWFGLEVBQUtBLEVBQUcvQyxLQUFNLDJCQUN4SGtELEVBQVNILEVBQUc1QyxLQUFNLGlCQUNsQmdELEVBQWFKLEVBQUc1QyxLQUFNLHFCQWF2QixZQVZ1QixJQUFYK0MsSUFBMEMsSUFBWEEsRUFFMUNKLEVBQVcsVUFFc0IsSUFBZkssSUFBa0QsSUFBZkEsSUFFckRMLEVBQVcsTUFJSEEsR0FFUixJQUFLLEtBR0hYLEVBRElsQyxHQUFPaUQsRUFDRixPQUVBLE9BR1gsTUFFQSxJQUFLLEtBR0hmLEVBRElsQyxHQUFPa0QsRUFDRixPQUVBLE9BT1AsU0FBV2hCLEdBQ2ZZLEVBQUduQixPQUNIb0IsRUFBS0ksV0FBWSxZQUFhakUsUUFBUyxXQUM1QixTQUFXZ0QsSUFDdEJZLEVBQUdyQixPQUNIc0IsRUFBSzdDLEtBQU0sV0FBWSxnQkFhMUJ2RCxLQUFLOEIsdUJBQXlCLFdBQzdCLE9BQU85QixLQUFLQyxPQUFPbUQsS0FBTSxxQkFBc0J2QyxRQVVoRGIsS0FBS3lHLGdCQUFrQixXQUd0QmpGLFFBQVFrRixjQU1SLElBSkEsSUFDQ0MsRUFEVTNHLEtBQ0VDLE9BQU9rRCxRQUFTLFFBQVN5RCxpQkFDckNDLEVBQVEsR0FFQ0MsRUFBSSxFQUFHQSxFQUFJSCxFQUFLOUYsT0FBUWlHLElBR2pDLElBQU0sSUFBTUgsRUFBTUcsR0FBSUMsS0FBS0MsUUFBUyxlQUFwQyxDQUlBLElBQUlDLEVBQU9OLEVBQU1HLEdBQUlDLEtBQUtHLFFBQVMsZUFBZ0IsSUFBS0MsTUFBTyxNQUM5REMsRUFBb0IsRUFBVkgsRUFBSyxHQUFXLEVBQzFCRixFQUFPRSxFQUFLLEdBQUdDLFFBQVMsSUFBSyxJQUM3QnZELEVBQU8sSUFBTXNELEVBQUtwRyxPQUFTLFFBQVUsU0FFL0JnRyxFQUFPTyxLQUNiUCxFQUFPTyxHQUFVLElBR2IsVUFBWXpELEdBRVRrRCxFQUFPTyxHQUFTTCxLQUN0QkYsRUFBT08sR0FBU0wsR0FBUyxJQUUxQkYsRUFBT08sR0FBU0wsR0FBT00sS0FBTVYsRUFBTUcsR0FBSVEsUUFJdkNULEVBQU9PLEdBQVNMLEdBQVNKLEVBQU1HLEdBQUlRLE1BTXJDLE9BQU9ULEdBV1I3RyxLQUFLNEIsNEJBQThCLFdBRWxDLElBQUkyRixFQUFRMUgsT0FBT0MsS0FBSzBILFFBQVFDLGtCQUNoQyxPQUFPekgsS0FBSzhCLDBCQUE0QnlGLEdBVXpDdkgsS0FBS3dDLFVBQVksV0FHaEIsSUFBS3hDLEtBQUs0Qiw4QkFBVixDQUlBLElBQUk4RixFQUFTOUgsRUFBRywrQkFBZ0MrSCxRQUMvQ0MsZ0JBQWtCaEksRUFBRyx3Q0FDckJpSSxRQUFVSCxFQUFPdEUsS0FBTSxtREFHeEJzRSxFQUFPbEIsV0FBWSxNQUduQnFCLFFBQVFyQixXQUFZLE1BQU9qRCxLQUFNLEtBQU0sdUJBQXlCdkQsS0FBS0csU0FDckVILEtBQUtHLFVBSUx1SCxFQUFPdEUsS0FBTSwyQkFBNEJhLEtBQU0sV0FDOUNyRSxFQUFHSSxNQUFPd0csV0FBWSxjQUl2QmtCLEVBQU90RSxLQUFNLGdDQUFpQ2YsV0FBWSxDQUN6REMsV0FBWSxhQUdib0YsRUFBT0ksU0FBVSxzQkFHakI5SCxLQUFLZ0QscUJBRUwwRSxFQUFPdEUsS0FBTSw0QkFBNkJiLFFBQVMsU0FHOUN2QyxLQUFLNEIsK0JBQ1Q1QixLQUFLNkIscUJBQXNCLFdBSTVCaEMsT0FBT0MsS0FBS3VFLFVBQVVDLFlBQWFvRCxFQUFPdEUsS0FBTSxvQ0FFaERzRSxFQUFPdEUsS0FBTSx3QkFBeUJiLFFBQVMsVUFDL0MzQyxFQUFHbUksVUFBV3hGLFFBQVMsaUJBQWtCbUYsS0FXMUMxSCxLQUFLbUMsV0FBYSxXQUVqQixJQUFJekIsRUFBT1YsS0FNWCxHQUpBVSxFQUFLVCxPQUFPbUQsS0FBTSxxQkFBc0JhLEtBQU0sV0FDN0NyRSxFQUFHSSxNQUFPdUMsUUFBUyx3QkFHZjdCLEVBQUtULE9BQU9tRCxLQUFNLElBQU0xQyxFQUFLSCxrQkFBbUJNLE9BR3BELE9BRkFILEVBQUtULE9BQU9tRCxLQUFNLHFCQUF1QjFDLEVBQUtILGtCQUFtQnlILElBQUssV0FBWUMsUUFBUTdFLEtBQU0sNEJBQTZCYixRQUFTLGNBQ3RJM0MsRUFBR21JLFVBQVd4RixRQUFTLHNDQUl4QnhCLEtBQUtDLFFBQVFDLE1BQU9QLEVBQUtULFFBQ3pCUyxFQUFLUixNQUFNcUQsS0FBTSxXQUFZLFlBQzdCMUQsT0FBT2tCLEtBQUtzRSxLQUFLQyxLQUFNLENBQ3RCN0IsS0FBTSxDQUNMOEIsT0FBUSwyQkFDUnNCLE1BQU9uRyxFQUFLK0YsbUJBRWJ5QixTQUFVLFdBQ1RuSCxLQUFLQyxRQUFRVSxLQUFNaEIsRUFBS1QsUUFDeEJTLEVBQUtSLE1BQU1zRyxXQUFZLGFBRXhCMkIsTUFBTyxTQUFVQyxFQUFPQyxFQUFZQyxHQUNuQ0MsUUFBUUosTUFBTywwQ0FBMkNDLEdBQzFEdkMsTUFBTzlFLEtBQUtPLEtBQUtDLFVBQVcsc0VBQXlFLEtBQVE4RyxFQUFhLEtBQU9DLEVBQWMsTUFFaEo5QyxRQUFTLFNBQVVnRCxJQUVYQSxFQUFJaEQsU0FBV2dELEVBQUlDLE1BQVEsVUFBWUQsRUFBSUMsS0FDakQ1QyxNQUFPMkMsRUFBSTVDLFNBQ0E0QyxFQUFJL0UsTUFBUStFLEVBQUkvRSxLQUFLcEMsT0FHaEN6QixFQUFHLHNDQUF1QzhJLFlBQWFGLEVBQUkvRSxLQUFLcEMsTUFHaEVYLEVBQUtGLE1BQU0sR0FDWFgsT0FBT0MsS0FBS3VFLFVBQVU3RCxPQUN0QkUsRUFBS3NDLHFCQUdMdEMsRUFBS2lGLDJCQWlCVDNGLEtBQUsySSxjQUFnQixTQUFVMUQsRUFBTTJELEdBRS9CLFlBQWNBLEVBQ2xCM0QsRUFBSzFCLEtBQU0sV0FBWSxZQUV2QjBCLEVBQUt1QixXQUFZLGFBYW5CeEcsS0FBSzZCLHFCQUF1QixTQUFVK0csR0FDckM1SSxLQUFLMkksY0FBZS9JLEVBQUcseUJBQTJCZ0osSUFXbkQ1SSxLQUFLK0IsbUJBQXFCLFNBQVU2RyxHQUNuQzVJLEtBQUsySSxjQUFlM0ksS0FBS0UsTUFBTzBJLElBYWpDNUksS0FBSzBGLGVBQWlCLFNBQVUzQixHQUUvQixJQUFJckQsRUFBT1YsS0FHWCtELEVBQU04RSxRQUFTLEtBR2ZsSCxXQUFXLFdBRVZvQyxFQUFNK0UsU0FHQ3BJLEVBQUtrQiwrQkFDWGxCLEVBQUttQixxQkFBc0IsVUFHdkIsSUFBTW5CLEVBQUtvQiwwQkFDZnBCLEVBQUtxQixtQkFBb0IsWUFHeEIsTUFXSi9CLEtBQUsyRixvQkFBc0IsV0FFMUIvRixFQUFHbUksVUFBV3hGLFFBQVMsOEJBYXhCdkMsS0FBS2dELG1CQUFxQixXQUV6QnBELEVBQUcsd0NBQXlDcUUsS0FBTSxXQUVqRCxJQUFJOEUsRUFBS25KLEVBQUdJLE1BQ1hnSixFQUFTRCxFQUFHM0YsS0FBTSxlQUVsQjZGLEVBRFVGLEVBQUczRixLQUFNLHdDQUNDRyxLQUFNLE1BQzFCMkYsRUFBc0IsRUFBZkYsRUFBTzNGLE1BQ2Q4RixFQUFPSixFQUFHM0IsUUFHWDVGLFFBQVErQyxjQUFjQyxZQUFhLG1CQUFtQixFQUFNeUUsR0FHNURGLEVBQUczRixLQUFNLDJCQUE0QmEsS0FBTSxXQUUxQyxJQUFJOEMsRUFBT25ILEVBQUdJLE1BQU91RCxLQUFNLFFBQ3RCd0QsR0FDSm5ILEVBQUdJLE1BQU91RCxLQUFNLE9BQVF3RCxFQUFLRyxRQUFTZ0MsRUFBTUMsTUFNOUMzSCxRQUFRK0MsY0FBY0MsWUFBYSxnQkFBZ0IsRUFBTXlFLEdBRXpERCxFQUFPM0YsSUFBSzhGLE1BT2RuSixLQUFLUSxRQUlFLElBQUlYLE9BQU9DLEtBQUtDLGdCQXZ1QnpCLENBeXVCS3FKIiwiZmlsZSI6ImxsbXMtbWV0YWJveC1wcm9kdWN0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvZHVjdCBPcHRpb25zIE1ldGFCb3hcbiAqIERpc3BsYXlzIG9uIENvdXJzZSAmIE1lbWJlcnNoaXAgUG9zdCBUeXBlc1xuICogQHNpbmNlICAgIDMuMC4wXG4gKiBAdmVyc2lvbiAgW3ZlcnNpb25dXG4gKi9cbiggZnVuY3Rpb24oICQgKSB7XG5cblx0d2luZG93LmxsbXMgPSB3aW5kb3cubGxtcyB8fCB7fTtcblxuXHR3aW5kb3cubGxtcy5tZXRhYm94X3Byb2R1Y3QgPSBmdW5jdGlvbigpIHtcblxuXHRcdC8qKlxuXHRcdCAqIGpRdWVyeSBvYmogZm9yIHRoZSBtYWluICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMnICkgZWxlbWVudC5cblx0XHQgKiBAdHlwZSBvYmpcblx0XHQgKi9cblx0XHR0aGlzLiRwbGFucyA9IG51bGw7XG5cblx0XHQvKipcblx0XHQgKiBqUXVlcnkgb2JqIGZvciB0aGUgbWFpbiAkKCAnI2xsbXMtc2F2ZS1hY2Nlc3MtcGxhbnMnICkgc2F2ZSBidXR0b24gZWxlbWVudC5cblx0XHQgKiBAdHlwZSBvYmpcblx0XHQgKi9cblx0XHR0aGlzLiRzYXZlID0gbnVsbDtcblxuXHRcdC8qKlxuXHRcdCAqIEEgcmFuZG9tbHkgZ2VuZXJhdGVkIHRlbXBvcmFyeSBJRCB1c2VkIGZvciB0aGUgdGlueU1DRSBlZGl0b3IncyBpZFxuXHRcdCAqIHdoZW4gYSBuZXcgcGxhbiBpcyBhZGRlZFxuXHRcdCAqIEB0eXBlIGludFxuXHRcdCAqL1xuXHRcdHRoaXMudGVtcF9pZCA9IE1hdGguZmxvb3IoICggTWF0aC5yYW5kb20oKSAqIDc3NzcgKSArIDc3NyApO1xuXG5cdFx0LyoqXG5cdFx0ICogQ1NTIGNsYXNzIG5hbWUgdXNlZCB0byBoaWdobGlnaHQgdmFsaWRhdGlvbiBlcnJvcnMgZm9yIHBsYW4gZmllbGRzXG5cdFx0ICogQHR5cGUgc3RyaW5nXG5cdFx0ICovXG5cdFx0dGhpcy52YWxpZGF0aW9uX2NsYXNzID0gJ2xsbXMtaW52YWxpZCc7XG5cblx0XHQvKipcblx0XHQgKiBJbml0aWFsaXplXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gICBib29sIHNraXBfZGVwX2NoZWNrcyBpZiB0cnVlLCBza2lwcyBkZXBlbmRlbmN5IGNoZWNrcy5cblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiBbdmVyc2lvbl1cblx0XHQgKi9cblx0XHR0aGlzLmluaXQgPSBmdW5jdGlvbiggc2tpcF9kZXBfY2hlY2tzICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdHNlbGYuJHBsYW5zID0gJCggJyNsbG1zLWFjY2Vzcy1wbGFucycgKTtcblx0XHRcdHNlbGYuJHNhdmUgPSAkKCAnI2xsbXMtc2F2ZS1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdHNlbGYuYmluZF92aXNpYmlsaXR5KCk7XG5cblx0XHRcdHZhciAkbWIgPSAkKCAnI2xpZnRlcmxtcy1wcm9kdWN0ICNsbG1zLXByb2R1Y3Qtb3B0aW9ucy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdGlmICggISAkbWIubGVuZ3RoICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2UgaWYgKCBza2lwX2RlcF9jaGVja3MgKSB7XG5cdFx0XHRcdHNlbGYuYmluZCgpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdExMTVMuU3Bpbm5lci5zdGFydCggJG1iICk7XG5cblx0XHRcdC8vIHdlIHJlbHkgb24gVGlueU1DRSBidXQgV29yZFByZXNzIGRvZXNuJ3QgcmVnaXN0ZXIgVGlueU1DRVxuXHRcdFx0Ly8gbGlrZSBldmVyeSBvdGhlciBhZG1pbiBzY3JpcHQgc28gd2UnbGwgZG8gYSBsaXR0bGUgZGVwZW5kZW5jeSBjaGVjayBoZXJlLi4uXG5cdFx0XHR2YXIgY291bnRlciA9IDAsXG5cdFx0XHRcdGludGVydmFsO1xuXG5cdFx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHQvLyBpZiB3ZSBnZXQgdG8gMzAgc2Vjb25kcyBkaXNwbGF5IGFuIGVycm9yIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKCBjb3VudGVyID49IDMwMCApIHtcblxuXHRcdFx0XHRcdCRtYi5odG1sKCBMTE1TLmwxMG4udHJhbnNsYXRlKCAnVGhlcmUgd2FzIGFuIGVycm9yIGxvYWRpbmcgdGhlIG5lY2Vzc2FyeSByZXNvdXJjZXMuIFBsZWFzZSB0cnkgYWdhaW4uJyApICk7XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBpZiB3ZSBjYW4ndCBhY2Nlc3MgdGlueU1DRSwgaW5jcmVtZW50IGFuZCB3YWl0Li4uXG5cdFx0XHRcdGVsc2UgaWYgKCAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHRpbnlNQ0UgKSB7XG5cblx0XHRcdFx0XHRjb3VudGVyKys7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gYmluZCB0aGUgZXZlbnRzLCB3ZSdyZSBnb29kIVxuXHRcdFx0XHRlbHNlIHtcblxuXHRcdFx0XHRcdHNlbGYuYmluZCgpO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjbGVhckludGVydmFsKCBpbnRlcnZhbCApO1xuXHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJG1iICk7XG5cblx0XHRcdH0sIDEwMCApO1xuXG5cdFx0fTtcblxuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBET00gRXZlbnRzXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICggc2VsZi5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQoKSApIHtcblx0XHRcdFx0XHRzZWxmLnRvZ2dsZV9jcmVhdGVfYnV0dG9uKCAnZGlzYWJsZScgKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgNTAwICk7XG5cblx0XHRcdGlmICggMCA9PT0gc2VsZi5nZXRfY3VycmVudF9wbGFuX2NvdW50KCkgKSB7XG5cdFx0XHRcdHNlbGYudG9nZ2xlX3NhdmVfYnV0dG9uKCAnZGlzYWJsZScgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gc2F2ZSBhY2Nlc3MgcGxhbnMgYnV0dG9uLlxuXHRcdFx0c2VsZi4kc2F2ZS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0c2VsZi5zYXZlX3BsYW5zKCk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIGJpbmQgY2hhbmdlIGV2ZW50cyB0byBmb3JtIGVsZW1lbnQgdGhhdCBjb250cm9scyBhbm90aGVyIGZvcm0gZWxlbWVudFxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdjaGFuZ2UnLCAnW2RhdGEtY29udHJvbGxlci1pZF0nLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0c2VsZi5jb250cm9sbGVyX2NoYW5nZSggJCggdGhpcyApICk7XG5cdFx0XHR9IClcblxuXHRcdFx0JCggJyNsbG1zLWFjY2Vzcy1wbGFucyAubGxtcy1hY2Nlc3MtcGxhbi1kYXRlcGlja2VyJyApLmRhdGVwaWNrZXIoIHtcblx0XHRcdFx0ZGF0ZUZvcm1hdDogXCJtbS9kZC95eVwiXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIHRyaWdnZXIgY2hhbmdlcyBvbiBsb2FkIGZvciBhbGwgZXhpc3RpbmcgcGxhbnNcblx0XHRcdCQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgW2RhdGEtY29udHJvbGxlci1pZF0nICkudHJpZ2dlciggJ2NoYW5nZScgKTtcblxuXHRcdFx0Ly8gYWRkIGEgbmV3IGVtcHR5IHBsYW4gaW50ZXJmYWNlIG9uIG5ldyBwbGFuIGJ1dHRvbiBjbGljay5cblx0XHRcdCQoICcjbGxtcy1uZXctYWNjZXNzLXBsYW4nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzZWxmLmluaXRfcGxhbigpO1xuXHRcdFx0XHRzZWxmLnRvZ2dsZV9jcmVhdGVfYnV0dG9uKCAnZGlzYWJsZScgKTtcblx0XHRcdFx0c2VsZi50b2dnbGVfc2F2ZV9idXR0b24oICdlbmFibGUnICk7XG5cdFx0XHRcdHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmICggISBzZWxmLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCgpICkge1xuXHRcdFx0XHRcdFx0c2VsZi50b2dnbGVfY3JlYXRlX2J1dHRvbiggJ2VuYWJsZScgKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIDUwMCApO1xuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5zb3J0YWJsZSgge1xuXHRcdFx0XHRoYW5kbGU6ICcubGxtcy1kcmFnLWhhbmRsZScsXG5cdFx0XHRcdGl0ZW1zOiAnLmxsbXMtYWNjZXNzLXBsYW4nLFxuXHRcdFx0XHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0XHRzZWxmLiRwbGFucy5hZGRDbGFzcyggJ2RyYWdnaW5nJyApO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdG9wOiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xuXHRcdFx0XHRcdHNlbGYuJHBsYW5zLnJlbW92ZUNsYXNzKCAnZHJhZ2dpbmcnICk7XG5cdFx0XHRcdFx0c2VsZi51cGRhdGVfcGxhbl9vcmRlcnMoKTtcblx0XHRcdFx0fSxcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gYmluZCB0ZXh0IGVudGVyZWQgaW50byB0aGUgdGl0bGUgdG8gdGhlIGRpc3BsYXllZCB0aXRsZSBmb3IgZmFuY3kgZnVuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2tleXVwJywgJ2lucHV0LmxsbXMtcGxhbi10aXRsZScsIGZ1bmN0aW9uKCApIHtcblxuXHRcdFx0XHR2YXIgJGlucHV0ID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdCRwbGFuID0gJGlucHV0LmNsb3Nlc3QoICcubGxtcy1hY2Nlc3MtcGxhbicgKSxcblx0XHRcdFx0XHQkZGlzcGxheSA9ICRwbGFuLmZpbmQoICdzcGFuLmxsbXMtcGxhbi10aXRsZScgKSxcblx0XHRcdFx0XHR2YWwgPSAkaW5wdXQudmFsKCksXG5cdFx0XHRcdFx0dGl0bGUgPSAoIHZhbCApID8gdmFsIDogJGRpc3BsYXkuYXR0ciggJ2RhdGEtZGVmYXVsdCcgKTtcblxuXHRcdFx0XHQkZGlzcGxheS50ZXh0KCB0aXRsZSApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIFJlY29yZCB0aGF0IGEgZmllbGQgaGFzIGJlZW4gZm9jdXNlZCBzbyB3ZSBjYW4gdHdlYWsgdmFsaWRhdGlvbiB0byBvbmx5IHZhbGlkYXRlIFwiZWRpdGVkXCIgZmllbGRzLlxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdmb2N1c2luJywgJ2lucHV0JywgZnVuY3Rpb24oIGUsIGRhdGEgKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS5hZGRDbGFzcyggJ2xsbXMtaGFzLWJlZW4tZm9jdXNlZCcgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gVmFsaWRhdGUgYSBzaW5nbGUgaW5wdXQgZmllbGRcblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAna2V5dXAgZm9jdXNvdXQgbGxtcy12YWxpZGF0ZS1wbGFuLWZpZWxkJywgJ2lucHV0JywgZnVuY3Rpb24oIGUsIGRhdGEgKSB7XG5cblx0XHRcdFx0dmFyICRpbnB1dCA9ICQoIHRoaXMgKTtcblxuXHRcdFx0XHRpZiAoICRpbnB1dFswXS5jaGVja1ZhbGlkaXR5KCkgKSB7XG5cdFx0XHRcdFx0JGlucHV0LnJlbW92ZUNsYXNzKCBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkaW5wdXQuYWRkQ2xhc3MoIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApO1xuXHRcdFx0XHRcdGlmICggJ2tleXVwJyA9PT0gZS50eXBlICkge1xuXHRcdFx0XHRcdFx0JGlucHV0WzBdLnJlcG9ydFZhbGlkaXR5KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCAhIGRhdGEgfHwgZGF0YS5jYXNjYWRlICkge1xuXHRcdFx0XHRcdCRpbnB1dC5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICkudHJpZ2dlciggJ2xsbXMtdmFsaWRhdGUtcGxhbicsIHsgb3JpZ2luYWxfZXZlbnQ6IGUudHlwZSB9ICk7XG5cdFx0XHRcdH1cblxuXG5cdFx0XHR9ICk7XG5cblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAnbGxtcy12YWxpZGF0ZS1wbGFuJywgJy5sbG1zLWFjY2Vzcy1wbGFuJywgZnVuY3Rpb24oIGUsIGRhdGEgKSB7XG5cblx0XHRcdFx0ZGF0YSA9IGRhdGEgfHwge307XG5cblx0XHRcdFx0dmFyICRwbGFuID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdC8vIG9ubHkgdmFsaWRhdGUgXCJlZGl0ZWRcIiBmaWVsZHMgZHVyaW5nIGNhc2NhZGluZyB2YWxpZGF0aW9uIGZyb20gaW5wdXQgdmFsaWRhdGlvbnMuXG5cdFx0XHRcdFx0c2VsZWN0b3IgPSBkYXRhLm9yaWdpbmFsX2V2ZW50ID8gJ2lucHV0LmxsbXMtaGFzLWJlZW4tZm9jdXNlZCcgOiAnaW5wdXQnO1xuXG5cdFx0XHRcdCRwbGFuLmZpbmQoIHNlbGVjdG9yICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JCggdGhpcyApLnRyaWdnZXIoICdsbG1zLXZhbGlkYXRlLXBsYW4tZmllbGQnLCB7IGNhc2NhZGU6IGZhbHNlIH0gKTtcblx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdGlmICggJHBsYW4uZmluZCggJy4nICsgc2VsZi52YWxpZGF0aW9uX2NsYXNzICkubGVuZ3RoICkge1xuXHRcdFx0XHRcdCRwbGFuLmFkZENsYXNzKCBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkcGxhbi5yZW1vdmVDbGFzcyggc2VsZi52YWxpZGF0aW9uX2NsYXNzICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2xsbXMtY29sbGFwc2libGUtdG9nZ2xlZCcsICcubGxtcy1hY2Nlc3MtcGxhbicsIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkcGxhbiA9ICQoIHRoaXMgKTtcblxuXHRcdFx0XHRpZiAoICRwbGFuLmhhc0NsYXNzKCAnb3BlbmVkJyApICkge1xuXHRcdFx0XHRcdC8vIHdhaXQgZm9yIGFuaW1hdGlvbiB0byBjb21wbGV0ZSB0byBwcmV2ZW50IGZvY3VzYWJsZSBlcnJvcnMgaW4gdGhlIGNvbnNvbGUuXG5cdFx0XHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQkcGxhbi5maW5kKCAnaW5wdXQubGxtcy1pbnZhbGlkJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHQkKCB0aGlzIClbMF0ucmVwb3J0VmFsaWRpdHkoKTtcblx0XHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0XHR9LCA1MDAgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAnY2xpY2snLCAnLmxsbXMtcGxhbi1kZWxldGUnLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0c2VsZi5kZWxldGVfcGxhbiggJCggdGhpcyApICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIHNlbGVjdDJpZnkgbWVtYmVyc2hpcCBhdmFpbGFiaWxpdHkgZmllbGRzXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYXZhaWxhYmlsaXR5LXJlc3RyaWN0aW9ucycgKSApO1xuXG5cdFx0XHQvLyBkaXNhYmxlIHRoZSB0ZXh0YXJlYSBnZW5lcmF0ZWQgYnkgdGhlIHdwX2VkaXRvciBmdW5jdGlvblxuXHRcdFx0Ly8gY2FuJ3QgZmlndXJlIG91dCBob3cgdG8gZG8gdGhpcyBkdXJpbmcgaW5pdGlhbGl6YXRpb25cblx0XHRcdCQoICcjX2xsbXNfcGxhbnNfY29udGVudF9sbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKS5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHR0aW55TUNFLkVkaXRvck1hbmFnZXIuZXhlY0NvbW1hbmQoICdtY2VSZW1vdmVFZGl0b3InLCB0cnVlLCAnX2xsbXNfcGxhbnNfY29udGVudF9sbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKTtcblxuXHRcdFx0Ly8gQ2xhc3NpYyBFZGl0b3Jcblx0XHRcdGlmICggISB3cC5kYXRhICkge1xuXG5cdFx0XHRcdC8vIEVuc3VyZSBkYXRhIGlzIHNhdmVkIHdoZW4gdGhlIENsYXNzaWMgRWRpdG9yIHBvc3QgZm9ybSBpcyBzdWJtaXR0ZWQuXG5cdFx0XHRcdHZhciB3cF9wb3N0X2Zvcm0gPSAkKCAnZm9ybSNwb3N0JyApO1xuXHRcdFx0XHR3cF9wb3N0X2Zvcm0ub24oICdzdWJtaXQnLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0XHRpZiAoIHNlbGYuZ2V0X2N1cnJlbnRfcGxhbl9jb3VudCgpICkge1xuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0c2VsZi4kc2F2ZS50cmlnZ2VyKCAnY2xpY2snICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIERPTSBldmVudHMgZm9yIGVkaXRpbmcgcHJvZHVjdCB2aXNpYmlsaXR5XG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy42LjBcblx0XHQgKiBAdmVyc2lvbiAgMy42LjBcblx0XHQgKi9cblx0XHR0aGlzLmJpbmRfdmlzaWJpbGl0eSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgJHJhZGlvcyA9ICQoICcjbGxtcy1jYXRhbG9nLXZpc2liaWxpdHktc2VsZWN0JyApLFxuXHRcdFx0XHQkdG9nZ2xlID0gJCggJ2EubGxtcy1lZGl0LWNhdGFsb2ctdmlzaWJpbGl0eScgKSxcblx0XHRcdFx0JHNhdmUgPSAkKCAnYS5sbG1zLXNhdmUtY2F0YWxvZy12aXNpYmlsaXR5JyApLFxuXHRcdFx0XHQkY2FuY2VsID0gICQoICdhLmxsbXMtY2FuY2VsLWNhdGFsb2ctdmlzaWJpbGl0eScgKTtcblxuXHRcdFx0JHRvZ2dsZS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0JHJhZGlvcy5zbGlkZURvd24oICdmYXN0JyApO1xuXHRcdFx0XHQkdG9nZ2xlLmhpZGUoKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0JHNhdmUub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCRyYWRpb3Muc2xpZGVVcCggJ2Zhc3QnICk7XG5cdFx0XHRcdCR0b2dnbGUuc2hvdygpO1xuXHRcdFx0XHQkKCAnI2xsbXMtY2F0YWxvZy12aXNpYmlsaXR5LWRpc3BsYXknICkudGV4dCggJCggJ2lucHV0W25hbWU9XCJfbGxtc192aXNpYmlsaXR5XCJdOmNoZWNrZWQnICkuYXR0ciggJ2RhdGEtbGFiZWwnICkgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0JGNhbmNlbC5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0JHJhZGlvcy5zbGlkZVVwKCAnZmFzdCcgKTtcblx0XHRcdFx0JHRvZ2dsZS5zaG93KCk7XG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogSGFuZGxlIHBoeXNpY2FsIGRlbGV0aW9uIG9mIGEgcGxhbiBlbGVtZW50XG5cdFx0ICogSWYgdGhlIHBsYW4gaGFzbid0IGJlIHBlcnNpc3RlZCB0byB0aGUgZGF0YWJzZSBpdCdzIHJlbW92ZWQgZnJvbSB0aGUgZG9tXG5cdFx0ICogaWYgaXQgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGRhdGFiYXNlIGEgY29uZmlybSBtb2RhbCBpcyBkaXNwbGF5ZWRcblx0XHQgKiB1cG9uIGNvbmZpcm1hdGlvbiBBSkFYIGNhbGwgd2lsbCBiZSBtYWRlIHRvIG1vdmUgdGhlIHBsYW4gdG8gdGhlIHRyYXNoXG5cdFx0ICogYW5kIHVwb24gc3VjY2VzcyB0aGUgZWxlbWVudCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgZG9tXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIG9iaiAkYnRuIGpRdWVyeSBzZWxlY3RvciBvZiB0aGUgXCJYXCIgYnV0dG9uIGNsaWNrZWQgdG8gaW5pdGlhdGUgZGVsZXRpb25cblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIFt2ZXJzaW9uXVxuXHRcdCAqL1xuXHRcdHRoaXMuZGVsZXRlX3BsYW4gPSBmdW5jdGlvbiggJGJ0biApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHQkcGxhbiA9ICRidG4uY2xvc2VzdCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLFxuXHRcdFx0XHRwbGFuX2lkID0gJHBsYW4uYXR0ciggJ2RhdGEtaWQnICksXG5cdFx0XHRcdHdhcm5pbmcgPSBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQWZ0ZXIgZGVsZXRpbmcgdGhpcyBhY2Nlc3MgcGxhbiwgYW55IHN0dWRlbnRzIHN1YnNjcmliZWQgdG8gdGhpcyBwbGFuIHdpbGwgc3RpbGwgaGF2ZSBhY2Nlc3MgYW5kIHdpbGwgY29udGludWUgdG8gbWFrZSByZWN1cnJpbmcgcGF5bWVudHMgYWNjb3JkaW5nIHRvIHRoZSBhY2Nlc3MgcGxhblxcJ3Mgc2V0dGluZ3MuIElmIHlvdSB3aXNoIHRvIHRlcm1pbmF0ZSB0aGVpciBwbGFucyB5b3UgbXVzdCBkbyBzbyBtYW51YWxseS4gVGhpcyBhY3Rpb24gY2Fubm90IGJlIHJldmVyc2VkLicgKTtcblxuXHRcdFx0Ly8gaWYgdGhlcmUncyBubyBJRCBqdXN0IHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cblx0XHRcdGlmICggISBwbGFuX2lkICkge1xuXG5cdFx0XHRcdHNlbGYucmVtb3ZlX3BsYW5fZWwoICRwbGFuICk7XG5cblx0XHRcdC8vIFRocm93IGEgY29uZmlybWF0aW9uIHdhcm5pbmdcblx0XHRcdH0gZWxzZSBpZiAoIHdpbmRvdy5jb25maXJtKCB3YXJuaW5nICkgKSB7XG5cblx0XHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkcGxhbiApO1xuXHRcdFx0XHR3aW5kb3cuTExNUy5BamF4LmNhbGwoIHtcblx0XHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0XHRhY3Rpb246ICdkZWxldGVfYWNjZXNzX3BsYW4nLFxuXHRcdFx0XHRcdFx0cGxhbl9pZDogcGxhbl9pZCxcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCByICkge1xuXHRcdFx0XHRcdFx0TExNUy5TcGlubmVyLnN0b3AoICRwbGFuICk7XG5cdFx0XHRcdFx0XHRpZiAoIHIuc3VjY2VzcyApIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVfcGxhbl9lbCggJHBsYW4gKTtcblx0XHRcdFx0XHRcdFx0c2VsZi50cmlnZ2VyX3VwZGF0ZV9ob29rKCk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCByLm1lc3NhZ2UgKSB7XG5cdFx0XHRcdFx0XHRcdGFsZXJ0KCByLm1lc3NhZ2UgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSApO1xuXG5cdFx0XHR9XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogSGFuZGxlIGhpZGluZyAmIHNob3dpbmcgdmFyaW9zIHBpZWNlcyBvZiBhbiBhY2Nlc3MgcGxhbiBmb3JtXG5cdFx0ICogVGhpcyBpcyBib3VuZCB0byBhbnkgZm9ybSBlbGVtZW50IHdpdGggYSBcImRhdGEtY29udHJvbGxlci1pZFwiIHByb3BlcnR5XG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIG9iaiAgJGVsICAgalF1ZXJ5IHNlbGVjdG9yIGZvciB0aGUgY2hhbmdlZCBmb3JtIGVsZW1lbnRcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5jb250cm9sbGVyX2NoYW5nZSA9IGZ1bmN0aW9uKCAkZWwgKSB7XG5cblx0XHRcdHZhciBpZCA9ICRlbC5hdHRyKCAnZGF0YS1jb250cm9sbGVyLWlkJyApLFxuXHRcdFx0XHR2YWwgPSAkZWwudmFsKCksXG5cdFx0XHRcdCRmb3JtID0gJGVsLmNsb3Nlc3QoICcubGxtcy1hY2Nlc3MtcGxhbicgKSxcblx0XHRcdFx0JGNvbnRyb2xzID0gJGZvcm0uZmluZCggJ1tkYXRhLWNvbnRyb2xsZXI9XCInICsgaWQgKyAnXCJdJyk7XG5cblx0XHRcdGlmICggJ2NoZWNrYm94JyA9PT0gJGVsLmF0dHIoICd0eXBlJyApICkgIHtcblx0XHRcdFx0dmFsID0gKCAkZWwuaXMoICc6Y2hlY2tlZCcgKSApID8gdmFsIDogJ25vJztcblx0XHRcdH1cblxuXHRcdFx0JGNvbnRyb2xzLmVhY2goIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkYyA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQkZWxzID0gKCAnU0VMRUNUJyA9PT0gJGNbMF0ubm9kZU5hbWUgfHwgJ0lOUFVUJyAgPT09ICRjWzBdLm5vZGVOYW1lIHx8ICdURVhUQVJFQScgID09PSAkY1swXS5ub2RlTmFtZSApID8gJGMgOiAkYy5maW5kKCAnaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEnICksXG5cdFx0XHRcdFx0ZXF1YWxzID0gJGMuYXR0ciggJ2RhdGEtdmFsdWUtaXMnICksXG5cdFx0XHRcdFx0bm90X2VxdWFscyA9ICRjLmF0dHIoICdkYXRhLXZhbHVlLWlzLW5vdCcgKSxcblx0XHRcdFx0XHRhY3Rpb24sIG9wZXJhdG9yO1xuXG5cdFx0XHRcdGlmICggdHlwZW9mIGVxdWFscyAhPT0gdHlwZW9mIHVuZGVmaW5lZCAmJiBlcXVhbHMgIT09IGZhbHNlICkge1xuXG5cdFx0XHRcdFx0b3BlcmF0b3IgPSAnPT0nO1xuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIHR5cGVvZiBub3RfZXF1YWxzICE9PSB0eXBlb2YgdW5kZWZpbmVkICYmIG5vdF9lcXVhbHMgIT09IGZhbHNlICkge1xuXG5cdFx0XHRcdFx0b3BlcmF0b3IgPSAnIT0nO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzd2l0Y2ggKCBvcGVyYXRvciApIHtcblxuXHRcdFx0XHRcdGNhc2UgJz09JzpcblxuXHRcdFx0XHRcdFx0aWYgKCB2YWwgPT0gZXF1YWxzICkge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb24gPSAnc2hvdyc7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb24gPSAnaGlkZSc7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgJyE9JzpcblxuXHRcdFx0XHRcdFx0aWYgKCB2YWwgIT0gbm90X2VxdWFscyApIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ3Nob3cnO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ2hpZGUnO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggJ3Nob3cnID09PSBhY3Rpb24gKSB7XG5cdFx0XHRcdFx0JGMuc2hvdygpO1xuXHRcdFx0XHRcdCRlbHMucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApLnRyaWdnZXIoICdjaGFuZ2UnICk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoICdoaWRlJyA9PT0gYWN0aW9uICkge1xuXHRcdFx0XHRcdCRjLmhpZGUoKTtcblx0XHRcdFx0XHQkZWxzLmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogUmV0cmlldmUgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIGFjY2VzcyBwbGFucyBmb3IgdGhlIGNvdXJzZSAvIG1lbWJlcnNoaXAgKHNhdmVkIG9yIHVuc2F2ZWQpXG5cdFx0ICogQHJldHVybiAgaW50XG5cdFx0ICogQHNpbmNlICAgW3ZlcnNpb25dXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy5nZXRfY3VycmVudF9wbGFuX2NvdW50ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy4kcGxhbnMuZmluZCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLmxlbmd0aDtcblx0XHR9XG5cblx0XHQvKipcblx0XHQgKiBSZXRyaWV2ZSBhY2Nlc3MgcGxhbiBkYXRhIGFzIGFuIGFycmF5IG9mIEpTT04gYnVpbHQgZnJvbSB0aGUgZG9tIGVsZW1lbnQgZmllbGQgdmFsdWVzLlxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAgYXJyYXlcblx0XHQgKiBAc2luY2UgICBbdmVyc2lvbl1cblx0XHQgKiBAdmVyc2lvbiBbdmVyc2lvbl1cblx0XHQgKi9cblx0XHR0aGlzLmdldF9wbGFuc19hcnJheSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQvLyBlbnN1cmUgYWxsIGNvbnRlbnQgZWRpdG9ycyBhcmUgc2F2ZWQgcHJvcGVybHkuXG5cdFx0XHR0aW55TUNFLnRyaWdnZXJTYXZlKCk7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0Zm9ybSA9IHNlbGYuJHBsYW5zLmNsb3Nlc3QoICdmb3JtJyApLnNlcmlhbGl6ZUFycmF5KCksXG5cdFx0XHRcdHBsYW5zID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGZvcm0ubGVuZ3RoOyBpKysgKSB7XG5cblx0XHRcdFx0Ly8gU2tpcCBub24gcGxhbiBkYXRhIGZyb20gdGhlIGZvcm0uXG5cdFx0XHRcdGlmICggLTEgPT09IGZvcm1bIGkgXS5uYW1lLmluZGV4T2YoICdfbGxtc19wbGFucycgKSApIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBrZXlzID0gZm9ybVsgaSBdLm5hbWUucmVwbGFjZSggJ19sbG1zX3BsYW5zWycsICcnICkuc3BsaXQoICddWycgKSxcblx0XHRcdFx0XHRpbmRleCA9ICgga2V5c1swXSAqIDEgKSAtIDEsXG5cdFx0XHRcdFx0bmFtZSA9IGtleXNbMV0ucmVwbGFjZSggJ10nLCAnJyApLFxuXHRcdFx0XHRcdHR5cGUgPSAzID09PSBrZXlzLmxlbmd0aCA/ICdhcnJheScgOiAnc2luZ2xlJztcblxuXHRcdFx0XHRpZiAoICEgcGxhbnNbIGluZGV4IF0gKSB7XG5cdFx0XHRcdFx0cGxhbnNbIGluZGV4IF0gPSB7fTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggJ2FycmF5JyA9PT0gdHlwZSApIHtcblxuXHRcdFx0XHRcdGlmICggISBwbGFuc1sgaW5kZXggXVsgbmFtZSBdICkge1xuXHRcdFx0XHRcdFx0cGxhbnNbIGluZGV4IF1bIG5hbWUgXSA9IFtdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRwbGFuc1sgaW5kZXggXVsgbmFtZSBdLnB1c2goIGZvcm1bIGkgXS52YWx1ZSApO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRwbGFuc1sgaW5kZXggXVsgbmFtZSBdID0gZm9ybVsgaSBdLnZhbHVlO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gcGxhbnM7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogRGV0ZXJtaW5lIGlmIHRoZSBhY2Nlc3MgcGxhbiBsaW1pdCBoYXMgYmVlbiByZWFjaGVkXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuIEJvb2xlYW5cblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIFt2ZXJzaW9uXVxuXHRcdCAqL1xuXHRcdHRoaXMuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBsaW1pdCA9IHdpbmRvdy5sbG1zLnByb2R1Y3QuYWNjZXNzX3BsYW5fbGltaXQ7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZXRfY3VycmVudF9wbGFuX2NvdW50KCkgPj0gbGltaXQ7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogSW5pdGFsaXplcyBhIG5ldyBwbGFuIGFuZCBhZGRzIGl0IHRvIHRoZSBsaXN0IG9mIHBsYW5zIGluIHRoZSBET01cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjIzLjBcblx0XHQgKi9cblx0XHR0aGlzLmluaXRfcGxhbiA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQvLyBkb24ndCBkbyBhbnl0aGluZyBpZiB3ZSd2ZSByZWFjaGVkIHRoZSBwbGFuIGxpbWl0XG5cdFx0XHRpZiAoIHRoaXMuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0dmFyICRjbG9uZSA9ICQoICcjbGxtcy1uZXctYWNjZXNzLXBsYW4tbW9kZWwnICkuY2xvbmUoKVxuXHRcdFx0XHQkZXhpc3RpbmdfcGxhbnMgPSAkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWFjY2Vzcy1wbGFuJyApLFxuXHRcdFx0XHQkZWRpdG9yID0gJGNsb25lLmZpbmQoICcjX2xsbXNfcGxhbnNfY29udGVudF9sbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIElEIGZyb20gdGhlIGl0ZW1cblx0XHRcdCRjbG9uZS5yZW1vdmVBdHRyKCAnaWQnICk7XG5cblx0XHRcdC8vIGdpdmUgYSB0ZW1wb3JhcnkgaWQgdG8gdGhlIGVkaXRvciBlbGVtZW50XG5cdFx0XHQkZWRpdG9yLnJlbW92ZUF0dHIoICdpZCcgKS5hdHRyKCAnaWQnLCAnX2xsbXNfcGxhbnNfY29udGVudF8nICsgdGhpcy50ZW1wX2lkICk7XG5cdFx0XHR0aGlzLnRlbXBfaWQrKzsgLy8gaW5jcmVtZW50IHRoZSB0ZW1wX2lkIElEIHNvIHdlIGRvbid0IHVzZSBpdCBhZ2FpblxuXG5cblx0XHRcdC8vIGFjdGl2YXRlIGFsbCBlbGVtZW50c1xuXHRcdFx0JGNsb25lLmZpbmQoICdzZWxlY3QsIGlucHV0LCB0ZXh0YXJlYScgKS5lYWNoKCBmdW5jdGlvbigpIHtcblx0XHRcdFx0JCggdGhpcyApLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTsgLy8gZW5hYmxlZCB0aGUgZmllbGRcblx0XHRcdH0gKTtcblxuXG5cdFx0XHQkY2xvbmUuZmluZCggJy5sbG1zLWFjY2Vzcy1wbGFuLWRhdGVwaWNrZXInICkuZGF0ZXBpY2tlcigge1xuXHRcdFx0XHRkYXRlRm9ybWF0OiBcIm1tL2RkL3l5XCJcblx0XHRcdH0gKTtcblxuXHRcdFx0JGNsb25lLmFwcGVuZFRvKCAnI2xsbXMtYWNjZXNzLXBsYW5zJyApO1xuXG5cdFx0XHQvLyByZXdyaXRlIHRoZSBvcmRlciBvZiBhbGwgZWxlbWVudHNcblx0XHRcdHRoaXMudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cblx0XHRcdCRjbG9uZS5maW5kKCAnLmxsbXMtY29sbGFwc2libGUtaGVhZGVyJyApLnRyaWdnZXIoICdjbGljaycgKTtcblxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGxpbWl0IGhhcyBiZWVuIHJlYWNoZWQgYW5kIHRvZ2dsZSB0aGUgYnV0dG9uIGlmIGl0IGhhc1xuXHRcdFx0aWYgKCB0aGlzLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCgpICkge1xuXHRcdFx0XHR0aGlzLnRvZ2dsZV9jcmVhdGVfYnV0dG9uKCAnZGlzYWJsZScgKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gc2VsZWN0MmlmeSBtZW1iZXJzaGlwIGF2YWlsYWJpbGl0eSBmaWVsZFxuXHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLnBvc3Rfc2VsZWN0KCAkY2xvbmUuZmluZCggJy5sbG1zLWF2YWlsYWJpbGl0eS1yZXN0cmljdGlvbnMnICkgKTtcblxuXHRcdFx0JGNsb25lLmZpbmQoICdbZGF0YS1jb250cm9sbGVyLWlkXScgKS50cmlnZ2VyKCAnY2hhbmdlJyApO1xuXHRcdFx0JCggZG9jdW1lbnQgKS50cmlnZ2VyKCAnbGxtcy1wbGFuLWluaXQnLCAkY2xvbmUgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBQZXJzaXN0IGFjY2VzcyBwbGFucyB0byB0aGUgREIgaWYgdGhleSBwYXNzIHZhbGlkYXRpb25cblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gIHtbdHlwZV19XG5cdFx0ICogQHNpbmNlICAgW3ZlcnNpb25dXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy5zYXZlX3BsYW5zID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0c2VsZi4kcGxhbnMuZmluZCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCB0aGlzICkudHJpZ2dlciggJ2xsbXMtdmFsaWRhdGUtcGxhbicgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0aWYgKCBzZWxmLiRwbGFucy5maW5kKCAnLicgKyBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKS5sZW5ndGggKSB7XG5cdFx0XHRcdHNlbGYuJHBsYW5zLmZpbmQoICcubGxtcy1hY2Nlc3MtcGxhbi4nICsgc2VsZi52YWxpZGF0aW9uX2NsYXNzICkubm90KCAnLm9wZW5lZCcgKS5maXJzdCgpLmZpbmQoICcubGxtcy1jb2xsYXBzaWJsZS1oZWFkZXInICkudHJpZ2dlciggJ2NsaWNrJyApO1xuXHRcdFx0XHQkKCBkb2N1bWVudCApLnRyaWdnZXIoICdsbG1zLWFjY2Vzcy1wbGFuLXZhbGlkYXRpb24tZXJyb3JzJyApO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdExMTVMuU3Bpbm5lci5zdGFydCggc2VsZi4kcGxhbnMgKTtcblx0XHRcdHNlbGYuJHNhdmUuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICdsbG1zX3VwZGF0ZV9hY2Nlc3NfcGxhbnMnLFxuXHRcdFx0XHRcdHBsYW5zOiBzZWxmLmdldF9wbGFuc19hcnJheSgpLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRjb21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0TExNUy5TcGlubmVyLnN0b3AoIHNlbGYuJHBsYW5zICk7XG5cdFx0XHRcdFx0c2VsZi4kc2F2ZS5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbigganFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duICkge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoICdsbG1zIGFjY2VzcyBwbGFuIHNhdmUgZXJyb3IgZW5jb3VudGVyZDonLCBqcVhIUiApO1xuXHRcdFx0XHRcdGFsZXJ0KCBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQW4gZXJyb3Igd2FzIGVuY291bnRlcmQgZHVyaW5nIHRoZSBzYXZlIGF0dGVtcHQuIFBsZWFzZSB0cnkgYWdhaW4uJyApICsgJyBbJyAgKyB0ZXh0U3RhdHVzICsgJzogJyArIGVycm9yVGhyb3duICsgJ10nICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCByZXMgKSB7XG5cblx0XHRcdFx0XHRpZiAoICEgcmVzLnN1Y2Nlc3MgJiYgcmVzLmNvZGUgJiYgJ2Vycm9yJyA9PT0gcmVzLmNvZGUgKSB7XG5cdFx0XHRcdFx0XHRhbGVydCggcmVzLm1lc3NhZ2UgKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCByZXMuZGF0YSAmJiByZXMuZGF0YS5odG1sICkge1xuXG5cdFx0XHRcdFx0XHQvLyByZXBsYWNlIHRoZSBtZXRhYm94IHdpdGggdXBkYXRlZCBkYXRhIGZyb20gdGhlIHNlcnZlci5cblx0XHRcdFx0XHRcdCQoICcjbGxtcy1wcm9kdWN0LW9wdGlvbnMtYWNjZXNzLXBsYW5zJyApLnJlcGxhY2VXaXRoKCByZXMuZGF0YS5odG1sICk7XG5cblx0XHRcdFx0XHRcdC8vIHJlaW5pdC5cblx0XHRcdFx0XHRcdHNlbGYuaW5pdCggdHJ1ZSApO1xuXHRcdFx0XHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLmluaXQoKTtcblx0XHRcdFx0XHRcdHNlbGYudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cblx0XHRcdFx0XHRcdC8vIG5vdGlmeSB0aGUgYmxvY2sgZWRpdG9yXG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXJfdXBkYXRlX2hvb2soKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9LFxuXG5cdFx0XHR9ICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFRvZ2dsZSB0aGUgc3RhdHVzIG9mIGEgYnV0dG9uXG5cdFx0ICogQHBhcmFtICAgT2JqZWN0ICAkYnRuICAgalF1ZXJ5IHNlbGVjdG9yIG9mIGEgYnV0dG9uIGVsZW1lbnRcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgW3ZlcnNpb25dXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy50b2dnbGVfYnV0dG9uID0gZnVuY3Rpb24oICRidG4sIHN0YXR1cyApIHtcblxuXHRcdFx0aWYgKCAnZGlzYWJsZScgPT09IHN0YXR1cyApIHtcblx0XHRcdFx0JGJ0bi5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkYnRuLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBDb250cm9sIHRoZSBzdGF0dXMgb2YgdGhlIFwiTmV3IEFjY2VzcyBQbGFuXCIgQnV0dG9uXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHNpbmNlICBbdmVyc2lvbl1cblx0XHQgKi9cblx0XHR0aGlzLnRvZ2dsZV9jcmVhdGVfYnV0dG9uID0gZnVuY3Rpb24oIHN0YXR1cyApIHtcblx0XHRcdHRoaXMudG9nZ2xlX2J1dHRvbiggJCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbicgKSwgc3RhdHVzICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENvbnRyb2wgdGhlIHN0YXR1cyBvZiB0aGUgXCJTYXZlIEFjY2VzcyBQbGFuc1wiIEJ1dHRvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBzdHJpbmcgc3RhdHVzIGVuYWJsZSBvciBkaXNhYmxlXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqIEBzaW5jZSAgW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy50b2dnbGVfc2F2ZV9idXR0b24gPSBmdW5jdGlvbiggc3RhdHVzICkge1xuXHRcdFx0dGhpcy50b2dnbGVfYnV0dG9uKCB0aGlzLiRzYXZlLCBzdGF0dXMgKTtcblx0XHR9XG5cblx0XHQvKipcblx0XHQgKiBWaXN1YWxseSBoaWRlIGFuZCB0aGVuIHBoeXNpY2FsbHkgcmVtb3ZlIGEgcGxhbiBlbGVtZW50IGZyb20gdGhlIERPTVxuXHRcdCAqIEFkZGl0aW9uYWxseSBkZXRlcm1pbmVzIGlmIHRoZSBOZXcgUGxhbiBCdXR0b24gc2hvdWxkIGJlIHJlLWVuYWJsZWRcblx0XHQgKiBhZnRlciBkZWxldGlvblxuXHRcdCAqXG5cdFx0ICogQHBhcmFtICBvYmogICAkcGxhbiBqUXVlcnkgc2VsZWN0b3Igb2YgdGhlIHBsYW4gZWxlbWVudFxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqIEBzaW5jZSAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIFt2ZXJzaW9uXVxuXHRcdCAqL1xuXHRcdHRoaXMucmVtb3ZlX3BsYW5fZWwgPSBmdW5jdGlvbiggJHBsYW4gKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0Ly8gZmFkZSBvdXQgbmljZWx5XG5cdFx0XHQkcGxhbi5mYWRlT3V0KCA0MDAgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGZyb20gZG9tIGFmdGVyIGl0J3MgaGlkZGVuIHZpc3VhbGx5XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdCRwbGFuLnJlbW92ZSgpO1xuXG5cdFx0XHRcdC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gcmVlbmFibGUgdGhlIGNyZWF0ZSBidXR0b24gYW5kIGhpZGUgdGhlIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKCAhIHNlbGYuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdFx0c2VsZi50b2dnbGVfY3JlYXRlX2J1dHRvbiggJ2VuYWJsZScgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggMCA9PT0gc2VsZi5nZXRfY3VycmVudF9wbGFuX2NvdW50KCkgKSB7XG5cdFx0XHRcdFx0c2VsZi50b2dnbGVfc2F2ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0sIDQ1MCApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFRyaWdnZXIgV1AgQmxvY2sgRWRpdG9yIGhvb2sgc28gdGhlIHByaWNpbmcgdGFibGUgYmxvY2sgY2FuIGJlIHJlLXJlbmRlcmVkIHdpdGggbmV3IHBsYW4gaW5mb3JtYXRpb24uXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuICB2b2lkXG5cdFx0ICogQHNpbmNlICAgW3ZlcnNpb25dXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy50cmlnZ2VyX3VwZGF0ZV9ob29rID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoIGRvY3VtZW50ICkudHJpZ2dlciggJ2xsbXMtYWNjZXNzLXBsYW5zLXVwZGF0ZWQnICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogUmVvcmRlciB0aGUgYXJyYXkgaW5kZXhlcyBhbmQgdGhlIG1lbnUgb3JkZXIgaGlkZGVuIGlucHV0c1xuXHRcdCAqIENhbGxlZCBieSBqUXVlcnkgVUkgU29ydGFibGUgb24gc29ydCBjb21wbGV0aW9uXG5cdFx0ICogQWxzbyBjYWxsZWQgYWZ0ZXIgYWRkaW5nIGEgbmV3IHBsYW4gdG8gdGhlIERPTSBzbyB0aGUgbmV3ZXN0IGl0ZW0gaXMgYWx3YXlzXG5cdFx0ICogcGVyc2lzdGVkIGFzIHRoZSBsYXN0IGluIHRoZSBkYXRhYmFzZSBpZiBubyBVWCByZW9yZGVycyB0aGUgaXRlbVxuXHRcdCAqXG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMudXBkYXRlX3BsYW5fb3JkZXJzID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdCQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYWNjZXNzLXBsYW4nICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0dmFyICRwID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdCRvcmRlciA9ICRwLmZpbmQoICcucGxhbi1vcmRlcicgKSxcblx0XHRcdFx0XHQkZWRpdG9yID0gJHAuZmluZCggJ3RleHRhcmVhW2lkXj1cIl9sbG1zX3BsYW5zX2NvbnRlbnRfXCJdJyApLFxuXHRcdFx0XHRcdGVkaXRvcl9pZCA9ICRlZGl0b3IuYXR0ciggJ2lkJyApLFxuXHRcdFx0XHRcdG9yaWcgPSAkb3JkZXIudmFsKCkgKiAxLFxuXHRcdFx0XHRcdGN1cnIgPSAkcC5pbmRleCgpO1xuXG5cdFx0XHRcdC8vIGRlLWluaXQgdGlueU1DRSBmcm9tIHRoZSBlZGl0b3Jcblx0XHRcdFx0dGlueU1DRS5FZGl0b3JNYW5hZ2VyLmV4ZWNDb21tYW5kKCAnbWNlUmVtb3ZlRWRpdG9yJywgdHJ1ZSwgZWRpdG9yX2lkICk7XG5cblx0XHRcdFx0Ly8gdXBkYXRlIHRoZSBvcmRlciBvZiBlYWNoIGZpZWxkIGluIHRoZSBwbGFuXG5cdFx0XHRcdCRwLmZpbmQoICdzZWxlY3QsIGlucHV0LCB0ZXh0YXJlYScgKS5lYWNoKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRcdHZhciBuYW1lID0gJCggdGhpcyApLmF0dHIoICduYW1lJyApO1xuXHRcdFx0XHRcdGlmICggbmFtZSApIHtcblx0XHRcdFx0XHRcdCQoIHRoaXMgKS5hdHRyKCAnbmFtZScsIG5hbWUucmVwbGFjZSggb3JpZywgY3VyciApICk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gKTtcblxuXHRcdFx0XHQvLyByZS1pbml0IHRpbnlNQ0Ugb24gdGhlIGVkaXRvclxuXHRcdFx0XHR0aW55TUNFLkVkaXRvck1hbmFnZXIuZXhlY0NvbW1hbmQoICdtY2VBZGRFZGl0b3InLCB0cnVlLCBlZGl0b3JfaWQgKTtcblxuXHRcdFx0XHQkb3JkZXIudmFsKCBjdXJyICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvLyBnb1xuXHRcdHRoaXMuaW5pdCgpO1xuXG5cdH07XG5cblx0dmFyIGEgPSBuZXcgd2luZG93LmxsbXMubWV0YWJveF9wcm9kdWN0KCk7XG5cbn0gKSggalF1ZXJ5ICk7XG4iXX0=
