!function(c){window.llms=window.llms||{},window.llms.metabox_product=function(){this.$plans=null,this.temp_id=Math.floor(7777*Math.random()+777),this.validation_class="llms-invalid",this.init=function(a){var e=this;e.$plans=c("#llms-access-plans"),e.bind_visibility();var l=c("#lifterlms-product #llms-product-options-access-plans");if(l.length)if(a)e.bind();else{LLMS.Spinner.start(l);var t,s=0;t=setInterval(function(){if(300<=s)l.html(LLMS.l10n.translate("There was an error loading the necessary resources. Please try again."));else{if("undefined"==typeof tinyMCE)return void s++;e.bind()}clearInterval(t),LLMS.Spinner.stop(l)},100)}},this.bind=function(){var t=this;t.has_plan_limit_been_reached()&&t.toggle_create_button(),c("#llms-save-access-plans").on("click",function(a){a.preventDefault(),t.save_plans()}),t.$plans.on("change","[data-controller-id]",function(){t.controller_change(c(this))}),c("#llms-access-plans .llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),c("#llms-access-plans [data-controller-id]").trigger("change"),c("#llms-new-access-plan").on("click",function(){var a=c(this);t.init_plan(),a.attr("disabled","disabled"),setTimeout(function(){t.has_plan_limit_been_reached()||a.removeAttr("disabled")},500)}),t.$plans.sortable({handle:".llms-drag-handle",items:".llms-access-plan",start:function(a,e){t.$plans.addClass("dragging")},stop:function(a,e){t.$plans.removeClass("dragging"),t.update_plan_orders()}}),t.$plans.on("keyup","input.llms-plan-title",function(){var a=c(this),e=a.closest(".llms-access-plan").find("span.llms-plan-title"),l=a.val(),t=l||e.attr("data-default");e.text(t)}),t.$plans.on("keyup llms-validate-plan-field","input",function(a,e){var l=c(this);l[0].checkValidity()?l.removeClass(t.validation_class):(l.addClass(t.validation_class),"keyup"===a.type&&l[0].reportValidity()),e&&!e.cascade||l.closest(".llms-access-plan").trigger("llms-validate-plan")}),t.$plans.on("llms-validate-plan",".llms-access-plan",function(){var a=c(this);a.find("input").each(function(){c(this).trigger("llms-validate-plan-field",{cascade:!1})}),a.find("."+t.validation_class).length?a.addClass(t.validation_class):a.removeClass(t.validation_class)}),t.$plans.on("llms-collapsible-toggled",".llms-access-plan",function(){var a=c(this);a.hasClass("opened")&&setTimeout(function(){a.find("input.llms-invalid").each(function(){c(this)[0].reportValidity()})},500)}),t.$plans.on("click",".llms-plan-delete",function(a){a.stopPropagation(),t.delete_plan(c(this))}),window.llms.metaboxes.post_select(c("#llms-access-plans .llms-availability-restrictions")),c("#_llms_plans_content_llms-new-access-plan-model").attr("disabled","disabled"),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,"_llms_plans_content_llms-new-access-plan-model")},this.bind_visibility=function(){var e=c("#llms-catalog-visibility-select"),l=c("a.llms-edit-catalog-visibility"),a=c("a.llms-save-catalog-visibility"),t=c("a.llms-cancel-catalog-visibility");l.on("click",function(a){a.preventDefault(),e.slideDown("fast"),l.hide()}),a.on("click",function(a){a.preventDefault(),e.slideUp("fast"),l.show(),c("#llms-catalog-visibility-display").text(c('input[name="_llms_visibility"]:checked').attr("data-label"))}),t.on("click",function(a){a.preventDefault(),e.slideUp("fast"),l.show()})},this.delete_plan=function(a){var e=this,l=a.closest(".llms-access-plan"),t=l.attr("data-id"),s=LLMS.l10n.translate("After deleting this access plan, any students subscribed to this plan will still have access and will continue to make recurring payments according to the access plan's settings. If you wish to terminate their plans you must do so manually. This action cannot be reversed.");t?window.confirm(s)&&(LLMS.Spinner.start(l),window.LLMS.Ajax.call({data:{action:"delete_access_plan",plan_id:t},success:function(a){LLMS.Spinner.stop(l),a.success?(e.remove_plan_el(l),e.trigger_update_hook()):a.message&&alert(a.message)}})):e.remove_plan_el(l)},this.controller_change=function(a){var e=a.attr("data-controller-id"),i=a.val(),l=a.closest(".llms-access-plan").find('[data-controller="'+e+'"]');"checkbox"===a.attr("type")&&(i=a.is(":checked")?i:"no"),l.each(function(){var a,e,l=c(this),t="SELECT"===l[0].nodeName||"INPUT"===l[0].nodeName||"TEXTAREA"===l[0].nodeName?l:l.find("input, select, textarea"),s=l.attr("data-value-is"),n=l.attr("data-value-is-not");switch(void 0!==s&&!1!==s?e="==":void 0!==n&&!1!==n&&(e="!="),e){case"==":a=i==s?"show":"hide";break;case"!=":a=i!=n?"show":"hide"}"show"===a?(l.show(),t.removeAttr("disabled").trigger("change")):"hide"===a&&(l.hide(),t.attr("disabled","disabled"))})},this.get_plans_array=function(){tinyMCE.triggerSave();for(var a=this.$plans.closest("form").serializeArray(),e=[],l=0;l<a.length;l++)if(-1!==a[l].name.indexOf("_llms_plans")){var t=a[l].name.replace("_llms_plans[","").split("]["),s=1*t[0]-1,n=t[1].replace("]",""),i=3===t.length?"array":"single";e[s]||(e[s]={}),"array"===i?(e[s][n]||(e[s][n]=[]),e[s][n].push(a[l].value)):e[s][n]=a[l].value}return e},this.has_plan_limit_been_reached=function(){return window.llms.product.access_plan_limit<=c("#llms-access-plans .llms-access-plan").length},this.init_plan=function(){if(!this.has_plan_limit_been_reached()){var a=c("#llms-new-access-plan-model").clone();$existing_plans=c("#llms-access-plans .llms-access-plan"),$editor=a.find("#_llms_plans_content_llms-new-access-plan-model"),a.removeAttr("id"),$editor.removeAttr("id").attr("id","_llms_plans_content_"+this.temp_id),this.temp_id++,a.find("select, input, textarea").each(function(){c(this).removeAttr("disabled")}),a.find(".llms-access-plan-datepicker").datepicker({dateFormat:"mm/dd/yy"}),a.appendTo("#llms-access-plans"),this.update_plan_orders(),a.find(".llms-collapsible-header").trigger("click"),this.has_plan_limit_been_reached()&&this.toggle_create_button("disable"),window.llms.metaboxes.post_select(a.find(".llms-availability-restrictions")),a.find("[data-controller-id]").trigger("change"),c(document).trigger("llms-plan-init",a)}},this.save_plans=function(){var e=this;e.$plans.find(".llms-access-plan").each(function(){c(this).trigger("llms-validate-plan")}),e.$plans.find("."+e.validation_class).length?e.$plans.find(".llms-access-plan."+e.validation_class).not(".opened").first().find(".llms-collapsible-header").trigger("click"):(LLMS.Spinner.start(e.$plans),window.LLMS.Ajax.call({data:{action:"llms_update_access_plans",plans:e.get_plans_array()},complete:function(){LLMS.Spinner.stop(e.$plans)},error:function(a,e,l){console.error("llms access plan save error encounterd:",a),alert(LLMS.l10n.translate("An error was encounterd during the save attempt. Please try again.")+" ["+e+": "+l+"]")},success:function(a){!a.success&&a.code&&"error"===a.code?alert(a.message):a.data&&a.data.html&&(c("#llms-product-options-access-plans").replaceWith(a.data.html),e.init(!0),window.llms.metaboxes.init(),e.update_plan_orders(),e.trigger_update_hook())}}))},this.toggle_create_button=function(a){var e=c("#llms-new-access-plan");"disable"===a?e.attr("disabled","disabled"):e.removeAttr("disabled")},this.remove_plan_el=function(a){var e=this;a.fadeOut(400),setTimeout(function(){a.remove(),e.has_plan_limit_been_reached()||e.toggle_create_button("enable")},450)},this.trigger_update_hook=function(){c(document).trigger("llms-access-plans-updated")},this.update_plan_orders=function(){c("#llms-access-plans .llms-access-plan").each(function(){var a=c(this),e=a.find(".plan-order"),l=a.find('textarea[id^="_llms_plans_content_"]').attr("id"),t=1*e.val(),s=a.index();tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,l),a.find("select, input, textarea").each(function(){var a=c(this).attr("name");a&&c(this).attr("name",a.replace(t,s))}),tinyMCE.EditorManager.execCommand("mceAddEditor",!0,l),e.val(s)})},this.init()};new window.llms.metabox_product}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtbWV0YWJveC1wcm9kdWN0LmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJsbG1zIiwibWV0YWJveF9wcm9kdWN0IiwidGhpcyIsIiRwbGFucyIsInRlbXBfaWQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ2YWxpZGF0aW9uX2NsYXNzIiwiaW5pdCIsInNraXBfZGVwX2NoZWNrcyIsInNlbGYiLCJiaW5kX3Zpc2liaWxpdHkiLCIkbWIiLCJsZW5ndGgiLCJiaW5kIiwiTExNUyIsIlNwaW5uZXIiLCJzdGFydCIsImludGVydmFsIiwiY291bnRlciIsInNldEludGVydmFsIiwiaHRtbCIsImwxMG4iLCJ0cmFuc2xhdGUiLCJ0aW55TUNFIiwiY2xlYXJJbnRlcnZhbCIsInN0b3AiLCJoYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQiLCJ0b2dnbGVfY3JlYXRlX2J1dHRvbiIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2F2ZV9wbGFucyIsImNvbnRyb2xsZXJfY2hhbmdlIiwiZGF0ZXBpY2tlciIsImRhdGVGb3JtYXQiLCJ0cmlnZ2VyIiwiJGVsIiwiaW5pdF9wbGFuIiwiYXR0ciIsInNldFRpbWVvdXQiLCJyZW1vdmVBdHRyIiwic29ydGFibGUiLCJoYW5kbGUiLCJpdGVtcyIsImV2ZW50IiwidWkiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwidXBkYXRlX3BsYW5fb3JkZXJzIiwiJGlucHV0IiwiJGRpc3BsYXkiLCJjbG9zZXN0IiwiZmluZCIsInZhbCIsInRpdGxlIiwidGV4dCIsImRhdGEiLCJjaGVja1ZhbGlkaXR5IiwidHlwZSIsInJlcG9ydFZhbGlkaXR5IiwiY2FzY2FkZSIsIiRwbGFuIiwiZWFjaCIsImhhc0NsYXNzIiwic3RvcFByb3BhZ2F0aW9uIiwiZGVsZXRlX3BsYW4iLCJtZXRhYm94ZXMiLCJwb3N0X3NlbGVjdCIsIkVkaXRvck1hbmFnZXIiLCJleGVjQ29tbWFuZCIsIiRyYWRpb3MiLCIkdG9nZ2xlIiwiJHNhdmUiLCIkY2FuY2VsIiwic2xpZGVEb3duIiwiaGlkZSIsInNsaWRlVXAiLCJzaG93IiwiJGJ0biIsInBsYW5faWQiLCJ3YXJuaW5nIiwiY29uZmlybSIsIkFqYXgiLCJjYWxsIiwiYWN0aW9uIiwic3VjY2VzcyIsInIiLCJyZW1vdmVfcGxhbl9lbCIsInRyaWdnZXJfdXBkYXRlX2hvb2siLCJtZXNzYWdlIiwiYWxlcnQiLCJpZCIsIiRjb250cm9scyIsImlzIiwib3BlcmF0b3IiLCIkYyIsIiRlbHMiLCJub2RlTmFtZSIsImVxdWFscyIsIm5vdF9lcXVhbHMiLCJnZXRfcGxhbnNfYXJyYXkiLCJ0cmlnZ2VyU2F2ZSIsImZvcm0iLCJzZXJpYWxpemVBcnJheSIsInBsYW5zIiwiaSIsIm5hbWUiLCJpbmRleE9mIiwia2V5cyIsInJlcGxhY2UiLCJzcGxpdCIsImluZGV4IiwicHVzaCIsInZhbHVlIiwicHJvZHVjdCIsImFjY2Vzc19wbGFuX2xpbWl0IiwiJGNsb25lIiwiY2xvbmUiLCIkZXhpc3RpbmdfcGxhbnMiLCIkZWRpdG9yIiwiYXBwZW5kVG8iLCJkb2N1bWVudCIsIm5vdCIsImZpcnN0IiwiY29tcGxldGUiLCJlcnJvciIsImpxWEhSIiwidGV4dFN0YXR1cyIsImVycm9yVGhyb3duIiwiY29uc29sZSIsInJlcyIsImNvZGUiLCJyZXBsYWNlV2l0aCIsInN0YXR1cyIsImZhZGVPdXQiLCJyZW1vdmUiLCIkcCIsIiRvcmRlciIsImVkaXRvcl9pZCIsIm9yaWciLCJjdXJyIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FNQSxTQUFZQSxHQUVYQyxPQUFPQyxLQUFPRCxPQUFPQyxNQUFRLEdBRTdCRCxPQUFPQyxLQUFLQyxnQkFBa0IsV0FNN0JDLEtBQUtDLE9BQVMsS0FPZEQsS0FBS0UsUUFBVUMsS0FBS0MsTUFBeUIsS0FBaEJELEtBQUtFLFNBQW9CLEtBTXRETCxLQUFLTSxpQkFBbUIsZUFTeEJOLEtBQUtPLEtBQU8sU0FBVUMsR0FFckIsSUFBSUMsRUFBT1QsS0FFWFMsRUFBS1IsT0FBU0wsRUFBRyxzQkFFakJhLEVBQUtDLGtCQUVMLElBQUlDLEVBQU1mLEVBQUcseURBRWIsR0FBT2UsRUFBSUMsT0FFSixHQUFLSixFQUNYQyxFQUFLSSxXQURDLENBS1BDLEtBQUtDLFFBQVFDLE1BQU9MLEdBSXBCLElBQ0NNLEVBREdDLEVBQVUsRUFHZEQsRUFBV0UsWUFBYSxXQUd2QixHQUFnQixLQUFYRCxFQUVKUCxFQUFJUyxLQUFNTixLQUFLTyxLQUFLQyxVQUFXLDhFQUkzQixDQUFBLEdBQUssb0JBQXVCQyxRQUdoQyxZQURBTCxJQU9BVCxFQUFLSSxPQUlOVyxjQUFlUCxHQUNmSCxLQUFLQyxRQUFRVSxLQUFNZCxJQUVqQixPQVlKWCxLQUFLYSxLQUFPLFdBRVgsSUFBSUosRUFBT1QsS0FFTlMsRUFBS2lCLCtCQUNUakIsRUFBS2tCLHVCQUlOL0IsRUFBRywyQkFBNEJnQyxHQUFJLFFBQVMsU0FBVUMsR0FDckRBLEVBQUVDLGlCQUNGckIsRUFBS3NCLGVBSU50QixFQUFLUixPQUFPMkIsR0FBSSxTQUFVLHVCQUF3QixXQUNqRG5CLEVBQUt1QixrQkFBbUJwQyxFQUFHSSxTQUc1QkosRUFBRyxtREFBb0RxQyxXQUFZLENBQ2xFQyxXQUFZLGFBSWJ0QyxFQUFHLDJDQUE0Q3VDLFFBQVMsVUFHeER2QyxFQUFHLHlCQUEwQmdDLEdBQUksUUFBUyxXQUN6QyxJQUFJUSxFQUFNeEMsRUFBR0ksTUFDYlMsRUFBSzRCLFlBQ0xELEVBQUlFLEtBQU0sV0FBWSxZQUN0QkMsV0FBWSxXQUNKOUIsRUFBS2lCLCtCQUNYVSxFQUFJSSxXQUFZLGFBRWYsT0FHSi9CLEVBQUtSLE9BQU93QyxTQUFVLENBQ3JCQyxPQUFRLG9CQUNSQyxNQUFPLG9CQUNQM0IsTUFBTyxTQUFVNEIsRUFBT0MsR0FDdkJwQyxFQUFLUixPQUFPNkMsU0FBVSxhQUV2QnJCLEtBQU0sU0FBVW1CLEVBQU9DLEdBQ3RCcEMsRUFBS1IsT0FBTzhDLFlBQWEsWUFDekJ0QyxFQUFLdUMsd0JBS1B2QyxFQUFLUixPQUFPMkIsR0FBSSxRQUFTLHdCQUF5QixXQUVqRCxJQUFJcUIsRUFBU3JELEVBQUdJLE1BRWZrRCxFQURRRCxFQUFPRSxRQUFTLHFCQUNQQyxLQUFNLHdCQUN2QkMsRUFBTUosRUFBT0ksTUFDYkMsRUFBUSxHQUFnQkosRUFBU1osS0FBTSxnQkFFeENZLEVBQVNLLEtBQU1ELEtBS2hCN0MsRUFBS1IsT0FBTzJCLEdBQUksaUNBQWtDLFFBQVMsU0FBVUMsRUFBRzJCLEdBRXZFLElBQUlQLEVBQVNyRCxFQUFHSSxNQUVYaUQsRUFBTyxHQUFHUSxnQkFDZFIsRUFBT0YsWUFBYXRDLEVBQUtILG1CQUV6QjJDLEVBQU9ILFNBQVVyQyxFQUFLSCxrQkFDakIsVUFBWXVCLEVBQUU2QixNQUNsQlQsRUFBTyxHQUFHVSxrQkFJTEgsSUFBUUEsRUFBS0ksU0FDbkJYLEVBQU9FLFFBQVMscUJBQXNCaEIsUUFBUyx3QkFNakQxQixFQUFLUixPQUFPMkIsR0FBSSxxQkFBc0Isb0JBQXFCLFdBRTFELElBQUlpQyxFQUFRakUsRUFBR0ksTUFFZjZELEVBQU1ULEtBQU0sU0FBVVUsS0FBTSxXQUMzQmxFLEVBQUdJLE1BQU9tQyxRQUFTLDJCQUE0QixDQUFFeUIsU0FBUyxNQUd0REMsRUFBTVQsS0FBTSxJQUFNM0MsRUFBS0gsa0JBQW1CTSxPQUM5Q2lELEVBQU1mLFNBQVVyQyxFQUFLSCxrQkFFckJ1RCxFQUFNZCxZQUFhdEMsRUFBS0gsb0JBSzFCRyxFQUFLUixPQUFPMkIsR0FBSSwyQkFBNEIsb0JBQXFCLFdBRWhFLElBQUlpQyxFQUFRakUsRUFBR0ksTUFFVjZELEVBQU1FLFNBQVUsV0FFcEJ4QixXQUFZLFdBQ1hzQixFQUFNVCxLQUFNLHNCQUF1QlUsS0FBTSxXQUN4Q2xFLEVBQUdJLE1BQU8sR0FBRzJELG9CQUVaLE9BS0xsRCxFQUFLUixPQUFPMkIsR0FBSSxRQUFTLG9CQUFxQixTQUFVQyxHQUN2REEsRUFBRW1DLGtCQUNGdkQsRUFBS3dELFlBQWFyRSxFQUFHSSxTQUl0QkgsT0FBT0MsS0FBS29FLFVBQVVDLFlBQWF2RSxFQUFHLHVEQUl0Q0EsRUFBRyxtREFBb0QwQyxLQUFNLFdBQVksWUFDekVmLFFBQVE2QyxjQUFjQyxZQUFhLG1CQUFtQixFQUFNLG1EQVU3RHJFLEtBQUtVLGdCQUFrQixXQUV0QixJQUFJNEQsRUFBVTFFLEVBQUcsbUNBQ2hCMkUsRUFBVTNFLEVBQUcsa0NBQ2I0RSxFQUFRNUUsRUFBRyxrQ0FDWDZFLEVBQVc3RSxFQUFHLG9DQUVmMkUsRUFBUTNDLEdBQUksUUFBUyxTQUFVQyxHQUM5QkEsRUFBRUMsaUJBQ0Z3QyxFQUFRSSxVQUFXLFFBQ25CSCxFQUFRSSxTQUdUSCxFQUFNNUMsR0FBSSxRQUFTLFNBQVVDLEdBQzVCQSxFQUFFQyxpQkFDRndDLEVBQVFNLFFBQVMsUUFDakJMLEVBQVFNLE9BQ1JqRixFQUFHLG9DQUFxQzJELEtBQU0zRCxFQUFHLDBDQUEyQzBDLEtBQU0saUJBR25HbUMsRUFBUTdDLEdBQUksUUFBUyxTQUFVQyxHQUM5QkEsRUFBRUMsaUJBQ0Z3QyxFQUFRTSxRQUFTLFFBQ2pCTCxFQUFRTSxVQWlCVjdFLEtBQUtpRSxZQUFjLFNBQVVhLEdBRTVCLElBQUlyRSxFQUFPVCxLQUNWNkQsRUFBUWlCLEVBQUszQixRQUFTLHFCQUN0QjRCLEVBQVVsQixFQUFNdkIsS0FBTSxXQUN0QjBDLEVBQVVsRSxLQUFLTyxLQUFLQyxVQUFXLG9SQUd6QnlELEVBS0tsRixPQUFPb0YsUUFBU0QsS0FFM0JsRSxLQUFLQyxRQUFRQyxNQUFPNkMsR0FDcEJoRSxPQUFPaUIsS0FBS29FLEtBQUtDLEtBQU0sQ0FDdEIzQixLQUFNLENBQ0w0QixPQUFRLHFCQUNSTCxRQUFTQSxHQUVWTSxRQUFTLFNBQVVDLEdBQ2xCeEUsS0FBS0MsUUFBUVUsS0FBTW9DLEdBQ2R5QixFQUFFRCxTQUNONUUsRUFBSzhFLGVBQWdCMUIsR0FDckJwRCxFQUFLK0UsdUJBQ01GLEVBQUVHLFNBQ2JDLE1BQU9KLEVBQUVHLGFBakJaaEYsRUFBSzhFLGVBQWdCMUIsSUFtQ3ZCN0QsS0FBS2dDLGtCQUFvQixTQUFVSSxHQUVsQyxJQUFJdUQsRUFBS3ZELEVBQUlFLEtBQU0sc0JBQ2xCZSxFQUFNakIsRUFBSWlCLE1BRVZ1QyxFQURReEQsRUFBSWUsUUFBUyxxQkFDSEMsS0FBTSxxQkFBdUJ1QyxFQUFLLE1BRWhELGFBQWV2RCxFQUFJRSxLQUFNLFVBQzdCZSxFQUFRakIsRUFBSXlELEdBQUksWUFBaUJ4QyxFQUFNLE1BR3hDdUMsRUFBVTlCLEtBQU0sV0FFZixJQUlDc0IsRUFBUVUsRUFKTEMsRUFBS25HLEVBQUdJLE1BQ1hnRyxFQUFTLFdBQWFELEVBQUcsR0FBR0UsVUFBWSxVQUFhRixFQUFHLEdBQUdFLFVBQVksYUFBZ0JGLEVBQUcsR0FBR0UsU0FBYUYsRUFBS0EsRUFBRzNDLEtBQU0sMkJBQ3hIOEMsRUFBU0gsRUFBR3pELEtBQU0saUJBQ2xCNkQsRUFBYUosRUFBR3pELEtBQU0scUJBYXZCLFlBVnVCLElBQVg0RCxJQUEwQyxJQUFYQSxFQUUxQ0osRUFBVyxVQUVzQixJQUFmSyxJQUFrRCxJQUFmQSxJQUVyREwsRUFBVyxNQUlIQSxHQUVSLElBQUssS0FHSFYsRUFESS9CLEdBQU82QyxFQUNGLE9BRUEsT0FHWCxNQUVBLElBQUssS0FHSGQsRUFESS9CLEdBQU84QyxFQUNGLE9BRUEsT0FPUCxTQUFXZixHQUNmVyxFQUFHbEIsT0FDSG1CLEVBQUt4RCxXQUFZLFlBQWFMLFFBQVMsV0FDNUIsU0FBV2lELElBQ3RCVyxFQUFHcEIsT0FDSHFCLEVBQUsxRCxLQUFNLFdBQVksZ0JBYzFCdEMsS0FBS29HLGdCQUFrQixXQUd0QjdFLFFBQVE4RSxjQU1SLElBSkEsSUFDQ0MsRUFEVXRHLEtBQ0VDLE9BQU9rRCxRQUFTLFFBQVNvRCxpQkFDckNDLEVBQVEsR0FFQ0MsRUFBSSxFQUFHQSxFQUFJSCxFQUFLMUYsT0FBUTZGLElBR2pDLElBQU0sSUFBTUgsRUFBTUcsR0FBSUMsS0FBS0MsUUFBUyxlQUFwQyxDQUlBLElBQUlDLEVBQU9OLEVBQU1HLEdBQUlDLEtBQUtHLFFBQVMsZUFBZ0IsSUFBS0MsTUFBTyxNQUM5REMsRUFBb0IsRUFBVkgsRUFBSyxHQUFXLEVBQzFCRixFQUFPRSxFQUFLLEdBQUdDLFFBQVMsSUFBSyxJQUM3Qm5ELEVBQU8sSUFBTWtELEVBQUtoRyxPQUFTLFFBQVUsU0FFL0I0RixFQUFPTyxLQUNiUCxFQUFPTyxHQUFVLElBR2IsVUFBWXJELEdBRVQ4QyxFQUFPTyxHQUFTTCxLQUN0QkYsRUFBT08sR0FBU0wsR0FBUyxJQUUxQkYsRUFBT08sR0FBU0wsR0FBT00sS0FBTVYsRUFBTUcsR0FBSVEsUUFJdkNULEVBQU9PLEdBQVNMLEdBQVNKLEVBQU1HLEdBQUlRLE1BTXJDLE9BQU9ULEdBVVJ4RyxLQUFLMEIsNEJBQThCLFdBS2xDLE9BSFk3QixPQUFPQyxLQUFLb0gsUUFBUUMsbUJBQ3hCdkgsRUFBRyx3Q0FBeUNnQixRQVlyRFosS0FBS3FDLFVBQVksV0FHaEIsSUFBS3JDLEtBQUswQiw4QkFBVixDQUlBLElBQUkwRixFQUFTeEgsRUFBRywrQkFBZ0N5SCxRQUMvQ0MsZ0JBQWtCMUgsRUFBRyx3Q0FDckIySCxRQUFVSCxFQUFPaEUsS0FBTSxtREFHeEJnRSxFQUFPNUUsV0FBWSxNQUduQitFLFFBQVEvRSxXQUFZLE1BQU9GLEtBQU0sS0FBTSx1QkFBeUJ0QyxLQUFLRSxTQUNyRUYsS0FBS0UsVUFJTGtILEVBQU9oRSxLQUFNLDJCQUE0QlUsS0FBTSxXQUM5Q2xFLEVBQUdJLE1BQU93QyxXQUFZLGNBSXZCNEUsRUFBT2hFLEtBQU0sZ0NBQWlDbkIsV0FBWSxDQUN6REMsV0FBWSxhQUdia0YsRUFBT0ksU0FBVSxzQkFHakJ4SCxLQUFLZ0QscUJBRUxvRSxFQUFPaEUsS0FBTSw0QkFBNkJqQixRQUFTLFNBRzlDbkMsS0FBSzBCLCtCQUNUMUIsS0FBSzJCLHFCQUFzQixXQUk1QjlCLE9BQU9DLEtBQUtvRSxVQUFVQyxZQUFhaUQsRUFBT2hFLEtBQU0sb0NBRWhEZ0UsRUFBT2hFLEtBQU0sd0JBQXlCakIsUUFBUyxVQUMvQ3ZDLEVBQUc2SCxVQUFXdEYsUUFBUyxpQkFBa0JpRixLQVcxQ3BILEtBQUsrQixXQUFhLFdBRWpCLElBQUl0QixFQUFPVCxLQUVYUyxFQUFLUixPQUFPbUQsS0FBTSxxQkFBc0JVLEtBQU0sV0FDN0NsRSxFQUFHSSxNQUFPbUMsUUFBUyx3QkFHZjFCLEVBQUtSLE9BQU9tRCxLQUFNLElBQU0zQyxFQUFLSCxrQkFBbUJNLE9BQ3BESCxFQUFLUixPQUFPbUQsS0FBTSxxQkFBdUIzQyxFQUFLSCxrQkFBbUJvSCxJQUFLLFdBQVlDLFFBQVF2RSxLQUFNLDRCQUE2QmpCLFFBQVMsVUFJdklyQixLQUFLQyxRQUFRQyxNQUFPUCxFQUFLUixRQUN6QkosT0FBT2lCLEtBQUtvRSxLQUFLQyxLQUFNLENBQ3RCM0IsS0FBTSxDQUNMNEIsT0FBUSwyQkFDUm9CLE1BQU8vRixFQUFLMkYsbUJBRWJ3QixTQUFVLFdBQ1Q5RyxLQUFLQyxRQUFRVSxLQUFNaEIsRUFBS1IsU0FFekI0SCxNQUFPLFNBQVVDLEVBQU9DLEVBQVlDLEdBQ25DQyxRQUFRSixNQUFPLDBDQUEyQ0MsR0FDMURwQyxNQUFPNUUsS0FBS08sS0FBS0MsVUFBVyxzRUFBeUUsS0FBUXlHLEVBQWEsS0FBT0MsRUFBYyxNQUVoSjNDLFFBQVMsU0FBVTZDLElBRVhBLEVBQUk3QyxTQUFXNkMsRUFBSUMsTUFBUSxVQUFZRCxFQUFJQyxLQUNqRHpDLE1BQU93QyxFQUFJekMsU0FDQXlDLEVBQUkxRSxNQUFRMEUsRUFBSTFFLEtBQUtwQyxPQUdoQ3hCLEVBQUcsc0NBQXVDd0ksWUFBYUYsRUFBSTFFLEtBQUtwQyxNQUdoRVgsRUFBS0YsTUFBTSxHQUNYVixPQUFPQyxLQUFLb0UsVUFBVTNELE9BQ3RCRSxFQUFLdUMscUJBR0x2QyxFQUFLK0UsNEJBa0JUeEYsS0FBSzJCLHFCQUF1QixTQUFVMEcsR0FFckMsSUFBSXZELEVBQU9sRixFQUFHLHlCQUVULFlBQWN5SSxFQUNsQnZELEVBQUt4QyxLQUFNLFdBQVksWUFFdkJ3QyxFQUFLdEMsV0FBWSxhQWNuQnhDLEtBQUt1RixlQUFpQixTQUFVMUIsR0FFL0IsSUFBSXBELEVBQU9ULEtBR1g2RCxFQUFNeUUsUUFBUyxLQUdmL0YsV0FBVyxXQUVWc0IsRUFBTTBFLFNBR0M5SCxFQUFLaUIsK0JBQ1hqQixFQUFLa0IscUJBQXNCLFdBRTFCLE1BV0ozQixLQUFLd0Ysb0JBQXNCLFdBRTFCNUYsRUFBRzZILFVBQVd0RixRQUFTLDhCQWF4Qm5DLEtBQUtnRCxtQkFBcUIsV0FFekJwRCxFQUFHLHdDQUF5Q2tFLEtBQU0sV0FFakQsSUFBSTBFLEVBQUs1SSxFQUFHSSxNQUNYeUksRUFBU0QsRUFBR3BGLEtBQU0sZUFFbEJzRixFQURVRixFQUFHcEYsS0FBTSx3Q0FDQ2QsS0FBTSxNQUMxQnFHLEVBQXNCLEVBQWZGLEVBQU9wRixNQUNkdUYsRUFBT0osRUFBR3pCLFFBR1h4RixRQUFRNkMsY0FBY0MsWUFBYSxtQkFBbUIsRUFBTXFFLEdBRzVERixFQUFHcEYsS0FBTSwyQkFBNEJVLEtBQU0sV0FFMUMsSUFBSTRDLEVBQU85RyxFQUFHSSxNQUFPc0MsS0FBTSxRQUN0Qm9FLEdBQ0o5RyxFQUFHSSxNQUFPc0MsS0FBTSxPQUFRb0UsRUFBS0csUUFBUzhCLEVBQU1DLE1BTTlDckgsUUFBUTZDLGNBQWNDLFlBQWEsZ0JBQWdCLEVBQU1xRSxHQUV6REQsRUFBT3BGLElBQUt1RixNQU9kNUksS0FBS08sUUFJRSxJQUFJVixPQUFPQyxLQUFLQyxnQkEzcEJ6QixDQTZwQks4SSIsImZpbGUiOiJsbG1zLW1ldGFib3gtcHJvZHVjdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFByb2R1Y3QgT3B0aW9ucyBNZXRhQm94XG4gKiBEaXNwbGF5cyBvbiBDb3Vyc2UgJiBNZW1iZXJzaGlwIFBvc3QgVHlwZXNcbiAqIEBzaW5jZSAgICAzLjAuMFxuICogQHZlcnNpb24gIDMuMjMuMFxuICovXG4oIGZ1bmN0aW9uKCAkICkge1xuXG5cdHdpbmRvdy5sbG1zID0gd2luZG93LmxsbXMgfHwge307XG5cblx0d2luZG93LmxsbXMubWV0YWJveF9wcm9kdWN0ID0gZnVuY3Rpb24oKSB7XG5cblx0XHQvKipcblx0XHQgKiBqUXVlcnkgb2JqIGZvciB0aGUgbWFpbiAkKCAnI2xsbXMtYWNjZXNzLXBsYW5zJyApIGVsZW1lbnQuXG5cdFx0ICogQHR5cGUgb2JqXG5cdFx0ICovXG5cdFx0dGhpcy4kcGxhbnMgPSBudWxsO1xuXG5cdFx0LyoqXG5cdFx0ICogQSByYW5kb21seSBnZW5lcmF0ZWQgdGVtcG9yYXJ5IElEIHVzZWQgZm9yIHRoZSB0aW55TUNFIGVkaXRvcidzIGlkXG5cdFx0ICogd2hlbiBhIG5ldyBwbGFuIGlzIGFkZGVkXG5cdFx0ICogQHR5cGUgaW50XG5cdFx0ICovXG5cdFx0dGhpcy50ZW1wX2lkID0gTWF0aC5mbG9vciggKCBNYXRoLnJhbmRvbSgpICogNzc3NyApICsgNzc3ICk7XG5cblx0XHQvKipcblx0XHQgKiBDU1MgY2xhc3MgbmFtZSB1c2VkIHRvIGhpZ2hsaWdodCB2YWxpZGF0aW9uIGVycm9ycyBmb3IgcGxhbiBmaWVsZHNcblx0XHQgKiBAdHlwZSBzdHJpbmdcblx0XHQgKi9cblx0XHR0aGlzLnZhbGlkYXRpb25fY2xhc3MgPSAnbGxtcy1pbnZhbGlkJztcblxuXHRcdC8qKlxuXHRcdCAqIEluaXRpYWxpemVcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gIHZvaWRcblx0XHQgKiBAc2luY2UgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuNi4wXG5cdFx0ICovXG5cdFx0dGhpcy5pbml0ID0gZnVuY3Rpb24oIHNraXBfZGVwX2NoZWNrcyApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRzZWxmLiRwbGFucyA9ICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdHNlbGYuYmluZF92aXNpYmlsaXR5KCk7XG5cblx0XHRcdHZhciAkbWIgPSAkKCAnI2xpZnRlcmxtcy1wcm9kdWN0ICNsbG1zLXByb2R1Y3Qtb3B0aW9ucy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdGlmICggISAkbWIubGVuZ3RoICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2UgaWYgKCBza2lwX2RlcF9jaGVja3MgKSB7XG5cdFx0XHRcdHNlbGYuYmluZCgpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdExMTVMuU3Bpbm5lci5zdGFydCggJG1iICk7XG5cblx0XHRcdC8vIHdlIHJlbHkgb24gVGlueU1DRSBidXQgV29yZFByZXNzIGRvZXNuJ3QgcmVnaXN0ZXIgVGlueU1DRVxuXHRcdFx0Ly8gbGlrZSBldmVyeSBvdGhlciBhZG1pbiBzY3JpcHQgc28gd2UnbGwgZG8gYSBsaXR0bGUgZGVwZW5kZW5jeSBjaGVjayBoZXJlLi4uXG5cdFx0XHR2YXIgY291bnRlciA9IDAsXG5cdFx0XHRcdGludGVydmFsO1xuXG5cdFx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHQvLyBpZiB3ZSBnZXQgdG8gMzAgc2Vjb25kcyBkaXNwbGF5IGFuIGVycm9yIG1lc3NhZ2Vcblx0XHRcdFx0aWYgKCBjb3VudGVyID49IDMwMCApIHtcblxuXHRcdFx0XHRcdCRtYi5odG1sKCBMTE1TLmwxMG4udHJhbnNsYXRlKCAnVGhlcmUgd2FzIGFuIGVycm9yIGxvYWRpbmcgdGhlIG5lY2Vzc2FyeSByZXNvdXJjZXMuIFBsZWFzZSB0cnkgYWdhaW4uJyApICk7XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBpZiB3ZSBjYW4ndCBhY2Nlc3MgdGlueU1DRSwgaW5jcmVtZW50IGFuZCB3YWl0Li4uXG5cdFx0XHRcdGVsc2UgaWYgKCAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHRpbnlNQ0UgKSB7XG5cblx0XHRcdFx0XHRjb3VudGVyKys7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gYmluZCB0aGUgZXZlbnRzLCB3ZSdyZSBnb29kIVxuXHRcdFx0XHRlbHNlIHtcblxuXHRcdFx0XHRcdHNlbGYuYmluZCgpO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjbGVhckludGVydmFsKCBpbnRlcnZhbCApO1xuXHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJG1iICk7XG5cblx0XHRcdH0sIDEwMCApO1xuXG5cdFx0fTtcblxuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBET00gRXZlbnRzXG5cdFx0ICpcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy5iaW5kID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdFx0aWYgKCBzZWxmLmhhc19wbGFuX2xpbWl0X2JlZW5fcmVhY2hlZCgpICkge1xuXHRcdFx0XHRzZWxmLnRvZ2dsZV9jcmVhdGVfYnV0dG9uKCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIHNhdmUgYWNjZXNzIHBsYW5zIGJ1dHRvbi5cblx0XHRcdCQoICcjbGxtcy1zYXZlLWFjY2Vzcy1wbGFucycgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0c2VsZi5zYXZlX3BsYW5zKCk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIGJpbmQgY2hhbmdlIGV2ZW50cyB0byBmb3JtIGVsZW1lbnQgdGhhdCBjb250cm9scyBhbm90aGVyIGZvcm0gZWxlbWVudFxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdjaGFuZ2UnLCAnW2RhdGEtY29udHJvbGxlci1pZF0nLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0c2VsZi5jb250cm9sbGVyX2NoYW5nZSggJCggdGhpcyApICk7XG5cdFx0XHR9IClcblxuXHRcdFx0JCggJyNsbG1zLWFjY2Vzcy1wbGFucyAubGxtcy1hY2Nlc3MtcGxhbi1kYXRlcGlja2VyJyApLmRhdGVwaWNrZXIoIHtcblx0XHRcdFx0ZGF0ZUZvcm1hdDogXCJtbS9kZC95eVwiXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIHRyaWdnZXIgY2hhbmdlcyBvbiBsb2FkIGZvciBhbGwgZXhpc3RpbmcgcGxhbnNcblx0XHRcdCQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgW2RhdGEtY29udHJvbGxlci1pZF0nICkudHJpZ2dlciggJ2NoYW5nZScgKTtcblxuXHRcdFx0Ly8gYWRkIGEgbmV3IGVtcHR5IHBsYW4gaW50ZXJmYWNlIG9uIG5ldyBwbGFuIGJ1dHRvbiBjbGljay5cblx0XHRcdCQoICcjbGxtcy1uZXctYWNjZXNzLXBsYW4nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgJGVsID0gJCggdGhpcyApO1xuXHRcdFx0XHRzZWxmLmluaXRfcGxhbigpO1xuXHRcdFx0XHQkZWwuYXR0ciggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuXHRcdFx0XHRzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAoICEgc2VsZi5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQoKSApIHtcblx0XHRcdFx0XHRcdCRlbC5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCA1MDAgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0c2VsZi4kcGxhbnMuc29ydGFibGUoIHtcblx0XHRcdFx0aGFuZGxlOiAnLmxsbXMtZHJhZy1oYW5kbGUnLFxuXHRcdFx0XHRpdGVtczogJy5sbG1zLWFjY2Vzcy1wbGFuJyxcblx0XHRcdFx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XG5cdFx0XHRcdFx0c2VsZi4kcGxhbnMuYWRkQ2xhc3MoICdkcmFnZ2luZycgKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcblx0XHRcdFx0XHRzZWxmLiRwbGFucy5yZW1vdmVDbGFzcyggJ2RyYWdnaW5nJyApO1xuXHRcdFx0XHRcdHNlbGYudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cdFx0XHRcdH0sXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIGJpbmQgdGV4dCBlbnRlcmVkIGludG8gdGhlIHRpdGxlIHRvIHRoZSBkaXNwbGF5ZWQgdGl0bGUgZm9yIGZhbmN5IGZ1blxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdrZXl1cCcsICdpbnB1dC5sbG1zLXBsYW4tdGl0bGUnLCBmdW5jdGlvbiggKSB7XG5cblx0XHRcdFx0dmFyICRpbnB1dCA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQkcGxhbiA9ICRpbnB1dC5jbG9zZXN0KCAnLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdFx0JGRpc3BsYXkgPSAkcGxhbi5maW5kKCAnc3Bhbi5sbG1zLXBsYW4tdGl0bGUnICksXG5cdFx0XHRcdFx0dmFsID0gJGlucHV0LnZhbCgpLFxuXHRcdFx0XHRcdHRpdGxlID0gKCB2YWwgKSA/IHZhbCA6ICRkaXNwbGF5LmF0dHIoICdkYXRhLWRlZmF1bHQnICk7XG5cblx0XHRcdFx0JGRpc3BsYXkudGV4dCggdGl0bGUgKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBWYWxpZGF0ZSBhIHNpbmdsZSBpbnB1dCBmaWVsZFxuXHRcdFx0c2VsZi4kcGxhbnMub24oICdrZXl1cCBsbG1zLXZhbGlkYXRlLXBsYW4tZmllbGQnLCAnaW5wdXQnLCBmdW5jdGlvbiggZSwgZGF0YSApIHtcblxuXHRcdFx0XHR2YXIgJGlucHV0ID0gJCggdGhpcyApO1xuXG5cdFx0XHRcdGlmICggJGlucHV0WzBdLmNoZWNrVmFsaWRpdHkoKSApIHtcblx0XHRcdFx0XHQkaW5wdXQucmVtb3ZlQ2xhc3MoIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCRpbnB1dC5hZGRDbGFzcyggc2VsZi52YWxpZGF0aW9uX2NsYXNzICk7XG5cdFx0XHRcdFx0aWYgKCAna2V5dXAnID09PSBlLnR5cGUgKSB7XG5cdFx0XHRcdFx0XHQkaW5wdXRbMF0ucmVwb3J0VmFsaWRpdHkoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoICEgZGF0YSB8fCBkYXRhLmNhc2NhZGUgKSB7XG5cdFx0XHRcdFx0JGlucHV0LmNsb3Nlc3QoICcubGxtcy1hY2Nlc3MtcGxhbicgKS50cmlnZ2VyKCAnbGxtcy12YWxpZGF0ZS1wbGFuJyApO1xuXHRcdFx0XHR9XG5cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2xsbXMtdmFsaWRhdGUtcGxhbicsICcubGxtcy1hY2Nlc3MtcGxhbicsIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkcGxhbiA9ICQoIHRoaXMgKTtcblxuXHRcdFx0XHQkcGxhbi5maW5kKCAnaW5wdXQnICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JCggdGhpcyApLnRyaWdnZXIoICdsbG1zLXZhbGlkYXRlLXBsYW4tZmllbGQnLCB7IGNhc2NhZGU6IGZhbHNlIH0gKTtcblx0XHRcdFx0fSApO1xuXG5cdFx0XHRcdGlmICggJHBsYW4uZmluZCggJy4nICsgc2VsZi52YWxpZGF0aW9uX2NsYXNzICkubGVuZ3RoICkge1xuXHRcdFx0XHRcdCRwbGFuLmFkZENsYXNzKCBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkcGxhbi5yZW1vdmVDbGFzcyggc2VsZi52YWxpZGF0aW9uX2NsYXNzICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5vbiggJ2xsbXMtY29sbGFwc2libGUtdG9nZ2xlZCcsICcubGxtcy1hY2Nlc3MtcGxhbicsIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkcGxhbiA9ICQoIHRoaXMgKTtcblxuXHRcdFx0XHRpZiAoICRwbGFuLmhhc0NsYXNzKCAnb3BlbmVkJyApICkge1xuXHRcdFx0XHRcdC8vIHdhaXQgZm9yIGFuaW1hdGlvbiB0byBjb21wbGV0ZSB0byBwcmV2ZW50IGZvY3VzYWJsZSBlcnJvcnMgaW4gdGhlIGNvbnNvbGUuXG5cdFx0XHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQkcGxhbi5maW5kKCAnaW5wdXQubGxtcy1pbnZhbGlkJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHQkKCB0aGlzIClbMF0ucmVwb3J0VmFsaWRpdHkoKTtcblx0XHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0XHR9LCA1MDAgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHRcdHNlbGYuJHBsYW5zLm9uKCAnY2xpY2snLCAnLmxsbXMtcGxhbi1kZWxldGUnLCBmdW5jdGlvbiggZSApIHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0c2VsZi5kZWxldGVfcGxhbiggJCggdGhpcyApICk7XG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIHNlbGVjdDJpZnkgbWVtYmVyc2hpcCBhdmFpbGFiaWxpdHkgZmllbGRzXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYXZhaWxhYmlsaXR5LXJlc3RyaWN0aW9ucycgKSApO1xuXG5cdFx0XHQvLyBkaXNhYmxlIHRoZSB0ZXh0YXJlYSBnZW5lcmF0ZWQgYnkgdGhlIHdwX2VkaXRvciBmdW5jdGlvblxuXHRcdFx0Ly8gY2FuJ3QgZmlndXJlIG91dCBob3cgdG8gZG8gdGhpcyBkdXJpbmcgaW5pdGlhbGl6YXRpb25cblx0XHRcdCQoICcjX2xsbXNfcGxhbnNfY29udGVudF9sbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKS5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHR0aW55TUNFLkVkaXRvck1hbmFnZXIuZXhlY0NvbW1hbmQoICdtY2VSZW1vdmVFZGl0b3InLCB0cnVlLCAnX2xsbXNfcGxhbnNfY29udGVudF9sbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIERPTSBldmVudHMgZm9yIGVkaXRpbmcgcHJvZHVjdCB2aXNpYmlsaXR5XG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy42LjBcblx0XHQgKiBAdmVyc2lvbiAgMy42LjBcblx0XHQgKi9cblx0XHR0aGlzLmJpbmRfdmlzaWJpbGl0eSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgJHJhZGlvcyA9ICQoICcjbGxtcy1jYXRhbG9nLXZpc2liaWxpdHktc2VsZWN0JyApLFxuXHRcdFx0XHQkdG9nZ2xlID0gJCggJ2EubGxtcy1lZGl0LWNhdGFsb2ctdmlzaWJpbGl0eScgKSxcblx0XHRcdFx0JHNhdmUgPSAkKCAnYS5sbG1zLXNhdmUtY2F0YWxvZy12aXNpYmlsaXR5JyApLFxuXHRcdFx0XHQkY2FuY2VsID0gICQoICdhLmxsbXMtY2FuY2VsLWNhdGFsb2ctdmlzaWJpbGl0eScgKTtcblxuXHRcdFx0JHRvZ2dsZS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0JHJhZGlvcy5zbGlkZURvd24oICdmYXN0JyApO1xuXHRcdFx0XHQkdG9nZ2xlLmhpZGUoKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0JHNhdmUub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCRyYWRpb3Muc2xpZGVVcCggJ2Zhc3QnICk7XG5cdFx0XHRcdCR0b2dnbGUuc2hvdygpO1xuXHRcdFx0XHQkKCAnI2xsbXMtY2F0YWxvZy12aXNpYmlsaXR5LWRpc3BsYXknICkudGV4dCggJCggJ2lucHV0W25hbWU9XCJfbGxtc192aXNpYmlsaXR5XCJdOmNoZWNrZWQnICkuYXR0ciggJ2RhdGEtbGFiZWwnICkgKTtcblx0XHRcdH0gKTtcblxuXHRcdFx0JGNhbmNlbC5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0JHJhZGlvcy5zbGlkZVVwKCAnZmFzdCcgKTtcblx0XHRcdFx0JHRvZ2dsZS5zaG93KCk7XG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogSGFuZGxlIHBoeXNpY2FsIGRlbGV0aW9uIG9mIGEgcGxhbiBlbGVtZW50XG5cdFx0ICogSWYgdGhlIHBsYW4gaGFzbid0IGJlIHBlcnNpc3RlZCB0byB0aGUgZGF0YWJzZSBpdCdzIHJlbW92ZWQgZnJvbSB0aGUgZG9tXG5cdFx0ICogaWYgaXQgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGRhdGFiYXNlIGEgY29uZmlybSBtb2RhbCBpcyBkaXNwbGF5ZWRcblx0XHQgKiB1cG9uIGNvbmZpcm1hdGlvbiBBSkFYIGNhbGwgd2lsbCBiZSBtYWRlIHRvIG1vdmUgdGhlIHBsYW4gdG8gdGhlIHRyYXNoXG5cdFx0ICogYW5kIHVwb24gc3VjY2VzcyB0aGUgZWxlbWVudCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgZG9tXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIG9iaiAkYnRuIGpRdWVyeSBzZWxlY3RvciBvZiB0aGUgXCJYXCIgYnV0dG9uIGNsaWNrZWQgdG8gaW5pdGlhdGUgZGVsZXRpb25cblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIFt2ZXJzaW9uXVxuXHRcdCAqL1xuXHRcdHRoaXMuZGVsZXRlX3BsYW4gPSBmdW5jdGlvbiggJGJ0biApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHQkcGxhbiA9ICRidG4uY2xvc2VzdCggJy5sbG1zLWFjY2Vzcy1wbGFuJyApLFxuXHRcdFx0XHRwbGFuX2lkID0gJHBsYW4uYXR0ciggJ2RhdGEtaWQnICksXG5cdFx0XHRcdHdhcm5pbmcgPSBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQWZ0ZXIgZGVsZXRpbmcgdGhpcyBhY2Nlc3MgcGxhbiwgYW55IHN0dWRlbnRzIHN1YnNjcmliZWQgdG8gdGhpcyBwbGFuIHdpbGwgc3RpbGwgaGF2ZSBhY2Nlc3MgYW5kIHdpbGwgY29udGludWUgdG8gbWFrZSByZWN1cnJpbmcgcGF5bWVudHMgYWNjb3JkaW5nIHRvIHRoZSBhY2Nlc3MgcGxhblxcJ3Mgc2V0dGluZ3MuIElmIHlvdSB3aXNoIHRvIHRlcm1pbmF0ZSB0aGVpciBwbGFucyB5b3UgbXVzdCBkbyBzbyBtYW51YWxseS4gVGhpcyBhY3Rpb24gY2Fubm90IGJlIHJldmVyc2VkLicgKTtcblxuXHRcdFx0Ly8gaWYgdGhlcmUncyBubyBJRCBqdXN0IHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cblx0XHRcdGlmICggISBwbGFuX2lkICkge1xuXG5cdFx0XHRcdHNlbGYucmVtb3ZlX3BsYW5fZWwoICRwbGFuICk7XG5cblx0XHRcdC8vIFRocm93IGEgY29uZmlybWF0aW9uIHdhcm5pbmdcblx0XHRcdH0gZWxzZSBpZiAoIHdpbmRvdy5jb25maXJtKCB3YXJuaW5nICkgKSB7XG5cblx0XHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkcGxhbiApO1xuXHRcdFx0XHR3aW5kb3cuTExNUy5BamF4LmNhbGwoIHtcblx0XHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0XHRhY3Rpb246ICdkZWxldGVfYWNjZXNzX3BsYW4nLFxuXHRcdFx0XHRcdFx0cGxhbl9pZDogcGxhbl9pZCxcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCByICkge1xuXHRcdFx0XHRcdFx0TExNUy5TcGlubmVyLnN0b3AoICRwbGFuICk7XG5cdFx0XHRcdFx0XHRpZiAoIHIuc3VjY2VzcyApIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5yZW1vdmVfcGxhbl9lbCggJHBsYW4gKTtcblx0XHRcdFx0XHRcdFx0c2VsZi50cmlnZ2VyX3VwZGF0ZV9ob29rKCk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCByLm1lc3NhZ2UgKSB7XG5cdFx0XHRcdFx0XHRcdGFsZXJ0KCByLm1lc3NhZ2UgKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSApO1xuXG5cdFx0XHR9XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogSGFuZGxlIGhpZGluZyAmIHNob3dpbmcgdmFyaW9zIHBpZWNlcyBvZiBhbiBhY2Nlc3MgcGxhbiBmb3JtXG5cdFx0ICogVGhpcyBpcyBib3VuZCB0byBhbnkgZm9ybSBlbGVtZW50IHdpdGggYSBcImRhdGEtY29udHJvbGxlci1pZFwiIHByb3BlcnR5XG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIG9iaiAgJGVsICAgalF1ZXJ5IHNlbGVjdG9yIGZvciB0aGUgY2hhbmdlZCBmb3JtIGVsZW1lbnRcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5jb250cm9sbGVyX2NoYW5nZSA9IGZ1bmN0aW9uKCAkZWwgKSB7XG5cblx0XHRcdHZhciBpZCA9ICRlbC5hdHRyKCAnZGF0YS1jb250cm9sbGVyLWlkJyApLFxuXHRcdFx0XHR2YWwgPSAkZWwudmFsKCksXG5cdFx0XHRcdCRmb3JtID0gJGVsLmNsb3Nlc3QoICcubGxtcy1hY2Nlc3MtcGxhbicgKSxcblx0XHRcdFx0JGNvbnRyb2xzID0gJGZvcm0uZmluZCggJ1tkYXRhLWNvbnRyb2xsZXI9XCInICsgaWQgKyAnXCJdJyk7XG5cblx0XHRcdGlmICggJ2NoZWNrYm94JyA9PT0gJGVsLmF0dHIoICd0eXBlJyApICkgIHtcblx0XHRcdFx0dmFsID0gKCAkZWwuaXMoICc6Y2hlY2tlZCcgKSApID8gdmFsIDogJ25vJztcblx0XHRcdH1cblxuXHRcdFx0JGNvbnRyb2xzLmVhY2goIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkYyA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQkZWxzID0gKCAnU0VMRUNUJyA9PT0gJGNbMF0ubm9kZU5hbWUgfHwgJ0lOUFVUJyAgPT09ICRjWzBdLm5vZGVOYW1lIHx8ICdURVhUQVJFQScgID09PSAkY1swXS5ub2RlTmFtZSApID8gJGMgOiAkYy5maW5kKCAnaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEnICksXG5cdFx0XHRcdFx0ZXF1YWxzID0gJGMuYXR0ciggJ2RhdGEtdmFsdWUtaXMnICksXG5cdFx0XHRcdFx0bm90X2VxdWFscyA9ICRjLmF0dHIoICdkYXRhLXZhbHVlLWlzLW5vdCcgKSxcblx0XHRcdFx0XHRhY3Rpb24sIG9wZXJhdG9yO1xuXG5cdFx0XHRcdGlmICggdHlwZW9mIGVxdWFscyAhPT0gdHlwZW9mIHVuZGVmaW5lZCAmJiBlcXVhbHMgIT09IGZhbHNlICkge1xuXG5cdFx0XHRcdFx0b3BlcmF0b3IgPSAnPT0nO1xuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIHR5cGVvZiBub3RfZXF1YWxzICE9PSB0eXBlb2YgdW5kZWZpbmVkICYmIG5vdF9lcXVhbHMgIT09IGZhbHNlICkge1xuXG5cdFx0XHRcdFx0b3BlcmF0b3IgPSAnIT0nO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzd2l0Y2ggKCBvcGVyYXRvciApIHtcblxuXHRcdFx0XHRcdGNhc2UgJz09JzpcblxuXHRcdFx0XHRcdFx0aWYgKCB2YWwgPT0gZXF1YWxzICkge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb24gPSAnc2hvdyc7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb24gPSAnaGlkZSc7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgJyE9JzpcblxuXHRcdFx0XHRcdFx0aWYgKCB2YWwgIT0gbm90X2VxdWFscyApIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ3Nob3cnO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9uID0gJ2hpZGUnO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggJ3Nob3cnID09PSBhY3Rpb24gKSB7XG5cdFx0XHRcdFx0JGMuc2hvdygpO1xuXHRcdFx0XHRcdCRlbHMucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApLnRyaWdnZXIoICdjaGFuZ2UnICk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoICdoaWRlJyA9PT0gYWN0aW9uICkge1xuXHRcdFx0XHRcdCRjLmhpZGUoKTtcblx0XHRcdFx0XHQkZWxzLmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogUmV0cmlldmUgYWNjZXNzIHBsYW4gZGF0YSBhcyBhbiBhcnJheSBvZiBKU09OIGJ1aWx0IGZyb20gdGhlIGRvbSBlbGVtZW50IGZpZWxkIHZhbHVlcy5cblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gIGFycmF5XG5cdFx0ICogQHNpbmNlICAgW3ZlcnNpb25dXG5cdFx0ICogQHZlcnNpb24gW3ZlcnNpb25dXG5cdFx0ICovXG5cdFx0dGhpcy5nZXRfcGxhbnNfYXJyYXkgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0Ly8gZW5zdXJlIGFsbCBjb250ZW50IGVkaXRvcnMgYXJlIHNhdmVkIHByb3Blcmx5LlxuXHRcdFx0dGlueU1DRS50cmlnZ2VyU2F2ZSgpO1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdGZvcm0gPSBzZWxmLiRwbGFucy5jbG9zZXN0KCAnZm9ybScgKS5zZXJpYWxpemVBcnJheSgpLFxuXHRcdFx0XHRwbGFucyA9IFtdO1xuXG5cdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBmb3JtLmxlbmd0aDsgaSsrICkge1xuXG5cdFx0XHRcdC8vIFNraXAgbm9uIHBsYW4gZGF0YSBmcm9tIHRoZSBmb3JtLlxuXHRcdFx0XHRpZiAoIC0xID09PSBmb3JtWyBpIF0ubmFtZS5pbmRleE9mKCAnX2xsbXNfcGxhbnMnICkgKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIga2V5cyA9IGZvcm1bIGkgXS5uYW1lLnJlcGxhY2UoICdfbGxtc19wbGFuc1snLCAnJyApLnNwbGl0KCAnXVsnICksXG5cdFx0XHRcdFx0aW5kZXggPSAoIGtleXNbMF0gKiAxICkgLSAxLFxuXHRcdFx0XHRcdG5hbWUgPSBrZXlzWzFdLnJlcGxhY2UoICddJywgJycgKSxcblx0XHRcdFx0XHR0eXBlID0gMyA9PT0ga2V5cy5sZW5ndGggPyAnYXJyYXknIDogJ3NpbmdsZSc7XG5cblx0XHRcdFx0aWYgKCAhIHBsYW5zWyBpbmRleCBdICkge1xuXHRcdFx0XHRcdHBsYW5zWyBpbmRleCBdID0ge307XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoICdhcnJheScgPT09IHR5cGUgKSB7XG5cblx0XHRcdFx0XHRpZiAoICEgcGxhbnNbIGluZGV4IF1bIG5hbWUgXSApIHtcblx0XHRcdFx0XHRcdHBsYW5zWyBpbmRleCBdWyBuYW1lIF0gPSBbXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cGxhbnNbIGluZGV4IF1bIG5hbWUgXS5wdXNoKCBmb3JtWyBpIF0udmFsdWUgKTtcblxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0cGxhbnNbIGluZGV4IF1bIG5hbWUgXSA9IGZvcm1bIGkgXS52YWx1ZTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHBsYW5zO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIERldGVybWluZSBpZiB0aGUgYWNjZXNzIHBsYW4gbGltaXQgaGFzIGJlZW4gcmVhY2hlZFxuXHRcdCAqXG5cdFx0ICogQHJldHVybiBCb29sZWFuICAgICB0cnVlIGlmIGl0J3MgYmVlbiByZWFjaGVkLCBmYWxzZSBvdGhlcndpc2Vcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIGxpbWl0ID0gd2luZG93LmxsbXMucHJvZHVjdC5hY2Nlc3NfcGxhbl9saW1pdCxcblx0XHRcdFx0Y3VyciA9ICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYWNjZXNzLXBsYW4nICkubGVuZ3RoO1xuXG5cdFx0XHRyZXR1cm4gY3VyciA+PSBsaW1pdDtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBJbml0YWxpemVzIGEgbmV3IHBsYW4gYW5kIGFkZHMgaXQgdG8gdGhlIGxpc3Qgb2YgcGxhbnMgaW4gdGhlIERPTVxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjMuMFxuXHRcdCAqL1xuXHRcdHRoaXMuaW5pdF9wbGFuID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdC8vIGRvbid0IGRvIGFueXRoaW5nIGlmIHdlJ3ZlIHJlYWNoZWQgdGhlIHBsYW4gbGltaXRcblx0XHRcdGlmICggdGhpcy5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQoKSApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgJGNsb25lID0gJCggJyNsbG1zLW5ldy1hY2Nlc3MtcGxhbi1tb2RlbCcgKS5jbG9uZSgpXG5cdFx0XHRcdCRleGlzdGluZ19wbGFucyA9ICQoICcjbGxtcy1hY2Nlc3MtcGxhbnMgLmxsbXMtYWNjZXNzLXBsYW4nICksXG5cdFx0XHRcdCRlZGl0b3IgPSAkY2xvbmUuZmluZCggJyNfbGxtc19wbGFuc19jb250ZW50X2xsbXMtbmV3LWFjY2Vzcy1wbGFuLW1vZGVsJyApO1xuXG5cdFx0XHQvLyByZW1vdmUgSUQgZnJvbSB0aGUgaXRlbVxuXHRcdFx0JGNsb25lLnJlbW92ZUF0dHIoICdpZCcgKTtcblxuXHRcdFx0Ly8gZ2l2ZSBhIHRlbXBvcmFyeSBpZCB0byB0aGUgZWRpdG9yIGVsZW1lbnRcblx0XHRcdCRlZGl0b3IucmVtb3ZlQXR0ciggJ2lkJyApLmF0dHIoICdpZCcsICdfbGxtc19wbGFuc19jb250ZW50XycgKyB0aGlzLnRlbXBfaWQgKTtcblx0XHRcdHRoaXMudGVtcF9pZCsrOyAvLyBpbmNyZW1lbnQgdGhlIHRlbXBfaWQgSUQgc28gd2UgZG9uJ3QgdXNlIGl0IGFnYWluXG5cblxuXHRcdFx0Ly8gYWN0aXZhdGUgYWxsIGVsZW1lbnRzXG5cdFx0XHQkY2xvbmUuZmluZCggJ3NlbGVjdCwgaW5wdXQsIHRleHRhcmVhJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQkKCB0aGlzICkucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApOyAvLyBlbmFibGVkIHRoZSBmaWVsZFxuXHRcdFx0fSApO1xuXG5cblx0XHRcdCRjbG9uZS5maW5kKCAnLmxsbXMtYWNjZXNzLXBsYW4tZGF0ZXBpY2tlcicgKS5kYXRlcGlja2VyKCB7XG5cdFx0XHRcdGRhdGVGb3JtYXQ6IFwibW0vZGQveXlcIlxuXHRcdFx0fSApO1xuXG5cdFx0XHQkY2xvbmUuYXBwZW5kVG8oICcjbGxtcy1hY2Nlc3MtcGxhbnMnICk7XG5cblx0XHRcdC8vIHJld3JpdGUgdGhlIG9yZGVyIG9mIGFsbCBlbGVtZW50c1xuXHRcdFx0dGhpcy51cGRhdGVfcGxhbl9vcmRlcnMoKTtcblxuXHRcdFx0JGNsb25lLmZpbmQoICcubGxtcy1jb2xsYXBzaWJsZS1oZWFkZXInICkudHJpZ2dlciggJ2NsaWNrJyApO1xuXG5cdFx0XHQvLyBjaGVjayBpZiB0aGUgbGltaXQgaGFzIGJlZW4gcmVhY2hlZCBhbmQgdG9nZ2xlIHRoZSBidXR0b24gaWYgaXQgaGFzXG5cdFx0XHRpZiAoIHRoaXMuaGFzX3BsYW5fbGltaXRfYmVlbl9yZWFjaGVkKCkgKSB7XG5cdFx0XHRcdHRoaXMudG9nZ2xlX2NyZWF0ZV9idXR0b24oICdkaXNhYmxlJyApO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzZWxlY3QyaWZ5IG1lbWJlcnNoaXAgYXZhaWxhYmlsaXR5IGZpZWxkXG5cdFx0XHR3aW5kb3cubGxtcy5tZXRhYm94ZXMucG9zdF9zZWxlY3QoICRjbG9uZS5maW5kKCAnLmxsbXMtYXZhaWxhYmlsaXR5LXJlc3RyaWN0aW9ucycgKSApO1xuXG5cdFx0XHQkY2xvbmUuZmluZCggJ1tkYXRhLWNvbnRyb2xsZXItaWRdJyApLnRyaWdnZXIoICdjaGFuZ2UnICk7XG5cdFx0XHQkKCBkb2N1bWVudCApLnRyaWdnZXIoICdsbG1zLXBsYW4taW5pdCcsICRjbG9uZSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFBlcnNpc3QgYWNjZXNzIHBsYW5zIHRvIHRoZSBEQiBpZiB0aGV5IHBhc3MgdmFsaWRhdGlvblxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAge1t0eXBlXX1cblx0XHQgKiBAc2luY2UgICBbdmVyc2lvbl1cblx0XHQgKiBAdmVyc2lvbiBbdmVyc2lvbl1cblx0XHQgKi9cblx0XHR0aGlzLnNhdmVfcGxhbnMgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHRzZWxmLiRwbGFucy5maW5kKCAnLmxsbXMtYWNjZXNzLXBsYW4nICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCQoIHRoaXMgKS50cmlnZ2VyKCAnbGxtcy12YWxpZGF0ZS1wbGFuJyApO1xuXHRcdFx0fSApO1xuXG5cdFx0XHRpZiAoIHNlbGYuJHBsYW5zLmZpbmQoICcuJyArIHNlbGYudmFsaWRhdGlvbl9jbGFzcyApLmxlbmd0aCApIHtcblx0XHRcdFx0c2VsZi4kcGxhbnMuZmluZCggJy5sbG1zLWFjY2Vzcy1wbGFuLicgKyBzZWxmLnZhbGlkYXRpb25fY2xhc3MgKS5ub3QoICcub3BlbmVkJyApLmZpcnN0KCkuZmluZCggJy5sbG1zLWNvbGxhcHNpYmxlLWhlYWRlcicgKS50cmlnZ2VyKCAnY2xpY2snICk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCBzZWxmLiRwbGFucyApO1xuXHRcdFx0d2luZG93LkxMTVMuQWpheC5jYWxsKCB7XG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRhY3Rpb246ICdsbG1zX3VwZGF0ZV9hY2Nlc3NfcGxhbnMnLFxuXHRcdFx0XHRcdHBsYW5zOiBzZWxmLmdldF9wbGFuc19hcnJheSgpLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRjb21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0TExNUy5TcGlubmVyLnN0b3AoIHNlbGYuJHBsYW5zICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbigganFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duICkge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoICdsbG1zIGFjY2VzcyBwbGFuIHNhdmUgZXJyb3IgZW5jb3VudGVyZDonLCBqcVhIUiApO1xuXHRcdFx0XHRcdGFsZXJ0KCBMTE1TLmwxMG4udHJhbnNsYXRlKCAnQW4gZXJyb3Igd2FzIGVuY291bnRlcmQgZHVyaW5nIHRoZSBzYXZlIGF0dGVtcHQuIFBsZWFzZSB0cnkgYWdhaW4uJyApICsgJyBbJyAgKyB0ZXh0U3RhdHVzICsgJzogJyArIGVycm9yVGhyb3duICsgJ10nICk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCByZXMgKSB7XG5cblx0XHRcdFx0XHRpZiAoICEgcmVzLnN1Y2Nlc3MgJiYgcmVzLmNvZGUgJiYgJ2Vycm9yJyA9PT0gcmVzLmNvZGUgKSB7XG5cdFx0XHRcdFx0XHRhbGVydCggcmVzLm1lc3NhZ2UgKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCByZXMuZGF0YSAmJiByZXMuZGF0YS5odG1sICkge1xuXG5cdFx0XHRcdFx0XHQvLyByZXBsYWNlIHRoZSBtZXRhYm94IHdpdGggdXBkYXRlZCBkYXRhIGZyb20gdGhlIHNlcnZlci5cblx0XHRcdFx0XHRcdCQoICcjbGxtcy1wcm9kdWN0LW9wdGlvbnMtYWNjZXNzLXBsYW5zJyApLnJlcGxhY2VXaXRoKCByZXMuZGF0YS5odG1sICk7XG5cblx0XHRcdFx0XHRcdC8vIHJlaW5pdC5cblx0XHRcdFx0XHRcdHNlbGYuaW5pdCggdHJ1ZSApO1xuXHRcdFx0XHRcdFx0d2luZG93LmxsbXMubWV0YWJveGVzLmluaXQoKTtcblx0XHRcdFx0XHRcdHNlbGYudXBkYXRlX3BsYW5fb3JkZXJzKCk7XG5cblx0XHRcdFx0XHRcdC8vIG5vdGlmeSB0aGUgYmxvY2sgZWRpdG9yXG5cdFx0XHRcdFx0XHRzZWxmLnRyaWdnZXJfdXBkYXRlX2hvb2soKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9LFxuXG5cdFx0XHR9ICk7XG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENvbnRyb2wgdGhlIHN0YXR1cyBvZiB0aGUgXCJOZXcgQWNjZXNzIFBsYW5cIiBCdXR0b25cblx0XHQgKiBFbmFibGVzIC8gRGlzYWJsZXMgdGhlIGJ1dHRvbiBhbmQgc2hvd3MgLyBoaWRlcyB0aGUgYXNzb2NpYXRlZCBtZXNzYWdlXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBzdGF0dXMgICAgZW5hYmxlIG9yIGRpc2FibGVcblx0XHQgKiBAcmV0dXJuIHZvaWRcblx0XHQgKiBAc2luY2UgIDMuMC4wXG5cdFx0ICogQHNpbmNlICBbdmVyc2lvbl1cblx0XHQgKi9cblx0XHR0aGlzLnRvZ2dsZV9jcmVhdGVfYnV0dG9uID0gZnVuY3Rpb24oIHN0YXR1cyApIHtcblxuXHRcdFx0dmFyICRidG4gPSAkKCAnI2xsbXMtbmV3LWFjY2Vzcy1wbGFuJyApO1xuXG5cdFx0XHRpZiAoICdkaXNhYmxlJyA9PT0gc3RhdHVzICkge1xuXHRcdFx0XHQkYnRuLmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCRidG4ucmVtb3ZlQXR0ciggJ2Rpc2FibGVkJyApO1xuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFZpc3VhbGx5IGhpZGUgYW5kIHRoZW4gcGh5c2ljYWxseSByZW1vdmUgYSBwbGFuIGVsZW1lbnQgZnJvbSB0aGUgRE9NXG5cdFx0ICogQWRkaXRpb25hbGx5IGRldGVybWluZXMgaWYgdGhlIE5ldyBQbGFuIEJ1dHRvbiBzaG91bGQgYmUgcmUtZW5hYmxlZFxuXHRcdCAqIGFmdGVyIGRlbGV0aW9uXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gIG9iaiAgICRwbGFuIGpRdWVyeSBzZWxlY3RvciBvZiB0aGUgcGxhbiBlbGVtZW50XG5cdFx0ICogQHJldHVybiB2b2lkXG5cdFx0ICogQHNpbmNlIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5yZW1vdmVfcGxhbl9lbCA9IGZ1bmN0aW9uKCAkcGxhbiApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHQvLyBmYWRlIG91dCBuaWNlbHlcblx0XHRcdCRwbGFuLmZhZGVPdXQoIDQwMCApO1xuXG5cdFx0XHQvLyByZW1vdmUgZnJvbSBkb20gYWZ0ZXIgaXQncyBoaWRkZW4gdmlzdWFsbHlcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0JHBsYW4ucmVtb3ZlKCk7XG5cblx0XHRcdFx0Ly8gY2hlY2sgaWYgd2UgbmVlZCB0byByZWVuYWJsZSB0aGUgY3JlYXRlIGJ1dHRvbiBhbmQgaGlkZSB0aGUgbWVzc2FnZVxuXHRcdFx0XHRpZiAoICEgc2VsZi5oYXNfcGxhbl9saW1pdF9iZWVuX3JlYWNoZWQoKSApIHtcblx0XHRcdFx0XHRzZWxmLnRvZ2dsZV9jcmVhdGVfYnV0dG9uKCAnZW5hYmxlJyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA0NTAgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBUcmlnZ2VyIFdQIEJsb2NrIEVkaXRvciBob29rIHNvIHRoZSBwcmljaW5nIHRhYmxlIGJsb2NrIGNhbiBiZSByZS1yZW5kZXJlZCB3aXRoIG5ldyBwbGFuIGluZm9ybWF0aW9uLlxuXHRcdCAqXG5cdFx0ICogQHJldHVybiAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgIFt2ZXJzaW9uXVxuXHRcdCAqIEB2ZXJzaW9uIFt2ZXJzaW9uXVxuXHRcdCAqL1xuXHRcdHRoaXMudHJpZ2dlcl91cGRhdGVfaG9vayA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQkKCBkb2N1bWVudCApLnRyaWdnZXIoICdsbG1zLWFjY2Vzcy1wbGFucy11cGRhdGVkJyApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIFJlb3JkZXIgdGhlIGFycmF5IGluZGV4ZXMgYW5kIHRoZSBtZW51IG9yZGVyIGhpZGRlbiBpbnB1dHNcblx0XHQgKiBDYWxsZWQgYnkgalF1ZXJ5IFVJIFNvcnRhYmxlIG9uIHNvcnQgY29tcGxldGlvblxuXHRcdCAqIEFsc28gY2FsbGVkIGFmdGVyIGFkZGluZyBhIG5ldyBwbGFuIHRvIHRoZSBET00gc28gdGhlIG5ld2VzdCBpdGVtIGlzIGFsd2F5c1xuXHRcdCAqIHBlcnNpc3RlZCBhcyB0aGUgbGFzdCBpbiB0aGUgZGF0YWJhc2UgaWYgbm8gVVggcmVvcmRlcnMgdGhlIGl0ZW1cblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gdm9pZFxuXHRcdCAqIEBzaW5jZSAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLnVwZGF0ZV9wbGFuX29yZGVycyA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQkKCAnI2xsbXMtYWNjZXNzLXBsYW5zIC5sbG1zLWFjY2Vzcy1wbGFuJyApLmVhY2goIGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdHZhciAkcCA9ICQoIHRoaXMgKSxcblx0XHRcdFx0XHQkb3JkZXIgPSAkcC5maW5kKCAnLnBsYW4tb3JkZXInICksXG5cdFx0XHRcdFx0JGVkaXRvciA9ICRwLmZpbmQoICd0ZXh0YXJlYVtpZF49XCJfbGxtc19wbGFuc19jb250ZW50X1wiXScgKSxcblx0XHRcdFx0XHRlZGl0b3JfaWQgPSAkZWRpdG9yLmF0dHIoICdpZCcgKSxcblx0XHRcdFx0XHRvcmlnID0gJG9yZGVyLnZhbCgpICogMSxcblx0XHRcdFx0XHRjdXJyID0gJHAuaW5kZXgoKTtcblxuXHRcdFx0XHQvLyBkZS1pbml0IHRpbnlNQ0UgZnJvbSB0aGUgZWRpdG9yXG5cdFx0XHRcdHRpbnlNQ0UuRWRpdG9yTWFuYWdlci5leGVjQ29tbWFuZCggJ21jZVJlbW92ZUVkaXRvcicsIHRydWUsIGVkaXRvcl9pZCApO1xuXG5cdFx0XHRcdC8vIHVwZGF0ZSB0aGUgb3JkZXIgb2YgZWFjaCBmaWVsZCBpbiB0aGUgcGxhblxuXHRcdFx0XHQkcC5maW5kKCAnc2VsZWN0LCBpbnB1dCwgdGV4dGFyZWEnICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0XHR2YXIgbmFtZSA9ICQoIHRoaXMgKS5hdHRyKCAnbmFtZScgKTtcblx0XHRcdFx0XHRpZiAoIG5hbWUgKSB7XG5cdFx0XHRcdFx0XHQkKCB0aGlzICkuYXR0ciggJ25hbWUnLCBuYW1lLnJlcGxhY2UoIG9yaWcsIGN1cnIgKSApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdFx0Ly8gcmUtaW5pdCB0aW55TUNFIG9uIHRoZSBlZGl0b3Jcblx0XHRcdFx0dGlueU1DRS5FZGl0b3JNYW5hZ2VyLmV4ZWNDb21tYW5kKCAnbWNlQWRkRWRpdG9yJywgdHJ1ZSwgZWRpdG9yX2lkICk7XG5cblx0XHRcdFx0JG9yZGVyLnZhbCggY3VyciApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0Ly8gZ29cblx0XHR0aGlzLmluaXQoKTtcblxuXHR9O1xuXG5cdHZhciBhID0gbmV3IHdpbmRvdy5sbG1zLm1ldGFib3hfcHJvZHVjdCgpO1xuXG59ICkoIGpRdWVyeSApO1xuIl19
