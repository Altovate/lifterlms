function randomizeCode(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;12>a;a++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}var $=jQuery,deleteIds=[];$(document).ready(function(){function e(){$(".llms-voucher-delete").unbind("click"),$(".llms-voucher-delete").click(function(e){e.preventDefault();var t=$(this),a=t.data("id");r=!0,a?(deleteIds.push(a),$("#delete_ids").val(deleteIds.join(","))):l--,t.closest("tr").remove()})}function t(){var e=a(),t={action:"check_voucher_duplicate",postId:jQuery("#post_ID").val(),codes:e},r=new Ajax("post",t,!1);r.check_voucher_duplicate()}function a(){var e=[];return $('input[name="llms_voucher_code[]"]').each(function(){e.push($(this).val())}),e}var r=!1,l=0;$("#llms_voucher_add_codes").click(function(t){t.preventDefault();var a=$("#llms_voucher_add_quantity").val(),o=$("#llms_voucher_add_uses").val(),n="";if(r=!0,$.isNumeric(a)&&$.isNumeric(o)&&parseInt(a)>0){if(a>50)return void alert("You can only generate 50 rows at a time");if(l+=parseInt(a),l>50)return alert("Please save before adding any more codes, limit is 50 at a time"),void(l-=parseInt(a));for(var c=1;c<=parseInt(a);c++)n+='<tr><td></td><td><input type="text" maxlength="20" placeholder="Code" value="'+randomizeCode()+'" name="llms_voucher_code[]"><input type="hidden" name="llms_voucher_code_id[]" value="0"></td><td><span>0 / </span><input type="text" placeholder="Uses" value="'+o+'" class="llms-voucher-uses" name="llms_voucher_uses[]"></td><td><a href="#" class="llms-voucher-delete">'+deleteIcon+"</a></td></tr>"}$("#llms_voucher_tbody").append(n),e()}),e(),$("#llms_voucher_tbody input").change(function(){r=!0}),window.onbeforeunload=function(){return r?"If you leave this page you will lose your unsaved changes.":null},$("input[type=submit]").click(function(e){var a={},l=!1;return $('input[name="llms_voucher_code[]"]').each(function(){var e=$(this).val();a[e]?($(this).css("color","red"),l=!0):a[e]=!0}),l?(alert("Please make sure that there are no duplicate voucher codes."),!1):$("#_llms_voucher_courses").val()||$("#_llms_voucher_membership").val()?(r=!1,t(),!1):(alert("Please select course or membership before saving."),!1)})});var on_voucher_duplicate=function(e){e.length?alert("Vouchers can't be saved because there are duplicate codes in other vouchers. Duplicates are: "+JSON.stringify(e)):$("#post").submit()};